#_______ general inputs ________
DEBUG: false # TODO change back

# user_inputs_path_override: false
# user_inputs_path_override: /home/bghi639/Software/circulatory_autogen_TUTORIAL/trainingschool01/20250318-day01/simple_physiological_nonlinear_visco/simple_physiological_user_inputs.yaml
# user_inputs_path_override: /home/bghi639/Software/circulatory_autogen_TUTORIAL/trainingschool01/20250320-day03/smc_with_piezo/smc_with_piezo_user_inputs.yaml
# user_inputs_path_override: /home/bghi639/Software/circulatory_autogen_TUTORIAL/trainingschool01/20250321-day04/coupled_CVS_smc/coupled_CVS_smc_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/MVP_CVSmodel_BG-CAcoupling/CA_files/BG_cvs_MVP_model_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/MVP_CVSmodel_BG-CAcoupling/CA_files/BG_cvs_MVP_model_2_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/MVP_CVSmodel_BG-CAcoupling/CA_files/BG_cvs_MVP_model_new_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/MVP_CVSmodel_BG-CAcoupling/CA_files/BG_cvs_MVP_model_new_calib_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/MVP_CVSmodel_BG-CAcoupling/CA_files/BG_cvs_MVP_model_new_calib_linear_user_inputs.yaml

# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_0d_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_0d_v2_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_0d_v2_RK4_user_inputs.yaml

# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_test_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_new_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_new2_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_new2_RK4_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_new2_CVODE_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_new2_PETSC_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_new3_user_inputs.yaml

# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/aortic_bif_hybrid_multi_user_inputs.yaml

# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/3compartment_0d_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/3compartment_mod_0d_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/3compartment_mod_0d_sumBV_v2_user_inputs.yaml

# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/3compartment_hybrid_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/3compartment_mod_hybrid_v1_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/1D-0D-coupler-cpp-example/CA_files/3compartment_mod_hybrid_sumBV_v3_user_inputs.yaml

# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/CVS_Topology_Arborizer/Stage1-VITAL/stage1_model_male_openloop/CA_files/stage1_model_male_art_openloop_FINAL_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/CVS_Topology_Arborizer/Stage1-VITAL/stage1_model_male_openloop/CA_files/stage1_model_male_art_closedloopsimple_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Work/VITALProject/WP2/TASK2.6/ST1_CVSAnatomicalDefinition/CVS_Topology_Arborizer/Stage1-VITAL/stage1_model_male_openloop/CA_files/stage1_model_male_art_closedloopsimple_FINAL_user_inputs.yaml

# user_inputs_path_override: /home/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_0d/cvs_model_0d_user_inputs.yaml
# user_inputs_path_override: /home/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_with_arm_0d/cvs_model_with_arm_0d_user_inputs.yaml
# user_inputs_path_override: /home/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_with_arm_hybrid/cvs_model_with_arm_hybrid_user_inputs.yaml

# user_inputs_path_override: /hpc/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_0d/cvs_model_0d_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_0d_cpp/cvs_model_0d_user_inputs.yaml
user_inputs_path_override: /hpc/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_hybrid/cvs_model_hybrid_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_with_arm_0d/cvs_model_with_arm_0d_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_with_arm_0d_cpp/cvs_model_with_arm_0d_user_inputs.yaml
# user_inputs_path_override: /hpc/bghi639/Software/VITAL_TrainingSchool2_Tutorials/cvs_model_with_arm_hybrid/cvs_model_with_arm_hybrid_user_inputs.yaml

file_prefix: 3compartment
# file_prefix: aortic_bif_0d
# file_prefix: aortic_bif_0d_super_random_nonlinear
# file_prefix: generic_junction_test_openloop
# file_prefix: generic_junction_test_closedloop

# input_param_file must be stored in resources. If first creating a parameters file 
# set this to parameters_orig.csv and a 
# parameters file will be generated with spaces for the required parameters
input_param_file: 3compartment_parameters.csv

# cpp generation inputs
# model_type can be cellml_only, cpp, or python atm 
# model_type: cpp
model_type: cellml_only

#__________ parameter identification inputs __________
# param_id_method can be any of [genetic_algorithm]
param_id_method: genetic_algorithm

# pre_time is the amount of time simulated to get to steady state
# TODO this is not important if it is specified in the obs_data.json file
# TODO I should remove it here and only specify in the obs_data.json file?
pre_time: 20   
# sim_time is the amount of simulation time where the outputs are compared to ground truth
# NOTE: If doing freq domain fitting make sure the simulation is periodic and the sim time is the period.
sim_time: 2

# specifying number of heart periods has been made obsolete. If you want to do this, do it when preprocessing
# and set the pre_time and sim_time accordingly.

# it is recommended that users create their own CA_user directory to store input resources and output generated model files. e.g.
# resources_dir: /home/farg967/Documents/git_projects/CA_user/3compartment/resources
# generated_models_dir: /home/farg967/Documents/git_projects/CA_user/3compartment/generated_models
# param_id_output_dir: /home/farg967/Documents/git_projects/CA_user/3compartment/param_id_output

# This is for cpp generation
# cpp_generated_models_dir: /home/farg967/software/venous_system/lucas_model/fvm
cpp_generated_models_dir: /home/farg967/Documents/git_projects/circulatory_autogen/generated_models/3compartment/
# This is for cpp_coupling
couple_to_1d: false
cpp_1d_model_config_path: 
  /home/farg967/software/venous_system/lucas_model/aortic_bif_coupling/run_dir/input1d.dat

# Output time step (sampling) 
dt: 0.01 # This should be smaller than all of the dt in your obs_data.json file.

# OLD: solver options are: RK4, forward_euler, CVODE
# solver options are: CVODE (uses Myokit, default), CVODE_opencor (uses OpenCOR), or for Python models: solve_ivp
# I think this should be
# solver options are: CVODE_myokit (uses Myokit), CVODE (uses OpenCOR, default), RK4_cpp (RK4 in cpp), or for Python models: solve_ivp
# TODO make this also change the solver in the opencor sims when not generating cpp.
# solver: RK4_cpp
solver: CVODE
# solver: CVODE_myokit
# solver: CVODE_opencor
# These are inputs to solver_properties of the solver
solver_info:
  # Maximum time step for solver
  MaximumStep: 0.0001
  MaximumNumberOfSteps: 5000
  # method: RK45 # any method for solve_ivp

# param_id_obs_path needs to be an absolute path.
# This for 3compartment
param_id_obs_path: /home/farg967/Documents/git_projects/circulatory_autogen/resources/3compartment_obs_data.json
# param_id_obs_path: /home/farg967/Documents/test/resources/3compartment_obs_data.json
# param_id_obs_path: /hpc/bghi639/Software/circulatory_autogen/resources/simple_physiological_nonlinear_visco_obs_data.json

#_______ sensitivity analysis inputs __________
do_sensitivity: false

#______ optimiser options (for all optimisers) ___________
optimiser_options:
  # Common options (shared across optimisers):
  num_calls_to_function: 10000  # maximum function evaluations (default: 10000)
  cost_convergence: 0.001        # convergence tolerance (default: 0.0001)
  max_patience: 10              # max patience for convergence (default: 10)
  cost_type: MSE                # cost function type
  
  # CMA-ES specific options:
  # sigma0: 0.1    # optional, initial standard deviation (default: 0.2 * mean(param_range))
  # Note: Initial parameter values (x0) are automatically loaded from {file_prefix}_parameters.csv

#______ debug optimiser options (used when DEBUG is True) ___________
debug_optimiser_options:
  num_calls_to_function: 30 # TODO change back to 30 for tests
  cost_convergence: 0.001
  cost_type: MSE
  # Note: When DEBUG is True, debug_optimiser_options overrides optimiser_options

#______ mcmc inputs ___________
do_mcmc: False
mcmc_options:
  num_steps: 1000
  num_walkers: 64
  # TODO As above for cost_type
  cost_type: MSE
  cost_convergence: 0.001

debug_mcmc_options:
  num_steps: 5
  num_walkers: 40
  cost_type: MSE
  cost_convergence: 0.001

sa_options:
  method: sobol 
  sample_type: 'saltelli'
  num_samples: 256 # this is multiplied by (2M + 2) to get the actual number of samples (M is the number of parameters).
    # output_dir: /non/default/path

# identifiability analysis
do_ia: True
ia_options:
  method: Laplace # profile_likelihood

plot_predictions: true
