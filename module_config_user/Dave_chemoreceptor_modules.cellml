<?xml version='1.0' encoding='UTF-8'?>
<model name="modules" xmlns="http://www.cellml.org/cellml/1.1#" xmlns:cellml="http://www.cellml.org/cellml/1.1#">
    <component name="input_vessel">
        <variable name="t" public_interface="in" units="second"/>
        <!-- constants -->
        <variable name="u_mean" public_interface="in" units="J_per_m3"/>
        <variable name="u_ampl" public_interface="in" units="J_per_m3"/>
        <!-- gas partial pressure input in mmHg to mirror data units-->
        <variable name="P_O2_mmHg" public_interface="in" units="dimensionless"/>
        <variable name="P_CO2_mmHg" public_interface="in" units="dimensionless"/>
        <!-- outputs / boundary conditions      -->
        <variable name="u_out" public_interface="out" units="J_per_m3"/>
        <variable name="C_O2_out" public_interface="out" units="mol_per_m3"/>
        <variable name="C_CO2_out" public_interface="out" units="mol_per_m3"/>
        <!-- equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>u_out</ci>
                <apply>
                    <plus/>
                    <ci>u_mean</ci>
                    <apply>
                        <times/>
                        <ci>u_ampl</ci>
                        <apply>
                            <sin/>
                            <ci>t</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
        <!-- ===================================== dissociation curve ======================================-->
        <variable name="k_1" public_interface="in" units="J_per_m3"/>
        <variable name="k_2" public_interface="in" units="J_per_m3"/>
        <variable name="a_1" public_interface="in" units="dimensionless"/>
        <variable name="a_2" public_interface="in" units="dimensionless"/>
        <variable name="alpha_1" public_interface="in" units="m3_per_J"/>
        <variable name="alpha_2" public_interface="in" units="m3_per_J"/>
        <variable name="beta_1" public_interface="in" units="m3_per_J"/>
        <variable name="beta_2" public_interface="in" units="m3_per_J"/>
        <variable name="C_O2_sat" public_interface="in" units="mol_per_m3"/>
        <variable name="C_CO2_sat" public_interface="in" units="mol_per_m3"/>
        <!-- need to determine units for f_1 and f_2-->
        <variable name="f_1" units="dimensionless"/>
        <variable name="f_2" units="dimensionless"/>
        <!-- curve equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>C_O2_out</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>C_O2_sat</ci>
                        <apply>
                            <power/>
                            <ci>f_1</ci>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">1</cn>
                                <ci>a_1</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <power/>
                            <ci>f_1</ci>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">1</cn>
                                <ci>a_1</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>C_CO2_out</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>C_CO2_sat</ci>
                        <apply>
                            <power/>
                            <ci>f_2</ci>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">1</cn>
                                <ci>a_2</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <power/>
                            <ci>f_2</ci>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">1</cn>
                                <ci>a_2</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>f_1</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>P_O2_mmHg</ci>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <ci>beta_1</ci>
                                <ci>P_CO2_mmHg</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k_1</ci>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <ci>alpha_1</ci>
                                <ci>P_CO2_mmHg</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>f_2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>P_CO2_mmHg</ci>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <ci>beta_2</ci>
                                <ci>P_O2_mmHg</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k_2</ci>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <ci>alpha_2</ci>
                                <ci>P_O2_mmHg</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
    <component name="pv_RIC">
        <variable name="t" public_interface="in" units="second"/>
        <!-- inputs -->
        <variable name="u_in" public_interface="in" units="J_per_m3"/>
        <!-- state variables -->
        <variable name="v_init" public_interface="in" units="m3_per_s"/>
        <variable name="q_init" public_interface="in" units="m3"/>
        <variable initial_value="v_init" name="v" public_interface="out" units="m3_per_s"/>
        <variable name="u" public_interface="out" units="J_per_m3"/>
        <variable initial_value="q_init" name="q" public_interface="out" units="m3"/>
        <!-- constants; -->
        <variable name="R" public_interface="in" units="Js_per_m6"/>
        <variable name="C" public_interface="in" units="m6_per_J"/>
        <variable name="q_us" public_interface="in" units="m3"/>
        <variable name="I" public_interface="in" units="Js2_per_m6"/>
        <!-- outputs / boundary conditions -->
        <variable name="v_out" public_interface="in" units="m3_per_s"/>
        <variable name="v_out_2" public_interface="out" units="m3_per_s"/>
        <!-- equations -->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>v</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <minus/>
                            <ci>u_in</ci>
                            <ci>u</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>v</ci>
                            <ci>R</ci>
                        </apply>
                    </apply>
                    <ci>I</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>q</ci>
                </apply>
                <apply>
                    <minus/>
                    <ci>v</ci>
                    <ci>v_out</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>u</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>q</ci>
                        <ci>q_us</ci>
                    </apply>
                    <ci>C</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>v_out_2</ci>
                <ci>v_out</ci>
            </apply>
        </math>
    </component>
    <!--///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
    <component name="gas_transport">
        <variable name="t" public_interface="in" units="second"/>
        <!-- inputs-->
        <variable name="v" public_interface="in" units="m3_per_s"/>
        <variable name="v_out" public_interface="in" units="m3_per_s"/>
        <variable name="C_O2_in" public_interface="in" units="mol_per_m3"/>
        <variable name="C_CO2_in" public_interface="in" units="mol_per_m3"/>
        <variable name="q" public_interface="in" units="m3"/>
        <!-- state variables -->
        <variable name="C_O2_out_init" public_interface="in" units="mol_per_m3"/>
        <variable name="C_CO2_out_init" public_interface="in" units="mol_per_m3"/>
        <variable initial_value="C_O2_out_init" name="C_O2_out" public_interface="out" units="mol_per_m3"/>
        <variable initial_value="C_CO2_out_init" name="C_CO2_out" public_interface="out" units="mol_per_m3"/>
        <!-- equations -->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>C_O2_out</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>v</ci>
                            <ci>C_O2_in</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>v_out</ci>
                            <ci>C_O2_out</ci>
                        </apply>
                    </apply>
                    <ci>q</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>C_CO2_out</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>v</ci>
                            <ci>C_CO2_in</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>v_out</ci>
                            <ci>C_CO2_out</ci>
                        </apply>
                    </apply>
                    <ci>q</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
    <component name="pp_R1ICIR2">
        <variable name="t" public_interface="in" units="second"/>
        <!-- inputs  -->
        <variable name="u_in" public_interface="in" units="J_per_m3"/>
        <!-- state variables-->
        <variable name="v_init" public_interface="in" units="m3_per_s"/>
        <variable name="v_d_init" public_interface="in" units="m3_per_s"/>
        <variable name="q_init" public_interface="in" units="m3"/>
        <variable initial_value="v_init" name="v" public_interface="out" units="m3_per_s"/>
        <variable initial_value="v_d_init" name="v_d" public_interface="out" units="m3_per_s"/>
        <variable initial_value="q_init" name="q" public_interface="out" units="m3"/>
        <variable name="u" public_interface="out" units="J_per_m3"/>
        <!-- boundary condition-->
        <variable name="u_out" public_interface="in" units="J_per_m3"/>
        <!-- constants -->
        <variable name="R_1" public_interface="in" units="Js_per_m6"/>
        <variable name="R_2" public_interface="in" units="Js_per_m6"/>
        <variable name="C" public_interface="in" units="m6_per_J"/>
        <variable name="q_us" public_interface="in" units="m3"/>
        <variable name="I" public_interface="in" units="Js2_per_m6"/>
        <!-- equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>v</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <minus/>
                            <ci>u_in</ci>
                            <ci>u</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>v</ci>
                            <ci>R_1</ci>
                        </apply>
                    </apply>
                    <apply>
                        <divide/>
                        <ci>I</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>v_d</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <minus/>
                            <ci>u</ci>
                            <ci>u_out</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>v_d</ci>
                            <ci>R_2</ci>
                        </apply>
                    </apply>
                    <apply>
                        <divide/>
                        <ci>I</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>q</ci>
                </apply>
                <apply>
                    <minus/>
                    <ci>v</ci>
                    <ci>v_d</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>u</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>q</ci>
                        <ci>q_us</ci>
                    </apply>
                    <ci>C</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
    <component name="tissue_UB_GE">
        <variable name="t" public_interface="in" units="second"/>
        <!-- inputs -->
        <variable name="v" public_interface="in" units="m3_per_s"/>
        <variable name="v_d" public_interface="in" units="m3_per_s"/>
        <variable name="q" public_interface="in" units="m3"/>
        <variable name="C_O2_a" public_interface="in" units="mol_per_m3"/>
        <variable name="C_CO2_a" public_interface="in" units="mol_per_m3"/>
        <!-- state variables-->
        <variable name="C_O2_c_init" public_interface="in" units="mol_per_m3"/>
        <variable name="C_CO2_c_init" public_interface="in" units="mol_per_m3"/>
        <variable name="ub_O2_t_init" public_interface="in" units="mol_per_m3"/>
        <variable name="ub_CO2_t_init" public_interface="in" units="mol_per_m3"/>
        <variable initial_value="C_O2_c_init" name="C_O2_c" public_interface="out" units="mol_per_m3"/>
        <variable initial_value="C_CO2_c_init" name="C_CO2_c" public_interface="out" units="mol_per_m3"/>
        <variable name="C_O2_v" public_interface="out" units="mol_per_m3"/>
        <variable name="C_CO2_v" public_interface="out" units="mol_per_m3"/>
        <variable initial_value="ub_O2_t_init" name="ub_O2_t" public_interface="out" units="mol_per_m3"/>
        <variable initial_value="ub_CO2_t_init" name="ub_CO2_t" public_interface="out" units="mol_per_m3"/>
        <!-- converted state variables-->
        <variable name="P_O2_c" public_interface="out" units="J_per_m3"/>
        <variable name="P_CO2_c" public_interface="out" units="J_per_m3"/>
        <variable name="ub_O2_c" public_interface="out" units="mol_per_m3"/>
        <variable name="ub_CO2_c" public_interface="out" units="mol_per_m3"/>
        <variable name="P_O2_t" public_interface="out" units="J_per_m3"/>
        <variable name="P_CO2_t" public_interface="out" units="J_per_m3"/>
        <!-- constants-->
        <variable name="M_O2_t" public_interface="in" units="mol_per_s"/>
        <variable name="M_CO2_t" public_interface="in" units="mol_per_s"/>
        <variable name="q_t" public_interface="in" units="m3"/>
        <!-- diffusion constants estimated off steady state models-->
        <variable name="D_O2" public_interface="in" units="m3_per_s"/>
        <variable name="D_CO2" public_interface="in" units="m3_per_s"/>
        <!-- CO2 solubility constant calculated as 20x more soluble than O2-->
        <variable name="S_O2" public_interface="in" units="mol_per_m3_per_Pa"/>
        <variable name="S_CO2" public_interface="in" units="mol_per_m3_per_Pa"/>
        <!-- equations for pressures and unbound gas concentrations from inverted dissociation curve and solubility coefficients-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>P_O2_c</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">133.32</cn>
                    <apply>
                        <plus/>
                        <ci>r_1</ci>
                        <apply>
                            <root/>
                            <apply>
                                <minus/>
                                <apply>
                                    <power/>
                                    <ci>r_1</ci>
                                    <cn cellml:units="dimensionless">2</cn>
                                </apply>
                                <ci>s_1</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>P_CO2_c</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">133.32</cn>
                    <apply>
                        <plus/>
                        <ci>r_2</ci>
                        <apply>
                            <root/>
                            <apply>
                                <minus/>
                                <apply>
                                    <power/>
                                    <ci>r_2</ci>
                                    <cn cellml:units="dimensionless">2</cn>
                                </apply>
                                <ci>s_2</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>P_O2_t</ci>
                <apply>
                    <divide/>
                    <ci>ub_O2_t</ci>
                    <ci>S_O2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>P_CO2_t</ci>
                <apply>
                    <divide/>
                    <ci>ub_CO2_t</ci>
                    <ci>S_CO2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>ub_O2_c</ci>
                <apply>
                    <times/>
                    <ci>P_O2_c</ci>
                    <ci>S_O2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>ub_CO2_c</ci>
                <apply>
                    <times/>
                    <ci>P_CO2_c</ci>
                    <ci>S_CO2</ci>
                </apply>
            </apply>
            <!-- equations -->
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>C_O2_c</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <minus/>
                            <apply>
                                <times/>
                                <ci>v</ci>
                                <ci>C_O2_a</ci>
                            </apply>
                            <apply>
                                <times/>
                                <ci>v_d</ci>
                                <ci>C_O2_v</ci>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>D_O2</ci>
                            <apply>
                                <minus/>
                                <ci>ub_O2_c</ci>
                                <ci>ub_O2_t</ci>
                            </apply>
                        </apply>
                    </apply>
                    <ci>q</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>C_CO2_c</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <apply>
                                <times/>
                                <ci>v</ci>
                                <ci>C_CO2_a</ci>
                            </apply>
                            <apply>
                                <times/>
                                <ci>v_d</ci>
                                <ci>C_CO2_v</ci>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>D_CO2</ci>
                            <apply>
                                <minus/>
                                <ci>ub_CO2_t</ci>
                                <ci>ub_CO2_c</ci>
                            </apply>
                        </apply>
                    </apply>
                    <ci>q</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>ub_O2_t</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>D_O2</ci>
                            <apply>
                                <minus/>
                                <ci>ub_O2_c</ci>
                                <ci>ub_O2_t</ci>
                            </apply>
                        </apply>
                        <ci>M_O2_t</ci>
                    </apply>
                    <ci>q_t</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>ub_CO2_t</ci>
                </apply>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <apply>
                                    <minus/>
                                    <ci>D_CO2</ci>
                                </apply>
                                <apply>
                                    <minus/>
                                    <ci>ub_CO2_t</ci>
                                    <ci>ub_CO2_c</ci>
                                </apply>
                            </apply>
                            <ci>M_CO2_t</ci>
                        </apply>
                        <ci>q_t</ci>
                    </apply>
                    <ci>buff_1</ci>
                </apply>
            </apply>
            <!-- include shunt? -->
            <apply>
                <eq/>
                <ci>C_O2_v</ci>
                <ci>C_O2_c</ci>
            </apply>
            <apply>
                <eq/>
                <ci>C_CO2_v</ci>
                <ci>C_CO2_c</ci>
            </apply>
        </math>
        <!-- ===================================== acid buffer ======================================-->
        <!-- double check reaction units-->
        <variable name="k_c2b" public_interface="in" units="per_s"/>
        <variable name="k_b2c" public_interface="out" units="m3_per_mol_per_s"/>
        <variable name="K_1" public_interface="in" units="mol_per_m3"/>
        <!-- add variable init value -->
        <variable name="bicarb_t_init" public_interface="in" units="mol_per_m3"/>
        <variable name="acid_t_init" public_interface="in" units="mol_per_m3"/>
        <variable initial_value="bicarb_t_init" name="bicarb_t" public_interface="out" units="mol_per_m3"/>
        <variable initial_value="acid_t_init" name="acid_t" public_interface="out" units="mol_per_m3"/>
        <variable name="pH_t" public_interface="out" units="dimensionless"/>
        <variable name="buff_1" public_interface="out" units="mol_per_m3_per_s"/>
        <variable name="buff_2" public_interface="out" units="mol_per_m3_per_s"/>
        <!-- constants-->
        <variable name="D_bicarb_out" public_interface="out" units="m3_per_s"/>
        <variable name="D_bicarb_out_value" public_interface="in" units="m3_per_s"/>
        <variable name="D_bicarb_in" public_interface="out" units="m3_per_s"/>
        <variable name="D_bicarb_in_value" public_interface="in" units="m3_per_s"/>
        <variable name="D_acid_out" public_interface="out" units="m3_per_s"/>
        <variable name="D_acid_out_value" public_interface="in" units="m3_per_s"/>
        <variable name="bicarb_t_nom" public_interface="in" units="mol_per_m3"/>
        <variable name="acid_t_nom" public_interface="in" units="mol_per_m3"/>
        <!-- equationss
 need to add bicarb in and H in, need to add buffer equation for blood -->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>k_b2c</ci>
                <apply>
                    <divide/>
                    <ci>k_c2b</ci>
                    <ci>K_1</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>buff_1</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <ci>k_c2b</ci>
                        </apply>
                        <ci>ub_CO2_t</ci>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k_b2c</ci>
                        <ci>bicarb_t</ci>
                        <ci>acid_t</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>buff_2</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <ci>k_b2c</ci>
                        </apply>
                        <ci>bicarb_t</ci>
                        <ci>acid_t</ci>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k_c2b</ci>
                        <ci>ub_CO2_t</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>bicarb_t</ci>
                </apply>
                <apply>
                    <plus/>
                    <apply>
                        <minus/>
                        <ci>buff_2</ci>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <ci>D_bicarb_out</ci>
                                <apply>
                                    <minus/>
                                    <ci>bicarb_t</ci>
                                    <ci>bicarb_t_nom</ci>
                                </apply>
                            </apply>
                            <ci>q_t</ci>
                        </apply>
                    </apply>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>D_bicarb_in</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="mol_per_m3">24</cn>
                                <ci>bicarb_t</ci>
                            </apply>
                        </apply>
                        <ci>q_t</ci>
                    </apply>
                </apply>
            </apply>
            <!-- the 24 in the above equation is a shortcut for bicarb_c-->
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>acid_t</ci>
                </apply>
                <apply>
                    <minus/>
                    <ci>buff_2</ci>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>D_acid_out</ci>
                            <apply>
                                <minus/>
                                <ci>acid_t</ci>
                                <ci>acid_t_nom</ci>
                            </apply>
                        </apply>
                        <ci>q_t</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>pH_t</ci>
                <apply>
                    <minus/>
                    <apply>
                        <log/>
                        <apply>
                            <divide/>
                            <ci>acid_t</ci>
                            <cn cellml:units="dimensionless">1000</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>D_acid_out</ci>
                <piecewise>
                    <piece>
                        <ci>D_acid_out_value</ci>
                        <apply>
                            <gt/>
                            <ci>acid_t</ci>
                            <ci>acid_t_nom</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="m3_per_s">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>D_bicarb_out</ci>
                <piecewise>
                    <piece>
                        <ci>D_bicarb_out_value</ci>
                        <apply>
                            <gt/>
                            <ci>bicarb_t</ci>
                            <ci>bicarb_t_nom</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="m3_per_s">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>D_bicarb_in</ci>
                <piecewise>
                    <piece>
                        <ci>D_bicarb_in_value</ci>
                        <apply>
                            <gt/>
                            <ci>acid_t</ci>
                            <ci>acid_t_nom</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="m3_per_s">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!-- Add D_acid_in as unconditional and relative to arterial acid 
 However, given blood pH generally higher than tissue, acid_in may be negligible-->
        <!-- ===================================== inverted dissociation curves ======================================-->
        <variable name="k_1" public_interface="in" units="J_per_m3"/>
        <variable name="k_2" public_interface="in" units="J_per_m3"/>
        <variable name="a_1" public_interface="in" units="dimensionless"/>
        <variable name="a_2" public_interface="in" units="dimensionless"/>
        <variable name="d_1" public_interface="out" units="J_per_m3"/>
        <variable name="d_2" public_interface="out" units="J_per_m3"/>
        <variable name="r_1" public_interface="out" units="J_per_m3"/>
        <variable name="r_2" public_interface="out" units="J_per_m3"/>
        <variable name="s_1" public_interface="out" units="J2_per_m6"/>
        <variable name="s_2" public_interface="out" units="J2_per_m6"/>
        <variable name="alpha_1" public_interface="in" units="m3_per_J"/>
        <variable name="alpha_2" public_interface="in" units="m3_per_J"/>
        <variable name="beta_1" public_interface="in" units="m3_per_J"/>
        <variable name="beta_2" public_interface="in" units="m3_per_J"/>
        <variable name="C_O2_sat" public_interface="in" units="mol_per_m3"/>
        <variable name="C_CO2_sat" public_interface="in" units="mol_per_m3"/>
        <!-- curve equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>d_1</ci>
                <apply>
                    <max/>
                    <apply>
                        <times/>
                        <ci>k_1</ci>
                        <apply>
                            <power/>
                            <apply>
                                <divide/>
                                <ci>C_O2_c</ci>
                                <apply>
                                    <minus/>
                                    <ci>C_O2_sat</ci>
                                    <ci>C_O2_c</ci>
                                </apply>
                            </apply>
                            <ci>a_1</ci>
                        </apply>
                    </apply>
                    <cn cellml:units="J_per_m3">0</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>d_2</ci>
                <apply>
                    <max/>
                    <apply>
                        <times/>
                        <ci>k_2</ci>
                        <apply>
                            <power/>
                            <apply>
                                <divide/>
                                <ci>C_CO2_c</ci>
                                <apply>
                                    <minus/>
                                    <ci>C_CO2_sat</ci>
                                    <ci>C_CO2_c</ci>
                                </apply>
                            </apply>
                            <ci>a_2</ci>
                        </apply>
                    </apply>
                    <cn cellml:units="J_per_m3">0</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>r_1</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.5</cn>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <minus/>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <times/>
                                        <ci>beta_1</ci>
                                        <ci>d_2</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>beta_2</ci>
                                    <ci>d_1</ci>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <ci>alpha_1</ci>
                                <ci>alpha_2</ci>
                                <ci>d_1</ci>
                                <ci>d_2</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_2</ci>
                        <apply>
                            <times/>
                            <ci>alpha_2</ci>
                            <ci>beta_1</ci>
                            <ci>d_2</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>r_2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.5</cn>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <minus/>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <times/>
                                        <ci>beta_2</ci>
                                        <ci>d_1</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>beta_1</ci>
                                    <ci>d_2</ci>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <ci>alpha_2</ci>
                                <ci>alpha_1</ci>
                                <ci>d_2</ci>
                                <ci>d_1</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_1</ci>
                        <apply>
                            <times/>
                            <ci>alpha_1</ci>
                            <ci>beta_2</ci>
                            <ci>d_1</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>s_1</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <ci>d_1</ci>
                            <apply>
                                <times/>
                                <ci>alpha_1</ci>
                                <ci>d_1</ci>
                                <ci>d_2</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_2</ci>
                        <apply>
                            <times/>
                            <ci>alpha_2</ci>
                            <ci>beta_1</ci>
                            <ci>d_2</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>s_2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <ci>d_2</ci>
                            <apply>
                                <times/>
                                <ci>alpha_2</ci>
                                <ci>d_2</ci>
                                <ci>d_1</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_1</ci>
                        <apply>
                            <times/>
                            <ci>alpha_1</ci>
                            <ci>beta_2</ci>
                            <ci>d_1</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="arterial_chemoreceptor">
        <variable name="t" public_interface="in" units="second"/>
        <!-- inputs-->
        <variable name="acid_t" public_interface="in" units="mol_per_m3"/>
        <variable name="ub_O2_t" public_interface="in" units="mol_per_m3"/>
        <!-- constants-->
        <variable name="G" public_interface="in" units="m3_per_mol_per_sec"/>
        <variable name="acid_t_nom" public_interface="in" units="mol_per_m3"/>
        <variable name="ub_O2_t_nom" public_interface="in" units="mol_per_m3"/>
        <variable name="A" public_interface="in" units="m3_per_mol"/>
        <variable name="M" public_interface="in" units="per_s"/>
        <!-- response-->
        <variable name="f_apc" units="per_s"/>
        <variable name="r" units="per_s"/>
        <!-- equations
 need to validate there is a H+ threshold
 include term if ub_O2_t falls below threshold to reduce/cease f_apc-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>f_apc</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="per_s">0</cn>
                        <apply>
                            <lt/>
                            <ci>acid_t</ci>
                            <ci>acid_t_nom</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <times/>
                            <ci>M</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="per_s">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <minus/>
                                            <ci>r</ci>
                                        </apply>
                                        <ci>M</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <!-- consider including additive term e.g. baseline-->
            <apply>
                <eq/>
                <ci>r</ci>
                <apply>
                    <times/>
                    <ci>G</ci>
                    <apply>
                        <minus/>
                        <ci>acid_t</ci>
                        <ci>acid_t_nom</ci>
                    </apply>
                    <apply>
                        <exp/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <ci>A</ci>
                            </apply>
                            <apply>
                                <minus/>
                                <ci>ub_O2_t</ci>
                                <ci>ub_O2_t_nom</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
</model>
