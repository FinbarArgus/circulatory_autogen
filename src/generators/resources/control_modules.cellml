<?xml version='1.0' encoding='UTF-8'?>
<model name="modules" xmlns="http://www.cellml.org/cellml/1.1#" xmlns:cellml="http://www.cellml.org/cellml/1.1#">
    <!--//////////////////////////////////////////////////////////////////////////////////////////////////////
///////////// module baroreceptor firing rate from carotid and aortic arch pressures ///
//////////////////////////////////////////////////////////////////////////////////////////////////////-->
    <component name="baroreceptor_type">
        <variable name="t" public_interface="in" units="second"/>
        <variable name="P_sys" public_interface="in" units="J_per_m3"/>
        <variable name="P_baro_init" public_interface="in" units="J_per_m3"/>
        <variable initial_value="P_baro_init" name="P_baro" public_interface="out" units="J_per_m3"/>
        <variable name="f_ab" public_interface="out" units="per_s"/>
        <variable name="dP_sys_dt" public_interface="in" units="J_per_m3s"/>
        <!-- Constants-->
        <variable name="P_nom" public_interface="in" units="J_per_m3"/>
        <variable name="f_ab_min" public_interface="in" units="per_s"/>
        <variable name="f_ab_max" public_interface="in" units="per_s"/>
        <variable name="k_ab" public_interface="in" units="J_per_m3"/>
        <variable name="tau_zb" public_interface="in" units="second"/>
        <variable name="tau_pb" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>P_baro</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <plus/>
                            <ci>P_sys</ci>
                            <apply>
                                <times/>
                                <ci>tau_zb</ci>
                                <ci>dP_sys_dt</ci>
                            </apply>
                        </apply>
                        <ci>P_baro</ci>
                    </apply>
                    <ci>tau_pb</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>f_ab</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <ci>f_ab_min</ci>
                        <apply>
                            <times/>
                            <ci>f_ab_max</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <ci>P_baro</ci>
                                        <ci>P_nom</ci>
                                    </apply>
                                    <ci>k_ab</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>P_baro</ci>
                                    <ci>P_nom</ci>
                                </apply>
                                <ci>k_ab</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="chemoreceptor_type">
        <variable name="t" public_interface="in" units="second"/>
        <!--inp variables-->
        <variable name="C_CO2_a" public_interface="in" units="dimensionless"/>
        <variable name="C_O2_a" public_interface="in" units="dimensionless"/>
        <variable name="dot_C_CO2_a" public_interface="in" units="per_s"/>
        <!--output variables-->
        <variable name="X_O2" public_interface="out" units="dimensionless"/>
        <variable name="phi_stat" public_interface="out" units="per_s"/>
        <variable initial_value="0.0" name="phi_CO2_dyn" public_interface="out" units="per_s"/>
        <variable name="f_c_stat" public_interface="out" units="per_s"/>
        <variable name="f_c_dyn" public_interface="out" units="per_s"/>
        <variable name="f_apc" public_interface="out" units="per_s"/>
        <variable initial_value="0.0" name="phi_apc" public_interface="out" units="per_s"/>
        <variable name="P_O2_a" public_interface="out" units="J_per_m3"/>
        <!-- Constants-->
        <variable name="AA" public_interface="in" units="dimensionless"/>
        <variable name="BB" public_interface="in" units="dimensionless"/>
        <variable name="C_CO2_a_nom" public_interface="in" units="dimensionless"/>
        <variable name="K_O2" public_interface="in" units="dimensionless"/>
        <variable name="K_CO2" public_interface="in" units="per_s"/>
        <variable name="K_stat" public_interface="in" units="per_s"/>
        <variable name="K_dyn" public_interface="in" units="per_s"/>
        <variable name="tau_cap" public_interface="in" units="second"/>
        <variable name="tau_CO2_cc_dyn" public_interface="in" units="dimensionless"/>
        <!-- equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>X_O2</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>AA</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>S_O2_a</ci>
                        </apply>
                    </apply>
                    <ci>BB</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>phi_stat</ci>
                <apply>
                    <times/>
                    <ci>K_CO2</ci>
                    <apply>
                        <minus/>
                        <ci>C_CO2_a</ci>
                        <ci>C_CO2_a_nom</ci>
                    </apply>
                    <ci>K_O2</ci>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>X_O2</ci>
                                </apply>
                                <ci>K_O2</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>f_c_stat</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>K_stat</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <minus/>
                                            <ci>phi_stat</ci>
                                        </apply>
                                        <ci>K_stat</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <geq/>
                            <ci>C_CO2_a</ci>
                            <ci>C_CO2_a_nom</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="per_s">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>phi_CO2_dyn</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>dot_C_CO2_a</ci>
                            <ci>tau_CO2_cc_dyn</ci>
                        </apply>
                        <ci>phi_CO2_dyn</ci>
                    </apply>
                    <ci>tau_cap</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>f_c_dyn</ci>
                <apply>
                    <times/>
                    <ci>K_dyn</ci>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>phi_CO2_dyn</ci>
                                </apply>
                                <ci>K_dyn</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>phi_apc</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <plus/>
                            <ci>f_c_stat</ci>
                            <ci>f_c_dyn</ci>
                        </apply>
                        <ci>phi_apc</ci>
                    </apply>
                    <ci>tau_cap</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>f_apc</ci>
                <apply>
                    <max/>
                    <ci>phi_apc</ci>
                    <cn cellml:units="per_s">0</cn>
                </apply>
            </apply>
        </math>
        <!--Calculate saturation-->
        <variable name="C_O2_a_diss" public_interface="out" units="dimensionless"/>
        <variable name="S_O2_a" public_interface="out" units="dimensionless"/>
        <variable name="Hgb" public_interface="in" units="kg_per_m3"/>
        <variable name="alpha_O2" public_interface="in" units="m3_per_J"/>
        <!-- should be handled in parameter.csv  = 2.33e-7 (per_pascal)-->
        <!-- from inverted dissociation-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>P_O2_a</ci>
                <apply>
                    <plus/>
                    <ci>r_1</ci>
                    <apply>
                        <root/>
                        <apply>
                            <minus/>
                            <apply>
                                <power/>
                                <ci>r_1</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>s_1</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>overcap_solubility</ci>
                        <ci>C_O2_a_extra_ub</ci>
                    </apply>
                </apply>
            </apply>
            <!-- P_CO2_a = d_2*(1{dimensionless}+alpha_2*P_O2_p)/(1{dimensionless}+beta_2*P_O2_p);
 TODO I need to check this, it is different to the Ursino papers and to the gas exchange modules.-->
            <apply>
                <eq/>
                <ci>C_O2_a_diss</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>P_O2_a</ci>
                            <ci>alpha_O2</ci>
                        </apply>
                        <apply>
                            <geq/>
                            <apply>
                                <minus/>
                                <apply>
                                    <minus/>
                                    <ci>C_O2_sat</ci>
                                    <apply>
                                        <times/>
                                        <ci>Hgb</ci>
                                        <cn cellml:units="m3_per_kg" type="e-notation">1.34<sep/>-3</cn>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>P_O2_a</ci>
                                    <ci>alpha_O2</ci>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <minus/>
                            <ci>C_O2_sat</ci>
                            <apply>
                                <times/>
                                <ci>Hgb</ci>
                                <cn cellml:units="m3_per_kg" type="e-notation">1.34<sep/>-3</cn>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>S_O2_a</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>C_O2_a</ci>
                        <ci>C_O2_a_diss</ci>
                    </apply>
                    <apply>
                        <times/>
                        <ci>Hgb</ci>
                        <cn cellml:units="m3_per_kg" type="e-notation">1.34<sep/>-3</cn>
                    </apply>
                </apply>
            </apply>
        </math>
        <!--____________ inverted dissociation curve below here___________-->
        <variable name="k_1" public_interface="in" units="J_per_m3"/>
        <variable name="k_2" public_interface="in" units="J_per_m3"/>
        <variable name="h_1" public_interface="in" units="dimensionless"/>
        <variable name="h_2" public_interface="in" units="dimensionless"/>
        <variable name="d_1" public_interface="out" units="J_per_m3"/>
        <variable name="d_2" public_interface="out" units="J_per_m3"/>
        <variable name="r_1" public_interface="out" units="J_per_m3"/>
        <variable name="r_2" public_interface="out" units="J_per_m3"/>
        <variable name="s_1" public_interface="out" units="J2_per_m6"/>
        <variable name="s_2" public_interface="out" units="J2_per_m6"/>
        <variable name="alpha_1" public_interface="in" units="m3_per_J"/>
        <variable name="alpha_2" public_interface="in" units="m3_per_J"/>
        <variable name="beta_1" public_interface="in" units="m3_per_J"/>
        <variable name="beta_2" public_interface="in" units="m3_per_J"/>
        <variable name="C_O2_sat" public_interface="in" units="dimensionless"/>
        <variable name="C_CO2_sat" public_interface="in" units="dimensionless"/>
        <!-- including the below to avoid divide by zero problems. This probably isn't needed.-->
        <variable name="C_O2_a_capped" public_interface="out" units="dimensionless"/>
        <variable name="C_CO2_a_capped" public_interface="out" units="dimensionless"/>
        <variable name="C_O2_a_extra_ub" public_interface="out" units="dimensionless"/>
        <variable name="overcap_solubility" public_interface="in" units="J_per_m3"/>
        <variable name="saturation_cap" public_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>C_O2_a_capped</ci>
                <apply>
                    <min/>
                    <apply>
                        <times/>
                        <ci>C_O2_sat</ci>
                        <ci>saturation_cap</ci>
                    </apply>
                    <ci>C_O2_a</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>C_CO2_a_capped</ci>
                <apply>
                    <min/>
                    <apply>
                        <times/>
                        <ci>C_CO2_sat</ci>
                        <ci>saturation_cap</ci>
                    </apply>
                    <ci>C_CO2_a</ci>
                </apply>
            </apply>
            <!-- This is the amount that is extra in the plasma due to capping the amount that can be saturated.-->
            <apply>
                <eq/>
                <ci>C_O2_a_extra_ub</ci>
                <apply>
                    <max/>
                    <apply>
                        <minus/>
                        <ci>C_O2_a</ci>
                        <apply>
                            <times/>
                            <ci>C_O2_sat</ci>
                            <ci>saturation_cap</ci>
                        </apply>
                    </apply>
                    <cn cellml:units="dimensionless">0</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>d_1</ci>
                <apply>
                    <max/>
                    <apply>
                        <times/>
                        <ci>k_1</ci>
                        <apply>
                            <power/>
                            <apply>
                                <divide/>
                                <ci>C_O2_a_capped</ci>
                                <apply>
                                    <minus/>
                                    <ci>C_O2_sat</ci>
                                    <ci>C_O2_a_capped</ci>
                                </apply>
                            </apply>
                            <ci>h_1</ci>
                        </apply>
                    </apply>
                    <cn cellml:units="J_per_m3">0</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>d_2</ci>
                <apply>
                    <max/>
                    <apply>
                        <times/>
                        <ci>k_2</ci>
                        <apply>
                            <power/>
                            <apply>
                                <divide/>
                                <ci>C_CO2_a_capped</ci>
                                <apply>
                                    <minus/>
                                    <ci>C_CO2_sat</ci>
                                    <ci>C_CO2_a_capped</ci>
                                </apply>
                            </apply>
                            <ci>h_2</ci>
                        </apply>
                    </apply>
                    <cn cellml:units="J_per_m3">0</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>r_1</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.5</cn>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <minus/>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <times/>
                                        <ci>beta_1</ci>
                                        <ci>d_2</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>beta_2</ci>
                                    <ci>d_1</ci>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <ci>alpha_1</ci>
                                <ci>alpha_2</ci>
                                <ci>d_1</ci>
                                <ci>d_2</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_2</ci>
                        <apply>
                            <times/>
                            <ci>alpha_2</ci>
                            <ci>beta_1</ci>
                            <ci>d_2</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>r_2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.5</cn>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <minus/>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <times/>
                                        <ci>beta_2</ci>
                                        <ci>d_1</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>beta_1</ci>
                                    <ci>d_2</ci>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <ci>alpha_2</ci>
                                <ci>alpha_1</ci>
                                <ci>d_2</ci>
                                <ci>d_1</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_1</ci>
                        <apply>
                            <times/>
                            <ci>alpha_1</ci>
                            <ci>beta_2</ci>
                            <ci>d_1</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>s_1</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <ci>d_1</ci>
                            <apply>
                                <times/>
                                <ci>alpha_1</ci>
                                <ci>d_1</ci>
                                <ci>d_2</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_2</ci>
                        <apply>
                            <times/>
                            <ci>alpha_2</ci>
                            <ci>beta_1</ci>
                            <ci>d_2</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>s_2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <ci>d_2</ci>
                            <apply>
                                <times/>
                                <ci>alpha_2</ci>
                                <ci>d_2</ci>
                                <ci>d_1</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>beta_1</ci>
                        <apply>
                            <times/>
                            <ci>alpha_1</ci>
                            <ci>beta_2</ci>
                            <ci>d_1</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="afferent_to_vagal_efferent_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- Constants-->
        <variable name="f_ev_0" public_interface="in" units="per_s"/>
        <variable name="f_ev_inf" public_interface="in" units="per_s"/>
        <variable name="f_ab_0" public_interface="in" units="per_s"/>
        <variable name="theta_v" public_interface="in" units="per_s"/>
        <variable name="W_cv" public_interface="in" units="dimensionless"/>
        <!-- var W_pv: dimensionless {pub: in}; not yet including lung stretch receptor effects-->
        <variable name="k_ev" public_interface="in" units="per_s"/>
        <!-- Variables-->
        <variable name="f_apc" public_interface="in" units="per_s"/>
        <variable name="f_ab" public_interface="in" units="per_s"/>
        <!-- var f_ap: per_s {pub: in};-->
        <variable name="f_v" public_interface="out" units="per_s"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>f_v</ci>
                <apply>
                    <minus/>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <apply>
                                <plus/>
                                <ci>f_ev_0</ci>
                                <apply>
                                    <times/>
                                    <ci>f_ev_inf</ci>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <minus/>
                                                <ci>f_ab</ci>
                                                <ci>f_ab_0</ci>
                                            </apply>
                                            <ci>k_ev</ci>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <minus/>
                                            <ci>f_ab</ci>
                                            <ci>f_ab_0</ci>
                                        </apply>
                                        <ci>k_ev</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>W_cv</ci>
                            <ci>f_apc</ci>
                        </apply>
                    </apply>
                    <ci>theta_v</ci>
                </apply>
            </apply>
        </math>
        <!-- + W_pv*f_ap-->
    </component>
    <component name="afferent_to_sympathetic_efferent_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- Constants-->
        <variable name="f_es_0" public_interface="in" units="per_s"/>
        <variable name="f_es_inf" public_interface="in" units="per_s"/>
        <variable name="f_es_max" public_interface="in" units="per_s"/>
        <variable name="k_es" public_interface="in" units="second"/>
        <!-- should be changed to second-->
        <!-- var theta_s: per_s {pub: in}; //currently ignoring CNS-->
        <variable name="W_bs" public_interface="in" units="dimensionless"/>
        <variable name="W_cs" public_interface="in" units="dimensionless"/>
        <!-- var W_cp: dimensionless {pub: in}; TODO cardiopulmonary and lungstretch signals need to be included.
 var W_ls: dimensionless {pub: in};-->
        <!-- Variables-->
        <variable name="f_apc" public_interface="in" units="per_s"/>
        <variable name="f_ab" public_interface="in" units="per_s"/>
        <!-- var f_ap: per_s {pub: in};-->
        <variable name="f_s_premax" public_interface="out" units="per_s"/>
        <variable name="f_s" public_interface="out" units="per_s"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>f_s_premax</ci>
                <apply>
                    <plus/>
                    <ci>f_es_inf</ci>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <ci>f_es_0</ci>
                            <ci>f_es_inf</ci>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <times/>
                                <ci>k_es</ci>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <times/>
                                        <ci>W_bs</ci>
                                        <ci>f_ab</ci>
                                    </apply>
                                    <apply>
                                        <times/>
                                        <ci>W_cs</ci>
                                        <ci>f_apc</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!-- + w_cp*f_cp + w_ls*f_ls));-->
            <!--IGNORING CNS and LUNG STRETCH-->
            <apply>
                <eq/>
                <ci>f_s</ci>
                <piecewise>
                    <piece>
                        <ci>f_s_premax</ci>
                        <apply>
                            <leq/>
                            <ci>f_s_premax</ci>
                            <ci>f_es_max</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>f_es_max</ci>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
    </component>
    <component name="efferent_resistance_effector_Argus_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- IMPORTANT: THIS MODULE ASSUMES NO DELAY CONSTANTS, WHICH IS DIFFERENT TO THE ORIGINAL PAPER, ALBANESE2016-->
        <!-- Constants-->
        <variable name="G_theta" public_interface="in" units="dimensionless"/>
        <variable name="f_es_min" public_interface="in" units="per_s"/>
        <variable name="f_es_mid" public_interface="in" units="per_s"/>
        <variable name="tau_theta" public_interface="in" units="second"/>
        <!-- Variables-->
        <variable name="f_s" public_interface="in" units="per_s"/>
        <variable name="Delta_theta" public_interface="out" units="dimensionless"/>
        <variable initial_value="0.0" name="sigma_theta" public_interface="out" units="per_s"/>
        <!-- Delta_theta now multiplies by the baseline resistance to calculate how much to add to allow for easier calibration.-->
        <!-- Equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>sigma_theta</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <max/>
                            <apply>
                                <minus/>
                                <ci>f_s</ci>
                                <ci>f_es_min</ci>
                            </apply>
                            <cn cellml:units="per_s">0</cn>
                        </apply>
                        <ci>sigma_theta</ci>
                    </apply>
                    <ci>tau_theta</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Delta_theta</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>G_theta</ci>
                        <ci>sigma_theta</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>f_es_mid</ci>
                        <ci>sigma_theta</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="efferent_resistance_effector_Ursino_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- IMPORTANT: THIS MODULE ASSUMES NO DELAY CONSTANTS, WHICH IS DIFFERENT TO THE ORIGINAL PAPER, ALBANESE2016-->
        <!-- Constants-->
        <variable name="G_theta" public_interface="in" units="Js_per_m6"/>
        <variable name="f_es_min" public_interface="in" units="per_s"/>
        <variable name="tau_theta" public_interface="in" units="second"/>
        <!-- Variables-->
        <variable name="f_s" public_interface="in" units="per_s"/>
        <variable initial_value="0.0" name="Delta_theta" public_interface="out" units="Js_per_m6"/>
        <variable name="sigma_theta" public_interface="out" units="Js_per_m6"/>
        <!-- Equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>sigma_theta</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>G_theta</ci>
                            <apply>
                                <ln/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="second">1</cn>
                                    <apply>
                                        <plus/>
                                        <apply>
                                            <minus/>
                                            <ci>f_s</ci>
                                            <ci>f_es_min</ci>
                                        </apply>
                                        <cn cellml:units="per_s">1</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <geq/>
                            <ci>f_s</ci>
                            <ci>f_es_min</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="Js_per_m6">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_theta</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_theta</ci>
                        </apply>
                        <ci>sigma_theta</ci>
                    </apply>
                    <ci>tau_theta</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="efferent_heart_elastance_effector_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- IMPORTANT: THIS MODULE ASSUMES NO DELAY CONSTANTS, WHICH IS DIFFERENT TO THE ORIGINAL PAPER, ALBANESE2016-->
        <!-- Constants-->
        <variable name="G_theta" public_interface="in" units="J_per_m6"/>
        <variable name="f_es_min" public_interface="in" units="per_s"/>
        <variable name="tau_theta" public_interface="in" units="second"/>
        <!-- Variables-->
        <variable name="f_s" public_interface="in" units="per_s"/>
        <variable initial_value="0.0" name="Delta_theta" public_interface="out" units="J_per_m6"/>
        <variable name="sigma_theta" public_interface="out" units="J_per_m6"/>
        <!-- Equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>sigma_theta</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>G_theta</ci>
                            <apply>
                                <ln/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="second">1</cn>
                                    <apply>
                                        <plus/>
                                        <apply>
                                            <minus/>
                                            <ci>f_s</ci>
                                            <ci>f_es_min</ci>
                                        </apply>
                                        <cn cellml:units="per_s">1</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <geq/>
                            <ci>f_s</ci>
                            <ci>f_es_min</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="J_per_m6">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_theta</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_theta</ci>
                        </apply>
                        <ci>sigma_theta</ci>
                    </apply>
                    <ci>tau_theta</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="efferent_venous_us_volume_and_compliance_effector_Argus_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- IMPORTANT: THIS MODULE ASSUMES NO DELAY CONSTANTS, WHICH IS DIFFERENT TO THE ORIGINAL PAPER, ALBANESE2016-->
        <!-- IMPORTANT: THIS MODULE HAS BEEN MODIFIED TO CONTROL COMPLIANCE INSTEAD OF UNSTRESSED VOLUME. PARAMS ARE UNVALIDATED-->
        <!-- Constants-->
        <variable name="G_theta_us" public_interface="in" units="dimensionless"/>
        <variable name="G_theta_compliance" public_interface="in" units="dimensionless"/>
        <variable name="f_es_min" public_interface="in" units="per_s"/>
        <variable name="f_es_mid" public_interface="in" units="per_s"/>
        <variable name="tau_theta_us" public_interface="in" units="second"/>
        <variable name="tau_theta_compliance" public_interface="in" units="second"/>
        <!-- Variables-->
        <variable name="f_s" public_interface="in" units="per_s"/>
        <variable name="Delta_theta_us" public_interface="out" units="dimensionless"/>
        <variable initial_value="0.0" name="sigma_theta_us" public_interface="out" units="per_s"/>
        <variable name="Delta_theta_compliance" public_interface="out" units="dimensionless"/>
        <variable initial_value="0.0" name="sigma_theta_compliance" public_interface="out" units="per_s"/>
        <!-- Equations-->
        <!-- TODO for both of the below, it probably shouln't be additive. It should be impossible to get to negative.
 changed the below from ln to hill function so we can limit the amount it can change compliance and us volume. Now G_theta_us is the maximum amount of change
 that can occur to the us volume
 G_theta is now a max proportion of us volume or compliance that can be decreased.-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>sigma_theta_us</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <max/>
                            <apply>
                                <minus/>
                                <ci>f_s</ci>
                                <ci>f_es_min</ci>
                            </apply>
                            <cn cellml:units="per_s">0</cn>
                        </apply>
                        <ci>sigma_theta_us</ci>
                    </apply>
                    <ci>tau_theta_us</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Delta_theta_us</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>G_theta_compliance</ci>
                        <ci>sigma_theta_us</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>f_es_mid</ci>
                        <ci>sigma_theta_us</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>sigma_theta_compliance</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <max/>
                            <apply>
                                <minus/>
                                <ci>f_s</ci>
                                <ci>f_es_min</ci>
                            </apply>
                            <cn cellml:units="per_s">0</cn>
                        </apply>
                        <ci>sigma_theta_compliance</ci>
                    </apply>
                    <ci>tau_theta_compliance</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Delta_theta_compliance</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>G_theta_compliance</ci>
                        <ci>sigma_theta_compliance</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>f_es_mid</ci>
                        <ci>sigma_theta_compliance</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="efferent_heart_period_effector_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- IMPORTANT: THIS MODULE ASSUMES NO DELAY CONSTANTS, WHICH IS DIFFERENT TO THE ORIGINAL PAPER, ALBANESE2016-->
        <!-- Constants-->
        <variable name="G_Ts" public_interface="in" units="second"/>
        <variable name="G_Tv" public_interface="in" units="s2"/>
        <variable name="f_es_min" public_interface="in" units="per_s"/>
        <variable name="tau_Ts" public_interface="in" units="second"/>
        <variable name="tau_Tv" public_interface="in" units="second"/>
        <!-- Variables-->
        <variable name="f_s" public_interface="in" units="per_s"/>
        <variable name="f_v" public_interface="in" units="per_s"/>
        <variable initial_value="0.0" name="Delta_Ts" public_interface="out" units="second"/>
        <variable initial_value="0.0" name="Delta_Tv" public_interface="out" units="second"/>
        <variable name="Delta_T" public_interface="out" units="second"/>
        <variable name="sigma_Ts" public_interface="out" units="second"/>
        <variable name="sigma_Tv" public_interface="out" units="second"/>
        <!-- Equations-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>sigma_Ts</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>G_Ts</ci>
                            <apply>
                                <ln/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="second">1</cn>
                                    <apply>
                                        <plus/>
                                        <apply>
                                            <minus/>
                                            <ci>f_s</ci>
                                            <ci>f_es_min</ci>
                                        </apply>
                                        <cn cellml:units="per_s">1</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <geq/>
                            <ci>f_s</ci>
                            <ci>f_es_min</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="second">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_Ts</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_Ts</ci>
                        </apply>
                        <ci>sigma_Ts</ci>
                    </apply>
                    <ci>tau_Ts</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>sigma_Tv</ci>
                <apply>
                    <times/>
                    <ci>G_Tv</ci>
                    <ci>f_v</ci>
                </apply>
            </apply>
            <!--DELAY IGNORED-->
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_Tv</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_Tv</ci>
                        </apply>
                        <ci>sigma_Tv</ci>
                    </apply>
                    <ci>tau_Tv</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Delta_T</ci>
                <apply>
                    <plus/>
                    <ci>Delta_Tv</ci>
                    <ci>Delta_Ts</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="local_flow_control_muscle_type">
        <variable name="t" public_interface="in" units="second"/>
        <variable initial_value="0.0" name="x_O2" public_interface="out" units="dimensionless"/>
        <variable name="phi_P_CO2_a" public_interface="out" units="dimensionless"/>
        <variable initial_value="0.0" name="x_CO2" public_interface="out" units="dimensionless"/>
        <variable name="C_O2_p" public_interface="in" units="dimensionless"/>
        <variable name="P_CO2_a" public_interface="in" units="J_per_m3"/>
        <variable name="R_local_multiplier" public_interface="out" units="dimensionless"/>
        <variable name="P_O2_a" public_interface="in" units="J_per_m3"/>
        <!-- Constants-->
        <variable name="P_CO2_a_nom" public_interface="in" units="J_per_m3"/>
        <variable name="k_CO2_m" public_interface="in" units="J_per_m3"/>
        <variable name="C_O2_vm_nom" public_interface="in" units="dimensionless"/>
        <variable name="tau_O2" public_interface="in" units="second"/>
        <variable name="tau_CO2" public_interface="in" units="second"/>
        <variable name="g_O2_m" public_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>x_O2</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <plus/>
                            <apply>
                                <minus/>
                                <ci>x_O2</ci>
                            </apply>
                            <ci>C_O2_p</ci>
                        </apply>
                        <ci>C_O2_vm_nom</ci>
                    </apply>
                    <ci>tau_O2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>phi_P_CO2_a</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>P_CO2_a</ci>
                                    <ci>P_CO2_a_nom</ci>
                                </apply>
                                <ci>k_CO2_m</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>P_CO2_a</ci>
                                    <ci>P_CO2_a_nom</ci>
                                </apply>
                                <ci>k_CO2_m</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>x_CO2</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>x_CO2</ci>
                        </apply>
                        <ci>phi_P_CO2_a</ci>
                    </apply>
                    <ci>tau_CO2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>R_local_multiplier</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>x_CO2</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <times/>
                            <ci>g_O2_m</ci>
                            <ci>x_O2</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="local_flow_control_brain_type">
        <variable name="t" public_interface="in" units="second"/>
        <variable initial_value="0.0" name="x_O2" public_interface="out" units="dimensionless"/>
        <variable name="phi_P_CO2_a" public_interface="out" units="dimensionless"/>
        <variable initial_value="0.0" name="x_CO2" public_interface="out" units="dimensionless"/>
        <variable name="C_O2_p" public_interface="in" units="dimensionless"/>
        <variable name="P_CO2_a" public_interface="in" units="J_per_m3"/>
        <variable name="R_local_multiplier" public_interface="out" units="dimensionless"/>
        <variable name="P_O2_a" public_interface="in" units="J_per_m3"/>
        <variable name="G_p" public_interface="out" units="dimensionless"/>
        <!-- Constants-->
        <variable name="P_CO2_a_nom" public_interface="in" units="J_per_m3"/>
        <variable name="C_O2_vb_nom" public_interface="in" units="dimensionless"/>
        <variable name="tau_O2" public_interface="in" units="second"/>
        <variable name="tau_CO2" public_interface="in" units="second"/>
        <variable name="g_O2_b" public_interface="in" units="dimensionless"/>
        <variable name="A_b_lc" public_interface="in" units="dimensionless"/>
        <variable name="B_b_lc" public_interface="in" units="dimensionless"/>
        <variable name="C_b_lc" public_interface="in" units="dimensionless"/>
        <variable name="D_b_lc" public_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>x_O2</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <apply>
                            <plus/>
                            <apply>
                                <minus/>
                                <ci>x_O2</ci>
                            </apply>
                            <ci>C_O2_p</ci>
                        </apply>
                        <ci>C_O2_vb_nom</ci>
                    </apply>
                    <ci>tau_O2</ci>
                </apply>
            </apply>
            <!-- Unit consistancy in ln() - may need to add the unit-->
            <apply>
                <eq/>
                <ci>phi_P_CO2_a</ci>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <apply>
                            <plus/>
                            <ci>A_b_lc</ci>
                            <apply>
                                <divide/>
                                <ci>B_b_lc</ci>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <times/>
                                        <ci>C_b_lc</ci>
                                        <apply>
                                            <exp/>
                                            <apply>
                                                <times/>
                                                <ci>D_b_lc</ci>
                                                <apply>
                                                    <ln/>
                                                    <apply>
                                                        <times/>
                                                        <cn cellml:units="m3_per_J">1</cn>
                                                        <ci>P_CO2_a</ci>
                                                    </apply>
                                                </apply>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <plus/>
                            <ci>A_b_lc</ci>
                            <apply>
                                <divide/>
                                <ci>B_b_lc</ci>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <times/>
                                        <ci>C_b_lc</ci>
                                        <apply>
                                            <exp/>
                                            <apply>
                                                <times/>
                                                <ci>D_b_lc</ci>
                                                <apply>
                                                    <ln/>
                                                    <apply>
                                                        <times/>
                                                        <cn cellml:units="m3_per_J">1</cn>
                                                        <ci>P_CO2_a_nom</ci>
                                                    </apply>
                                                </apply>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="dimensionless">1</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>x_CO2</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>x_CO2</ci>
                        </apply>
                        <ci>phi_P_CO2_a</ci>
                    </apply>
                    <ci>tau_CO2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>G_p</ci>
                <apply>
                    <plus/>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <times/>
                            <ci>g_O2_b</ci>
                            <ci>x_O2</ci>
                        </apply>
                    </apply>
                    <ci>x_CO2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>R_local_multiplier</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <ci>G_p</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="afferent_to_respiratory_efferent_type">
        <variable name="t" public_interface="in" units="second"/>
        <!--constants-->
        <variable name="P_CO2_a_nom" public_interface="in" units="J_per_m3"/>
        <variable name="K_c_resp" public_interface="in" units="m3_per_Js"/>
        <variable name="f_apc_nom" public_interface="in" units="per_s"/>
        <variable name="K_p_resp" public_interface="in" units="dimensionless"/>
        <!-- boundary conditions/inputs-->
        <variable name="P_CO2_a" public_interface="in" units="J_per_m3"/>
        <variable name="P_O2_a" public_interface="in" units="J_per_m3"/>
        <variable name="f_apc" public_interface="in" units="per_s"/>
        <!--variables-->
        <variable name="u_p_resp" public_interface="out" units="per_s"/>
        <variable name="u_c_resp" public_interface="out" units="per_s"/>
        <!-- TODO these need time dynamics to delay them.
 TODO change these to frequencies to properly model afferent to efferent.-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>u_c_resp</ci>
                <apply>
                    <times/>
                    <ci>K_c_resp</ci>
                    <apply>
                        <minus/>
                        <ci>P_CO2_a</ci>
                        <ci>P_CO2_a_nom</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>u_p_resp</ci>
                <apply>
                    <times/>
                    <ci>K_p_resp</ci>
                    <apply>
                        <minus/>
                        <ci>f_apc</ci>
                        <ci>f_apc_nom</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="efferent_respiratory_effector_type">
        <variable name="t" public_interface="in" units="second"/>
        <!-- peripheral chemo constants
 var D_p: second {pub: in}; DELAY NOT APPLIED-->
        <variable name="G_pA" public_interface="in" units="Js_per_m3"/>
        <variable name="G_pf" public_interface="in" units="dimensionless"/>
        <variable name="tau_pA_min" public_interface="in" units="second"/>
        <variable name="tau_pA_max" public_interface="in" units="second"/>
        <variable name="tau_pA" public_interface="out" units="second"/>
        <variable name="tau_pf_min" public_interface="in" units="second"/>
        <variable name="tau_pf_max" public_interface="in" units="second"/>
        <variable name="tau_pf" public_interface="out" units="second"/>
        <!-- unit inconsistancy for 0 resolved-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>tau_pA</ci>
                <piecewise>
                    <piece>
                        <ci>tau_pA_max</ci>
                        <apply>
                            <geq/>
                            <ci>u_p_resp</ci>
                            <cn cellml:units="per_s">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>tau_pA_min</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>tau_pf</ci>
                <piecewise>
                    <piece>
                        <ci>tau_pf_max</ci>
                        <apply>
                            <geq/>
                            <ci>u_p_resp</ci>
                            <cn cellml:units="per_s">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>tau_pf_min</ci>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!--central chemo constants
 var D_c: second {pub: in}; DELAY NOT APPLIED-->
        <variable name="G_cA_max" public_interface="in" units="Js_per_m3"/>
        <variable name="G_cA" public_interface="out" units="Js_per_m3"/>
        <variable name="G_cf_max" public_interface="in" units="dimensionless"/>
        <variable name="G_cf" public_interface="out" units="dimensionless"/>
        <variable name="tau_cA_max" public_interface="in" units="second"/>
        <variable name="tau_cA_min" public_interface="in" units="second"/>
        <variable name="tau_cA" public_interface="out" units="second"/>
        <variable name="tau_cf_max" public_interface="in" units="second"/>
        <variable name="tau_cf_min" public_interface="in" units="second"/>
        <variable name="tau_cf" public_interface="out" units="second"/>
        <variable name="u_CO2_c_thresh" public_interface="in" units="per_s"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>G_cA</ci>
                <piecewise>
                    <piece>
                        <ci>G_cA_max</ci>
                        <apply>
                            <gt/>
                            <ci>u_c_resp</ci>
                            <ci>u_CO2_c_thresh</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="Js_per_m3">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>G_cf</ci>
                <piecewise>
                    <piece>
                        <ci>G_cf_max</ci>
                        <apply>
                            <gt/>
                            <ci>u_c_resp</ci>
                            <ci>u_CO2_c_thresh</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>tau_cA</ci>
                <piecewise>
                    <piece>
                        <ci>tau_cA_max</ci>
                        <apply>
                            <gt/>
                            <ci>u_c_resp</ci>
                            <ci>u_CO2_c_thresh</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>tau_cA_min</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>tau_cf</ci>
                <piecewise>
                    <piece>
                        <ci>tau_cf_max</ci>
                        <apply>
                            <gt/>
                            <ci>u_c_resp</ci>
                            <ci>u_CO2_c_thresh</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>tau_cf_min</ci>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!-- boundary conditions/inputs-->
        <variable name="u_c_resp" public_interface="in" units="per_s"/>
        <variable name="u_p_resp" public_interface="in" units="per_s"/>
        <!-- variables-->
        <variable initial_value="0.0" name="Delta_RR_c" public_interface="out" units="Hz"/>
        <variable initial_value="0.0" name="Delta_RR_p" public_interface="out" units="Hz"/>
        <variable name="Delta_RR_resp" public_interface="out" units="per_s"/>
        <variable initial_value="0.0" name="Delta_P_mus_c" public_interface="out" units="J_per_m3"/>
        <variable initial_value="0.0" name="Delta_P_mus_p" public_interface="out" units="J_per_m3"/>
        <variable name="Delta_P_mus" public_interface="out" units="J_per_m3"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_RR_c</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_RR_c</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>G_cf</ci>
                            <ci>u_c_resp</ci>
                        </apply>
                    </apply>
                    <ci>tau_cf</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_RR_p</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_RR_p</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>G_pf</ci>
                            <ci>u_p_resp</ci>
                        </apply>
                    </apply>
                    <ci>tau_pf</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_P_mus_c</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_P_mus_c</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>G_cA</ci>
                            <ci>u_c_resp</ci>
                        </apply>
                    </apply>
                    <ci>tau_cA</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_P_mus_p</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_P_mus_p</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>G_pA</ci>
                            <ci>u_p_resp</ci>
                        </apply>
                    </apply>
                    <ci>tau_pA</ci>
                </apply>
            </apply>
        </math>
        <variable name="Delta_RR_resp_max" public_interface="in" units="per_s"/>
        <variable name="Delta_P_mus_max" public_interface="in" units="J_per_m3"/>
        <variable name="Delta_RR_resp_min" public_interface="in" units="per_s"/>
        <variable name="Delta_P_mus_min" public_interface="in" units="J_per_m3"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Delta_RR_resp</ci>
                <apply>
                    <min/>
                    <apply>
                        <max/>
                        <apply>
                            <plus/>
                            <ci>Delta_RR_c</ci>
                            <ci>Delta_RR_p</ci>
                        </apply>
                        <ci>Delta_RR_resp_min</ci>
                    </apply>
                    <ci>Delta_RR_resp_max</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Delta_P_mus</ci>
                <apply>
                    <min/>
                    <apply>
                        <max/>
                        <apply>
                            <plus/>
                            <ci>Delta_P_mus_c</ci>
                            <ci>Delta_P_mus_p</ci>
                        </apply>
                        <ci>Delta_P_mus_min</ci>
                    </apply>
                    <ci>Delta_P_mus_max</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!-- heart period ///////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
    <!--Ts &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-
 s.2 -->
    <!-- ventricular contractility //////////////////////////////////////////////////////////////////////////////////////////////////-->
    <!-- Emaxlv_symp &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
    <!--s.55-->
    <component name="heart_effector_Gee2023">
        <variable name="sigma_Es" public_interface="out" units="J_per_m6"/>
        <variable name="G_Es" public_interface="in" units="J_per_m6"/>
        <variable name="f_esh" public_interface="in" units="Hz"/>
        <variable name="t" public_interface="in" units="second"/>
        <variable name="f_es_min" public_interface="in" units="Hz"/>
        <!-- unit consistancy for ln-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>sigma_Es</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>G_Es</ci>
                            <apply>
                                <ln/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="second">1</cn>
                                    <apply>
                                        <plus/>
                                        <apply>
                                            <minus/>
                                            <ci>f_esh</ci>
                                            <ci>f_es_min</ci>
                                        </apply>
                                        <cn cellml:units="Hz">1</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <geq/>
                            <ci>f_esh</ci>
                            <ci>f_es_min</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="J_per_m6">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!--s.56-->
        <variable initial_value="0.0" name="Delta_Es" public_interface="out" units="J_per_m6"/>
        <variable name="tau_Es" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_Es</ci>
                </apply>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>tau_Es</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_Es</ci>
                        </apply>
                        <ci>sigma_Es</ci>
                    </apply>
                </apply>
            </apply>
        </math>
        <!-- TODO I think it would be better if we changed the control so that it uses a sigmoid rather than a ln, so
 that the maximum control can be set. G_Es is now the maximum fraction of increase in E_lv that can occur.-->
        <!-- ode(sigma_Es, t)         = (max(f_esh-f_esh_min, 0{per_s})-sigma_Es)/tau_Es;
Delta_Es                 = G_Es*sigma_Es/(f_esh_min+sigma_Es);-->
        <!-- Emaxlv_vag&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
        <!-- s.57-->
        <variable name="sigma_Ev" public_interface="out" units="J_per_m6"/>
        <variable name="G_Ev" public_interface="in" units="Js_per_m6"/>
        <variable name="f_PNDMV_filt" public_interface="in" units="Hz"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>sigma_Ev</ci>
                <apply>
                    <times/>
                    <ci>G_Ev</ci>
                    <ci>f_PNDMV_filt</ci>
                </apply>
            </apply>
        </math>
        <!-- s. 58-->
        <variable initial_value="0.0" name="Delta_Ev" public_interface="out" units="J_per_m6"/>
        <variable name="tau_Ev" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>Delta_Ev</ci>
                </apply>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>tau_Ev</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>Delta_Ev</ci>
                        </apply>
                        <ci>sigma_Ev</ci>
                    </apply>
                </apply>
            </apply>
        </math>
        <variable name="Delta_Emax" public_interface="out" units="J_per_m6"/>
        <variable name="scale" public_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Delta_Emax</ci>
                <apply>
                    <times/>
                    <ci>scale</ci>
                    <apply>
                        <plus/>
                        <ci>Delta_Es</ci>
                        <ci>Delta_Ev</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="heart_effector_Gee2023_INV">
        <variable name="inv_sigma_Es" public_interface="out" units="J_per_m6"/>
        <variable name="inv_G_Es" public_interface="in" units="m6_per_J"/>
        <variable name="f_esh" public_interface="in" units="Hz"/>
        <variable name="t" public_interface="in" units="second"/>
        <variable name="f_es_min" public_interface="in" units="Hz"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>inv_sigma_Es</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <ci>inv_G_Es</ci>
                            </apply>
                            <apply>
                                <ln/>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <minus/>
                                        <ci>f_esh</ci>
                                        <ci>f_es_min</ci>
                                    </apply>
                                    <cn cellml:units="Hz">1</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <geq/>
                            <ci>f_esh</ci>
                            <ci>f_es_min</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!--s.56-->
        <variable initial_value="1e-7" name="inv_Delta_Es" public_interface="out" units="m6_per_J"/>
        <variable name="tau_Es" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>inv_Delta_Es</ci>
                </apply>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>tau_Es</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>inv_Delta_Es</ci>
                        </apply>
                        <ci>inv_sigma_Es</ci>
                    </apply>
                </apply>
            </apply>
        </math>
        <!-- Emaxlv_vag&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
        <!-- s.57-->
        <variable name="inv_sigma_Ev" public_interface="out" units="m6_per_J"/>
        <variable name="inv_G_Ev" public_interface="in" units="m6s_per_J"/>
        <variable name="f_PNDMV_filt" public_interface="in" units="Hz"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>inv_sigma_Ev</ci>
                <apply>
                    <times/>
                    <ci>inv_G_Ev</ci>
                    <ci>f_PNDMV_filt</ci>
                </apply>
            </apply>
        </math>
        <!-- s. 58-->
        <variable initial_value="-1e-7" name="inv_Delta_Ev" public_interface="out" units="m6_per_J"/>
        <variable name="tau_Ev" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>inv_Delta_Ev</ci>
                </apply>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>tau_Ev</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>inv_Delta_Ev</ci>
                        </apply>
                        <ci>inv_sigma_Ev</ci>
                    </apply>
                </apply>
            </apply>
        </math>
        <variable name="Delta_Emax" public_interface="out" units="J_per_m6"/>
        <variable name="scale" public_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Delta_Emax</ci>
                <apply>
                    <times/>
                    <ci>scale</ci>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>inv_Delta_Es</ci>
                        </apply>
                        <apply>
                            <divide/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>inv_Delta_Ev</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!-- Emaxrv_symp &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
</model>
