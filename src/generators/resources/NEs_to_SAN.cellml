<?xml version='1.0' encoding='UTF-8'?>
<model cmeta:id="fabbri_et_al_based_composite_SAN_model" name="modified_SAN_model" xmlns="http://www.cellml.org/cellml/1.1#" xmlns:cellml="http://www.cellml.org/cellml/1.1#" xmlns:cmeta="http://www.cellml.org/metadata/1.0#">
    <!--define units
trying to build a general chain reactions model later, such from ISO-betaAR, ISO-Gs, ISO-AC, ISO-cAMP, ISO-PKA-->
    <units name="per_millivolt">
        <unit exponent="-1.0" prefix="milli" units="volt"/>
    </units>
    <units name="coulomb_per_mole">
        <unit exponent="-1.0" units="mole"/>
        <unit units="coulomb"/>
    </units>
    <units name="microS">
        <unit prefix="micro" units="siemens"/>
    </units>
    <units name="microF">
        <unit prefix="micro" units="farad"/>
    </units>
    <units name="joule_per_kilomole_kelvin">
        <unit units="joule"/>
        <unit exponent="-1.0" units="kelvin"/>
        <unit exponent="-1.0" prefix="kilo" units="mole"/>
    </units>
    <units name="per_second">
        <unit exponent="-1.0" units="second"/>
    </units>
    <units name="millimolar">
        <unit prefix="milli" units="mole"/>
        <unit exponent="-1.0" units="litre"/>
    </units>
    <units name="nmole_per_umeter2">
        <unit prefix="nano" units="mole"/>
        <unit exponent="-2" prefix="micro" units="metre"/>
    </units>
    <units name="nmole">
        <unit prefix="nano" units="mole"/>
    </units>
    <units name="umeter2">
        <unit exponent="2" prefix="micro" units="metre"/>
    </units>
    <units name="nM">
        <unit prefix="nano" units="mole"/>
        <unit exponent="-1.0" units="litre"/>
    </units>
    <units name="uM">
        <unit prefix="micro" units="mole"/>
        <unit exponent="-1.0" units="litre"/>
    </units>
    <units name="nanoA_per_millimolar">
        <unit exponent="-1.0" units="millimolar"/>
        <unit units="nanoA"/>
    </units>
    <units name="mA_nA">
        <unit prefix="milli" units="ampere"/>
        <unit exponent="-1.0" units="nanoA"/>
    </units>
    <units name="per_millivolt_second">
        <unit exponent="-1.0" units="millivolt"/>
        <unit exponent="-1.0" units="second"/>
    </units>
    <units name="millivolt">
        <unit prefix="milli" units="volt"/>
    </units>
    <units name="per_millimolar_second">
        <unit exponent="-1.0" units="millimolar"/>
        <unit exponent="-1.0" units="second"/>
    </units>
    <units name="millisecond">
        <unit prefix="milli" units="second"/>
    </units>
    <units name="litre_millimetre3">
        <unit exponent="-1.0" units="millimetre3"/>
        <unit units="litre"/>
    </units>
    <units name="millimetre3">
        <unit exponent="3.0" prefix="milli" units="metre"/>
    </units>
    <units name="nanoA">
        <unit prefix="nano" units="ampere"/>
    </units>
    <units name="micrometre">
        <unit prefix="micro" units="metre"/>
    </units>
    <units name="millimolar_per_second">
        <unit exponent="-1.0" units="second"/>
        <unit units="millimolar"/>
    </units>
    <units name="per_millimolar">
        <unit exponent="-1.0" units="millimolar"/>
    </units>
    <units name="per_millimolar2_second">
        <unit exponent="-2.0" units="millimolar"/>
        <unit exponent="-1.0" units="second"/>
    </units>
    <units name="micrometre_per_femtometre">
        <unit exponent="-1.0" prefix="femto" units="metre"/>
        <unit units="micrometre"/>
    </units>
    <!--define environment parameters, and dependence relationship-->
    <component name="environment">
        <variable cmeta:id="environment.time" name="time" public_interface="out" units="second"/>
    </component>
    <component name="Brain_stem">
        <!-- See https://brian2.readthedocs.io/en/stable/user/converting_from_integrated_form.html.
try to build a single model to calibrate this parameters that understand this parameter-->
        <variable name="t" public_interface="in" units="millisecond"/>
        <variable initial_value="300" name="t_period" units="millisecond"/>
        <!--notice, this is just a constant variable, not means that after 300ms, the g will disappear-->
        <variable name="t_relative" units="millisecond"/>
        <variable name="t_w_relative" units="millisecond"/>
        <variable initial_value="0" name="g" public_interface="out" units="nanoA"/>
        <!--the synaptic conductance or synaptic input to a neuron-->
        <variable initial_value="10" name="tau" units="millisecond"/>
        <variable name="w" units="nanoA"/>
        <variable initial_value="13" name="w_start" units="millisecond"/>
        <variable initial_value="1" name="w_duration" units="millisecond"/>
        <variable initial_value="3" name="w_period" units="millisecond"/>
        <variable initial_value="10" name="w_n" units="dimensionless"/>
        <variable initial_value="0.1" name="w_value" units="nanoA"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>t_relative</ci>
                <apply>
                    <minus/>
                    <apply>
                        <rem/>
                        <ci>t</ci>
                        <ci>t_period</ci>
                    </apply>
                    <ci>w_start</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>t_w_relative</ci>
                <apply>
                    <rem/>
                    <ci>t_relative</ci>
                    <ci>w_period</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>w</ci>
                <piecewise>
                    <piece>
                        <ci>w_value</ci>
                        <apply>
                            <and/>
                            <apply>
                                <geq/>
                                <ci>t_relative</ci>
                                <cn cellml:units="millisecond">0</cn>
                            </apply>
                            <apply>
                                <lt/>
                                <ci>t_relative</ci>
                                <apply>
                                    <times/>
                                    <ci>w_n</ci>
                                    <ci>w_period</ci>
                                </apply>
                            </apply>
                            <apply>
                                <lt/>
                                <ci>t_w_relative</ci>
                                <ci>w_duration</ci>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="nanoA">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>t</ci>
                    </bvar>
                    <ci>g</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <ci>g</ci>
                        </apply>
                        <ci>w</ci>
                    </apply>
                    <ci>tau</ci>
                </apply>
            </apply>
        </math>
        <!--the formula based on the link content description-->
    </component>
    <component name="Membrane">
        <variable cmeta:id="Membrane.R" initial_value="8314.472" name="R" public_interface="out" units="joule_per_kilomole_kelvin"/>
        <!--universal gas constant-->
        <variable cmeta:id="Membrane.T" initial_value="310" name="T" public_interface="out" units="kelvin"/>
        <!--absolute temperature for 37 centidegree-->
        <variable cmeta:id="Membrane.F" initial_value="96485.3415" name="F" public_interface="out" units="coulomb_per_mole"/>
        <!--Faraday constant-->
        <variable cmeta:id="Membrane.C" initial_value="5.7e-5" name="C" units="microF"/>
        <!--cell capacitance-->
        <variable cmeta:id="Membrane.RTONF" name="RTONF" public_interface="out" units="millivolt"/>
        <!--R*T/F-->
        <variable cmeta:id="Membrane.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <!--just time-->
        <variable cmeta:id="Membrane.i_f" name="i_f" public_interface="in" units="nanoA"/>
        <!--declare funny current-->
        <variable cmeta:id="Membrane.i_NaK" name="i_NaK" public_interface="in" units="nanoA"/>
        <!--declare Na-K ion exchange current-->
        <variable cmeta:id="Membrane.i_NaCa" name="i_NaCa" public_interface="in" units="nanoA"/>
        <!--declare Na-Ca ion exchange current-->
        <variable cmeta:id="Membrane.i_Na" name="i_Na" public_interface="in" units="nanoA"/>
        <!--declare Na ion channel current-->
        <variable cmeta:id="Membrane.i_Kr" name="i_Kr" public_interface="in" units="nanoA"/>
        <!--declare Kr (rapid) current-->
        <variable cmeta:id="Membrane.i_Ks" name="i_Ks" public_interface="in" units="nanoA"/>
        <!--declare Ks (slow) current-->
        <variable cmeta:id="Membrane.i_to" name="i_to" public_interface="in" units="nanoA"/>
        <!--declare to (transient) current-->
        <variable cmeta:id="Membrane.i_CaL" name="i_CaL" public_interface="in" units="nanoA"/>
        <!--declare L type Ca ion channel current-->
        <variable cmeta:id="Membrane.i_CaT" name="i_CaT" public_interface="in" units="nanoA"/>
        <!--declare T type Ca ion channel current-->
        <variable cmeta:id="Membrane.i_KACh" name="i_KACh" public_interface="in" units="nanoA"/>
        <!--declare ACh activate K current-->
        <variable cmeta:id="Membrane.i_Kur" name="i_Kur" public_interface="in" units="nanoA"/>
        <!--declare recitifier current -->
        <variable cmeta:id="Membrane.V" name="V" public_interface="out" units="millivolt"/>
        <!--declare action potential variable-->
        <variable cmeta:id="Membrane.clamp_mode" initial_value="0" name="clamp_mode" units="dimensionless"/>
        <!--declare clamp mode-->
        <variable cmeta:id="Membrane.V_clamp" name="V_clamp" private_interface="in" units="millivolt"/>
        <!--declare clamp's voltage variable-->
        <variable cmeta:id="Membrane.V_ode" initial_value="-47.787168" name="V_ode" units="millivolt"/>
        <!--declare and initilize the V_ode variable-->
        <variable cmeta:id="Membrane.i_tot" name="i_tot" units="nanoA"/>
        <!--declare a total current variable-->
        <variable name="g" public_interface="in" units="nanoA"/>
        <!--declare a variable that effect of incoming spikes from synapses on the neuron's membrane potential-->
        <!--i_tot = i_f+i_Kr+i_Ks+i_to+i_NaK+i_NaCa+i_Na+i_CaL+i_CaT+i_KACh+i_Kur-g;-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_tot</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>i_f</ci>
                        <cn cellml:units="dimensionless">1.0</cn>
                    </apply>
                    <ci>i_Kr</ci>
                    <apply>
                        <times/>
                        <ci>i_CaL</ci>
                        <cn cellml:units="dimensionless">1.0</cn>
                    </apply>
                    <ci>i_CaT</ci>
                    <apply>
                        <times/>
                        <cn cellml:units="dimensionless">1.0</cn>
                        <ci>i_NaCa</ci>
                    </apply>
                    <ci>i_NaK</ci>
                    <ci>i_Ks</ci>
                    <ci>i_Na</ci>
                    <ci>i_to</ci>
                    <ci>i_Kur</ci>
                </apply>
            </apply>
            <!--i_tot = i_f+i_NaCa+i_CaL+i_CaT+i_Kr+i_Ks;
classic formula-->
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>V_ode</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>i_tot</ci>
                    </apply>
                    <ci>C</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>RTONF</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>R</ci>
                        <ci>T</ci>
                    </apply>
                    <ci>F</ci>
                </apply>
            </apply>
            <!--because preset 0, so never let V=V_clamp-->
            <apply>
                <eq/>
                <ci>V</ci>
                <piecewise>
                    <piece>
                        <ci>V_clamp</ci>
                        <apply>
                            <geq/>
                            <ci>clamp_mode</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V_ode</ci>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!--if preset 1, never use differential formula to calculate the action potential-->
    </component>
    <component name="Voltage_clamp">
        <!--I speculated that this function used to test before modify model-->
        <variable cmeta:id="Voltage_clamp.t_holding" initial_value="0.5" name="t_holding" units="second"/>
        <variable cmeta:id="Voltage_clamp.t_test" initial_value="0.5" name="t_test" units="second"/>
        <!--preset test time period, initial value is 0.5s-->
        <variable cmeta:id="Voltage_clamp.V_clamp" name="V_clamp" public_interface="out" units="millivolt"/>
        <variable cmeta:id="Voltage_clamp.V_test" initial_value="-35" name="V_test" units="millivolt"/>
        <!--only during test time, the action potential set to this value-->
        <variable cmeta:id="Voltage_clamp.V_holding" initial_value="-45" name="V_holding" units="millivolt"/>
        <!--other time, the action potential recovery to this value-->
        <variable cmeta:id="Voltage_clamp.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>V_clamp</ci>
                <piecewise>
                    <piece>
                        <ci>V_test</ci>
                        <apply>
                            <and/>
                            <apply>
                                <gt/>
                                <ci>time</ci>
                                <ci>t_holding</ci>
                            </apply>
                            <apply>
                                <lt/>
                                <ci>time</ci>
                                <apply>
                                    <plus/>
                                    <ci>t_holding</ci>
                                    <ci>t_test</ci>
                                </apply>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V_holding</ci>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
        <!--Used to test changes in related currents observed for a specific action potential that given a specific time period-->
    </component>
    <component name="Rate_modulation_experiments">
        <!--ACh (PNS release) related to some specific ion channels, so isolate it-->
        <!--var{Rate_modulation_experiments.ACh} ACh: millimolar {init: 0, pub: out};-->
        <variable cmeta:id="Rate_modulation_experiments.ACh" initial_value="0" name="ACh" public_interface="out" units="nM"/>
        <!--maybe we can add other parameters related ACh control-->
        <!--ISO (SNS release) also related to some specific ion channels,
in fact, the unit should be the same as ACh is millmolar/mM, but I don't know how to transform Iso_shift, so in here just set dimensionless
M: mol/m2, beta-AR:Hill equation nM, concentration*Area = mol, AC: k1*beta-AR, mol, cAMP: close ka*AC mol/m2.-->
        <variable cmeta:id="Rate_modulation_experiments.Iso_1_nM" name="Iso_1_nM" public_interface="out" units="dimensionless"/>
        <!--add new isoproterenol definition with unit, nanomole per liter, 1.0e-9 mole = 1 nanomole
in adult ventricular myocytes(pig) the basal cAMP concentration detected by the probe is 1.2uM in ventricular cell, based on <Cytoplasmic cAMP concentrations in intact cardiac myocytes>-->
        <variable cmeta:id="Rate_modulation_experiments.ISO" initial_value="0.000000" name="ISO" public_interface="out" units="nM"/>
        <!--add some variable parameters that build equation about Iso_1_nM and cAMP_nif
cAMP_max is the maximal response magnitude
2 set parameters [ccAMP_max,EC_halfmax,n_iter] =[13.5,0.031,1],[ccAMP_max,EC_halfmax,n_iter] = [13.1,0.0088,1], come from figure4 of <>
one set parameters [ccAMP_max,EC_halfmax,n_iter] = [2.1,0.007,1.4], from figure2 of <Compartmentation of cAMP Signaling in Cardiac Myocytes: A Computational Study>
calibrated by the experimental data, the maximum cAMP closely to 2.5uM=2500nM
var{Rate_modulation_experiments.cAMP_max} cAMP_max: nM {init: 4100, pub: out};-->
        <!-- the max_cAMP=13.1uM, based on these papers:<Compartmentation of cAMP signaling in cardiac myocytes: a computational study>-->
        <variable cmeta:id="Rate_modulation_experiments.AC2cAMP_conversion" initial_value="2.7" name="AC2cAMP_conversion" units="uM"/>
        <!-- the maximum activity of beta1-AR and beta2-AR are all 100%, but in here, we suppose the unit is mol/m2
 we still didn't have other data to calibrate the b1-AR and b2-AR activation value, so just suppose 1 micrometer square, and bind with nano mol unit beta-AR-->
        <variable cmeta:id="Rate_modulation_experiments.Area_betaAR" initial_value="1.00" name="Area_betaAR" units="umeter2"/>
        <!-- based on this paper preset the AC max_enhance: <Cardiac Adenylate Cyclase Activity in Relation to Beta-Adrenergic Responses>-->
        <!-- based on these papers:<Iancu RV, Jones SW, Harvey RD. Compartmentation of cAMP signaling in cardiac myocytes: a computational study. Biophys J. 2007 May 1;92(9):3317-31. doi: 10.1529/biophysj.106.095356. Epub 2007 Feb 9. Erratum in: Biophys J. 2008 Jan 15;94(2):714. PMID: 17293406; PMCID: PMC1852367.>,<>,<>-->
        <variable cmeta:id="Rate_modulation_experiments.ISO_max" initial_value="10000" name="ISO_max" units="nM"/>
        <!--based on this paper<Agonist-induced b2-adrenoceptor desensitization and downregulation enhance pro-inflammatory cytokine release in human bronchial epithelial cells>-->
        <variable cmeta:id="Rate_modulation_experiments.ISO_high" initial_value="3000" name="ISO_high" units="nM"/>
        <!-- based on this paper<FUNCTIONAL CHARACTERIZATION OF B-ADRENOCEPTOR SUBTYPES IN RABBIT RIGHT ATRIA>, the Ki value is 22nM and 13000nM for beta1 and beta2 respectively, for rabbits
 based on this paper: <PHARMACOLOGICAL CHARACTERIZATION OF THE POST JUNCTIONAL 13-ADRENOCEPTORS IN THE RAT GASTRIC FUNDUS>, the EC_50 value is 12nM, for rats-->
        <!--from above paper, also get the Intrinsic activity, maximum effect of agonists compared with maximum effect of isoproterenol is 1.0
EC_50 for human beta2-AR and ISO similar tb3c,EC50=10^(-7.57)=26.9nM: <A Full Pharmacological Analysis of the Three Turkey bAdrenoceptors and Comparison with the Human bAdrenoceptors>
 get for human, beta1-AR active AC by ISO EC50=31.7,paper<https://jpet.aspetjournals.org/content/294/3/923.long>, -->
        <variable cmeta:id="Rate_modulation_experiments.EC50_beta1" initial_value="111.7" name="EC50_beta1" units="nM"/>
        <variable cmeta:id="Rate_modulation_experiments.EC50_beta2" initial_value="116.9" name="EC50_beta2" units="nM"/>
        <variable cmeta:id="Rate_modulation_experiments.IC50_beta2" initial_value="4000" name="IC50_beta2" units="nM"/>
        <!--ISO induced a sharp significant increase in IL-6 production,EC50=2uM,and influenced by 70% decrease in beta2-AR induced cAMP formation:<Agonist-induced b2-adrenoceptor desensitization and downregulation enhance pro-inflammatory cytokine release in human bronchial epithelial cells》-->
        <!--var{Rate_modulation_experiments.EC50_b2i} EC50_b2i: nM {init: 5000, pub: out};-->
        <!--beta1-AR spared 75%-80%, beta2-AR spread 20%-25%, the ratio from this paper: <Regulation of β-Adrenergic Receptors in the Heart: A Review on Emerging Therapeutic Strategies for Heart Failure>-->
        <variable cmeta:id="Rate_modulation_experiments.k_beta1" initial_value="0.76" name="k_beta1" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.K_beta2" initial_value="0.22" name="K_beta2" units="dimensionless"/>
        <!-- use beta-AR:AC = 2.1:6 to fit the spread beta-AR activation ratio to AC, paper:<Quantification of signalling components and amplification in the beta-adrenergic-receptor-adenylate cyclase pathway in isolated adult rat ventricular myocytes>
 such E_maxb1=2 represent that every 1 beta1-AR could activate 2 AC enzyme-->
        <variable cmeta:id="Rate_modulation_experiments.AC_maxstimulated" initial_value="5" name="AC_maxstimulated" units="dimensionless"/>
        <!--success rate of beta-AR coupled Gs protein, based on this paper,conduct success ratio from 0.72-0.99: <Cardiac Adenylate Cyclase Activity in Relation to Beta-Adrenergic Responses>-->
        <variable cmeta:id="Rate_modulation_experiments.k_b1coupleGs" initial_value="0.72" name="k_b1coupleGs" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.k_b2coupleGs" initial_value="0.99" name="k_b2coupleGs" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.k_b2coupleGi" initial_value="0.99" name="k_b2coupleGi" units="dimensionless"/>
        <!--at first, hypothesis the total beta-AR is 100%[beta1+beta2+beta3+beta4(maybe?)=100%], the exactly value will set in the future-->
        <variable cmeta:id="Rate_modulation_experiments.beta_ntotal" initial_value="1.00" name="beta_ntotal" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.beta1_max" name="beta1_max" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.beta2_max" name="beta2_max" units="dimensionless"/>
        <!--so, we calibrate this parameter by reference ISO-cAMP curve, based on this paper fig.4B:<Cytoplasmic cAMP concentrations in intact cardiac myocytes>-->
        <!-- based on this paper: <beta1-Adrenergic and beta2-Adrenergic Receptor-Mediated Adenylate Cyclase Stimulation in Nonfailing and Failing Human Ventricular Myocardium>
 calibrated by myself
 not found any reference parameter, just know close to linear relationship-->
        <!--based on this paper <Kinetic analysis of endogenous β2-adrenoceptor-mediated  cAMP GloSensorTM responses in HEK293 cells> figure 3 and fig.6 and table1, while concentration close to 0.01uM, increased very quickly, over it will increased very slowly
EC_halfmax = 10^(-2.01)=0.00977,n_iter is Hill coefficient that range from [1,2]
EC_halfmax is the half-maximal response concentration
for beta1-AR, EC_halfmax range is [1,10]nM, for beta2-AR, EC_halfmax range is [10,50]nM
for ISO to beta-AR, EC_half = 10^-8.11 =7.76nM, refered <A Full Pharmacological Analysis of the Three Turkey bAdrenoceptors and Comparison with the Human bAdrenoceptors>-->
        <variable cmeta:id="Rate_modulation_experiments.n_iter" initial_value="1.0" name="n_iter" public_interface="out" units="dimensionless"/>
        <!--in fact, the cAMP concentration depends on AC(Adenylyl cyclase), that activated by beta-AR
ISO(or other drugs) -> beta-AR -> AC -> cAMP(transformed by ATP)
the unit usually is nM or uM, 1uM = 1000nM-->
        <variable cmeta:id="Rate_modulation_experiments.cAMP_nif" name="cAMP_nif" public_interface="out" units="uM"/>
        <variable cmeta:id="Rate_modulation_experiments.T_cAMPPKA" initial_value="25.87" name="T_cAMPPKA" units="nM"/>
        <variable cmeta:id="Rate_modulation_experiments.T_PKAPbeta2" initial_value="0.7" name="T_PKAPbeta2" units="dimensionless"/>
        <!--need identified-->
        <!--add new definition about beta-AR with units, they are receptors-->
        <variable cmeta:id="Rate_modulation_experiments.beta1_actived" name="beta1_actived" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.beta2_actived" name="beta2_actived" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.beta2_inhibited" name="beta2_inhibited" units="nmole"/>
        <!--we suppose beta-AR activate AC is linear relationship, paper:<Cardiac Adenylate Cyclase Activity in Relation to Beta-Adrenergic Responses>-->
        <variable cmeta:id="Rate_modulation_experiments.Gs_beta1" name="Gs_beta1" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.Gs_beta2" name="Gs_beta2" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.Gi_beta2" name="Gi_beta2" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.cAMP" name="cAMP" public_interface="out" units="uM"/>
        <!--based on the cascade mechanism, phosphodiesterase(PDE) will breaks phosphodiester bonds of cAMP-->
        <variable cmeta:id="Rate_modulation_experiments.PDE_cAMP" initial_value="0" name="PDE_cAMP" units="uM"/>
        <!--add Protein Kinase A(PKA) concentration formula-->
        <variable cmeta:id="Rate_modulation_experiments.PKA" name="PKA" public_interface="out" units="dimensionless"/>
        <!--only M2R in heart, ref:<The detection of the non-M2 muscarinic receptor subtype in the rat heart atria and ventricles>-->
        <variable cmeta:id="Rate_modulation_experiments.M2_max" initial_value="1.00" name="M2_max" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.M2R" name="M2R" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.Area_M2R" initial_value="1.00" name="Area_M2R" units="umeter2"/>
        <variable cmeta:id="Rate_modulation_experiments.IC50_M2" initial_value="9.8" name="IC50_M2" units="nM"/>
        <variable cmeta:id="Rate_modulation_experiments.Gi_M2" name="Gi_M2" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.k_M2bindGi" initial_value="0.99" name="k_M2bindGi" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.GS_total" name="GS_total" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.Gi_total" name="Gi_total" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.EC50_Gs" initial_value="0.12" name="EC50_Gs" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.k_Gi" initial_value="0.01" name="k_Gi" units="dimensionless"/>
        <variable cmeta:id="Rate_modulation_experiments.AC_actived" name="AC_actived" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.cAMP_basal" name="cAMP_basal" units="uM"/>
        <variable cmeta:id="Rate_modulation_experiments.AC_basal" name="AC_basal" units="nmole"/>
        <variable cmeta:id="Rate_modulation_experiments.ACCa_max" initial_value="1.00" name="ACCa_max" units="dimensionless"/>
        <!--just set default value is 1, at this stage we cannot measure exact density value in SANC membrane-->
        <variable cmeta:id="Rate_modulation_experiments.Area_Ca" initial_value="1.00" name="Area_Ca" units="umeter2"/>
        <variable cmeta:id="Rate_modulation_experiments.EC50_Ca" initial_value="8" name="EC50_Ca" units="nM"/>
        <!--this should be Ca ion concentration in SAN cell of resting state,-->
        <variable cmeta:id="Rate_modulation_experiments.CaMKII" initial_value="6.4" name="CaMKII" public_interface="out" units="millimolar"/>
        <!--//*****************simplified equations about Ca to cAMP basal********************////-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>AC_basal</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>ACCa_max</ci>
                        <ci>Area_Ca</ci>
                        <apply>
                            <power/>
                            <ci>CaMKII</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>EC50_Ca</ci>
                            <ci>n_iter</ci>
                        </apply>
                        <apply>
                            <power/>
                            <ci>CaMKII</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>cAMP_basal</ci>
                <apply>
                    <times/>
                    <ci>AC2cAMP_conversion</ci>
                    <ci>AC_basal</ci>
                </apply>
            </apply>
            <!--//*****************simplified equations about ACh to Gi********************////-->
            <apply>
                <eq/>
                <ci>M2R</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>M2_max</ci>
                        <ci>Area_M2R</ci>
                        <apply>
                            <power/>
                            <ci>ACh</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>IC50_M2</ci>
                            <ci>n_iter</ci>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ACh</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Gi_M2</ci>
                <apply>
                    <times/>
                    <ci>M2R</ci>
                    <ci>k_M2bindGi</ci>
                </apply>
            </apply>
            <!--cAMP = AC2cAMP_conversion*AC_actived;-->
            <!--//*****************simplified equations about ISO to Gs/Gi********************////
1st step, calculate the maximum beta1-AR proportion/number in total beta-AR of SAN cell-->
            <apply>
                <eq/>
                <ci>beta1_max</ci>
                <apply>
                    <times/>
                    <ci>beta_ntotal</ci>
                    <ci>k_beta1</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta2_max</ci>
                <apply>
                    <times/>
                    <ci>beta_ntotal</ci>
                    <ci>K_beta2</ci>
                </apply>
            </apply>
            <!--from ISO to beta-AR relationship, reference HILL equation as previous paper:<PHARMACOLOGICAL CHARACTERIZATION OF THE POST JUNCTIONAL 13-ADRENOCEPTORS IN THE RAT GASTRIC FUNDUS>-->
            <apply>
                <eq/>
                <ci>beta1_actived</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>beta1_max</ci>
                        <ci>Area_betaAR</ci>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>EC50_beta1</ci>
                            <ci>n_iter</ci>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--for beta2-AR coupled with Gi,based on this paper: <Aryloxypropanolamine and Catecholamine Ligand Interactions with the β1-Adrenergic Receptor: Evidence for Interaction with Distinct Conformations of β1-Adrenergic Receptors>-->
            <apply>
                <eq/>
                <ci>beta2_actived</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>beta2_max</ci>
                        <ci>Area_betaAR</ci>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>EC50_beta2</ci>
                            <ci>n_iter</ci>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta2_inhibited</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>beta2_max</ci>
                        <ci>Area_betaAR</ci>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <ci>IC50_beta2</ci>
                            <ci>n_iter</ci>
                        </apply>
                        <apply>
                            <power/>
                            <ci>ISO</ci>
                            <ci>n_iter</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Gs_beta1</ci>
                <apply>
                    <times/>
                    <ci>beta1_actived</ci>
                    <ci>k_b1coupleGs</ci>
                </apply>
            </apply>
            <!--Gs_beta2 = beta2_actived*k_b2coupleGs;-->
            <apply>
                <eq/>
                <ci>Gi_beta2</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="nmole">0</cn>
                        <apply>
                            <lt/>
                            <ci>PKA</ci>
                            <ci>T_PKAPbeta2</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <times/>
                            <ci>beta2_inhibited</ci>
                            <ci>k_b2coupleGi</ci>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <!--total number of beta2-AR is limited, so, some beta2-AR phosphorylated, less Gs protein actived-->
            <apply>
                <eq/>
                <ci>Gs_beta2</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>beta2_actived</ci>
                            <ci>k_b2coupleGs</ci>
                        </apply>
                        <apply>
                            <lt/>
                            <ci>PKA</ci>
                            <ci>T_PKAPbeta2</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <minus/>
                            <apply>
                                <times/>
                                <ci>beta2_actived</ci>
                                <ci>k_b2coupleGs</ci>
                            </apply>
                            <apply>
                                <times/>
                                <ci>beta2_inhibited</ci>
                                <ci>k_b2coupleGi</ci>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <!--//*****************simplified equations about Gs/Gi to AC********************////-->
            <apply>
                <eq/>
                <ci>GS_total</ci>
                <apply>
                    <plus/>
                    <ci>Gs_beta1</ci>
                    <ci>Gs_beta2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Gi_total</ci>
                <apply>
                    <plus/>
                    <ci>Gi_beta2</ci>
                    <ci>Gi_M2</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>AC_actived</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>AC_maxstimulated</ci>
                        <ci>GS_total</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>EC50_Gs</ci>
                        <ci>GS_total</ci>
                        <apply>
                            <times/>
                            <ci>k_Gi</ci>
                            <ci>Gi_total</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--//*****************simplified equations about AC to cAMP********************////
cAMP = cAMP_tmax*pow(AC_final, n_iter)/(pow(EC50_AC, n_iter)+pow(AC_final, n_iter));-->
            <apply>
                <eq/>
                <ci>cAMP</ci>
                <apply>
                    <times/>
                    <ci>AC2cAMP_conversion</ci>
                    <ci>AC_actived</ci>
                </apply>
            </apply>
            <!--this is the hypothesis equation about Iso_concentrations control cAMP concentrations
the equation based on 2 papers: <Kinetic analysis of endogenous β2-adrenoceptor-mediated  cAMP GloSensorTM responses in HEK293 cells>,<Isoprenaline: A Potential Contributor in Sick Sinus Syndrome—Insights from a Mathematical Model of the Rabbit Sinoatrial Node>
cAMP_nif = cAMP_max*pow(Iso_1_nM, n_iter)/(pow(EC_halfmax, n_iter)+pow(Iso_1_nM, n_iter));-->
            <!--2 different cascade control mechanism about ISO to cAMP
cAMP_nif = cAMP_max*pow(AC_total, n_iter)/(pow(K_dA, n_iter)+pow(AC_total, n_iter));-->
            <apply>
                <eq/>
                <ci>cAMP_nif</ci>
                <apply>
                    <minus/>
                    <apply>
                        <plus/>
                        <ci>cAMP</ci>
                        <ci>cAMP_basal</ci>
                    </apply>
                    <ci>PDE_cAMP</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Iso_1_nM</ci>
                <ci>ISO</ci>
            </apply>
            <!--//*****************simplified equation parameters about cAMP to PKA********************////
therefore, the PKA range is [0.0296->0.808->0.9922] while cAMP from 0 to infinity-->
            <apply>
                <eq/>
                <ci>PKA</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="dimensionless">0.9483</cn>
                                </apply>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">1</cn>
                                        </apply>
                                        <ci>cAMP_nif</ci>
                                        <cn cellml:units="dimensionless">0.0656</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">0.9778</cn>
                        </apply>
                        <apply>
                            <lt/>
                            <ci>cAMP_nif</ci>
                            <ci>T_cAMPPKA</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="dimensionless">0.4526</cn>
                                </apply>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">1</cn>
                                        </apply>
                                        <ci>cAMP_nif</ci>
                                        <cn cellml:units="dimensionless">0.0340</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">0.9922</cn>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
    </component>
    <component name="Ionic_values">
        <!--declare and define some fixed ion variable value, such as concentrations -->
        <variable cmeta:id="Ionic_values.Nai" name="Nai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ionic_values.Nao" initial_value="140" name="Nao" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ionic_values.Ki" initial_value="140" name="Ki" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ionic_values.Ko" initial_value="5.4" name="Ko" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ionic_values.Ca_sub" name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ionic_values.Cao" initial_value="1.8" name="Cao" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ionic_values.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <variable cmeta:id="Ionic_values.E_Na" name="E_Na" public_interface="out" units="millivolt"/>
        <variable cmeta:id="Ionic_values.E_K" name="E_K" public_interface="out" units="millivolt"/>
        <variable cmeta:id="Ionic_values.E_Ca" name="E_Ca" public_interface="out" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>E_Na</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <ci>Nao</ci>
                            <ci>Nai</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>E_K</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <ci>Ko</ci>
                            <ci>Ki</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>E_Ca</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.5</cn>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <ci>Cao</ci>
                            <ci>Ca_sub</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="Nai_concentration">
        <!--not mention on the paper, but looks like just package all Na input related variables-->
        <variable cmeta:id="Nai_concentration.Nai" name="Nai" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Nai_concentration.time" name="time" public_interface="in" units="second"/>
        <!--those common variable use the membrane shared-->
        <variable cmeta:id="Nai_concentration.F" name="F" public_interface="in" units="coulomb_per_mole"/>
        <variable cmeta:id="Nai_concentration.V_sub" name="V_sub" public_interface="in" units="millimetre3"/>
        <variable cmeta:id="Nai_concentration.V_i" name="V_i" public_interface="in" units="millimetre3"/>
        <variable cmeta:id="Nai_concentration.i_Na" name="i_Na" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Nai_concentration.i_NaCa" name="i_NaCa" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Nai_concentration.i_NaK" name="i_NaK" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Nai_concentration.i_fNa" name="i_fNa" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Nai_concentration.i_siNa" name="i_siNa" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Nai_concentration.Nai_" initial_value="5" name="Nai_" units="millimolar"/>
        <variable cmeta:id="Nai_concentration.Nai_clamp" initial_value="1" name="Nai_clamp" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>Nai_</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>Nai_clamp</ci>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="mA_nA">1</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <ci>i_Na</ci>
                            <ci>i_fNa</ci>
                            <ci>i_siNa</ci>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">3</cn>
                                <ci>i_NaK</ci>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">3</cn>
                                <ci>i_NaCa</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <cn cellml:units="litre_millimetre3">1</cn>
                        <apply>
                            <plus/>
                            <ci>V_i</ci>
                            <ci>V_sub</ci>
                        </apply>
                        <ci>F</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Nai</ci>
                <ci>Nai_</ci>
            </apply>
        </math>
        <!--so, Na input variable is not a constant value, it will be change by dependences-->
    </component>
    <!--funny current ion channel, in human just have little influence, activated when hyperpolarization,
usually related Na and K ion
hyperpolarization-activated cyclic nucleotide-gated (HCN) current
regulating the heart's rhythm and neuronal excitability
located in cardiac cells,neuronal cells,smooth muscle cells, endocrine cells-->
    <component name="i_f">
        <variable cmeta:id="i_f.ACh" name="ACh" private_interface="out" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_f.Iso_1_nM" name="Iso_1_nM" private_interface="out" public_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_f.i_f" name="i_f" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_f.i_fNa" name="i_fNa" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_f.E_Na" name="E_Na" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_f.E_K" name="E_K" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_f.i_fK" name="i_fK" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_f.g_f" initial_value="0.00427" name="g_f" units="microS"/>
        <variable cmeta:id="i_f.G_f" name="G_f" units="microS"/>
        <variable cmeta:id="i_f.g_f_Na" name="g_f_Na" public_interface="out" units="microS"/>
        <variable cmeta:id="i_f.G_f_Na" name="G_f_Na" units="microS"/>
        <variable cmeta:id="i_f.g_f_K" name="g_f_K" public_interface="out" units="microS"/>
        <variable cmeta:id="i_f.G_f_K" name="G_f_K" units="microS"/>
        <variable cmeta:id="i_f.Km_f" initial_value="45" name="Km_f" units="millimolar"/>
        <variable cmeta:id="i_f.alpha" initial_value="0.5927" name="alpha" units="dimensionless"/>
        <variable cmeta:id="i_f.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_f.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_f.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_f.Ko" name="Ko" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_f.y" name="y" private_interface="in" units="dimensionless"/>
        <!--in here, add a new variable parameter-->
        <variable cmeta:id="i_f.cAMP_nif" name="cAMP_nif" private_interface="out" public_interface="in" units="nM"/>
        <!--add a blockade variable that could control in the experiments-->
        <variable cmeta:id="i_f.blockade" initial_value="0" name="blockade" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>G_f</ci>
                <apply>
                    <divide/>
                    <ci>g_f</ci>
                    <apply>
                        <divide/>
                        <ci>Ko</ci>
                        <apply>
                            <plus/>
                            <ci>Ko</ci>
                            <ci>Km_f</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>G_f_K</ci>
                <apply>
                    <divide/>
                    <ci>G_f</ci>
                    <apply>
                        <plus/>
                        <ci>alpha</ci>
                        <cn cellml:units="dimensionless">1</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>G_f_Na</ci>
                <apply>
                    <times/>
                    <ci>alpha</ci>
                    <ci>G_f_K</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>g_f_Na</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>G_f_Na</ci>
                        <ci>Ko</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>Ko</ci>
                        <ci>Km_f</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>g_f_K</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <ci>G_f_K</ci>
                        <ci>Ko</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>Ko</ci>
                        <ci>Km_f</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_fNa</ci>
                <apply>
                    <times/>
                    <ci>y</ci>
                    <ci>g_f_Na</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_Na</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>blockade</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_fK</ci>
                <apply>
                    <times/>
                    <ci>y</ci>
                    <ci>g_f_K</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>blockade</ci>
                    </apply>
                </apply>
            </apply>
            <!--according to the definition, I_f peak position should around action potential hyperpolarization position, but in the simulation result, not match!!!
it dependence on the coefficient 'tau_y'-->
            <apply>
                <eq/>
                <ci>i_f</ci>
                <apply>
                    <plus/>
                    <ci>i_fNa</ci>
                    <ci>i_fK</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_f_y_gate">
        <variable cmeta:id="i_f_y_gate.y" initial_value="0.009508" name="y" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_f_y_gate.tau_y" name="tau_y" units="second"/>
        <variable cmeta:id="i_f_y_gate.y_infinity" name="y_infinity" units="dimensionless"/>
        <variable cmeta:id="i_f_y_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_f_y_gate.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_f_y_gate.ACh_shift" name="ACh_shift" units="millivolt"/>
        <variable cmeta:id="i_f_y_gate.ACh" name="ACh" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_f_y_gate.Iso_1_nM" name="Iso_1_nM" public_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_f_y_gate.Iso_shift" name="Iso_shift" units="millivolt"/>
        <variable cmeta:id="i_f_y_gate.K_If" initial_value="24.4" name="K_If" units="millivolt"/>
        <variable cmeta:id="i_f_y_gate.K05_If" initial_value="17.33" name="K05_If" units="nM"/>
        <!--those 2 parameters add for new Iso_shift equation, cAMP_nif is cAMP's concentration(activated by AC, transformed by ATP, and b-AR activate AC)-->
        <variable cmeta:id="i_f_y_gate.Iso_shift2" name="Iso_shift2" units="millivolt"/>
        <variable cmeta:id="i_f_y_gate.cAMP_nif" name="cAMP_nif" public_interface="in" units="nM"/>
        <!--this variable parameter preset value just temporary, and I think use this value will make the result more closely-->
        <variable cmeta:id="i_f_y_gate.cAMP_iter" initial_value="1" name="cAMP_iter" units="dimensionless"/>
        <!--I don't know why consider y_shift-->
        <variable cmeta:id="i_f_y_gate.y_shift" initial_value="0" name="y_shift" units="millivolt"/>
        <!--the EC50=1.26E-8M(close), max=-7.2,nf=0.69(close) in rabbit SAN cell, based on<Analysis of the Chronotropic Effect of Acetylcholine on Sinoatrial Node Cells>-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>ACh_shift</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">1</cn>
                            </apply>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="millivolt">9.898</cn>
                                    <apply>
                                        <power/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millimolar">1</cn>
                                            <ci>ACh</ci>
                                        </apply>
                                        <cn cellml:units="dimensionless">0.618</cn>
                                    </apply>
                                </apply>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <power/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millimolar">1</cn>
                                            <ci>ACh</ci>
                                        </apply>
                                        <cn cellml:units="dimensionless">0.618</cn>
                                    </apply>
                                    <cn cellml:units="dimensionless">0.00122423</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ACh</ci>
                            <cn cellml:units="millimolar">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="millivolt">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--Iso_shift = sel
    case Iso_1_nM > 0{dimensionless}:
        7.5{millivolt};
    otherwise:
        0{millivolt};
endsel;-->
            <!--based on Linder's paper<Sympathetic Stimulation Can Compensate for  Hypocalcaemia-Induced Bradycardia in Human and  Rabbit Sinoatrial Node Cells> table1, but not build relationship yet
n=7 (based on <Real-time relationship between PKA biochemical signal network dynamics and increased action potential firing rate in heart pacemaker cells> p6 that AP firing rate in response to ISO)
according to Fabbri model, Iso_shift_max = 7.5mV, but not find the calculation formula, so just multiple a coefficient 1.33, <An updated computational model of rabbit sinoatrial action potential to investigate the mechanisms of heart rate modulation>
need check later!!! the range is [-24.4,7.5],the original should multiple with 1.0e-6-->
            <apply>
                <eq/>
                <ci>Iso_shift2</ci>
                <apply>
                    <times/>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <ci>K_If</ci>
                                <apply>
                                    <power/>
                                    <ci>cAMP_nif</ci>
                                    <ci>cAMP_iter</ci>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">1.0</cn>
                                    <apply>
                                        <power/>
                                        <ci>K05_If</ci>
                                        <ci>cAMP_iter</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <power/>
                                    <ci>cAMP_nif</ci>
                                    <ci>cAMP_iter</ci>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="millivolt">18.76</cn>
                    </apply>
                    <cn cellml:units="dimensionless">1.33</cn>
                </apply>
            </apply>
            <!--Iso_shift = Iso_shift2;-->
            <apply>
                <eq/>
                <ci>Iso_shift</ci>
                <piecewise>
                    <piece>
                        <ci>Iso_shift2</ci>
                        <apply>
                            <gt/>
                            <ci>Iso_shift2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="millivolt">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--not totally match with the paper, add ACh and ISO influence factors
from mathematic aspect, could explain that this coefficient could delay the I_f activate time-->
            <apply>
                <eq/>
                <ci>tau_y</ci>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <plus/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_millivolt_second">0.36</cn>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">148.8</cn>
                                            </apply>
                                            <ci>ACh_shift</ci>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millivolt">0.066</cn>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <apply>
                                                        <plus/>
                                                        <ci>V</ci>
                                                        <cn cellml:units="millivolt">148.8</cn>
                                                    </apply>
                                                    <ci>ACh_shift</ci>
                                                </apply>
                                                <ci>Iso_shift</ci>
                                            </apply>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="dimensionless">1</cn>
                                </apply>
                            </apply>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_millivolt_second">0.1</cn>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">87.3</cn>
                                            </apply>
                                            <ci>ACh_shift</ci>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="per_millivolt">0.2</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <apply>
                                                        <plus/>
                                                        <ci>V</ci>
                                                        <cn cellml:units="millivolt">87.3</cn>
                                                    </apply>
                                                    <ci>ACh_shift</ci>
                                                </apply>
                                                <ci>Iso_shift</ci>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="second">0.054</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>y_infinity</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">0.01329</cn>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">0.99921</cn>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <apply>
                                                        <minus/>
                                                        <apply>
                                                            <plus/>
                                                            <ci>V</ci>
                                                            <cn cellml:units="millivolt">97.134</cn>
                                                        </apply>
                                                        <ci>ACh_shift</ci>
                                                    </apply>
                                                    <ci>Iso_shift</ci>
                                                </apply>
                                                <ci>y_shift</ci>
                                            </apply>
                                            <cn cellml:units="millivolt">8.1752</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <lt/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="millivolt">80</cn>
                                            <ci>ACh_shift</ci>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                    <ci>y_shift</ci>
                                </apply>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.0002501</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <minus/>
                                                    <ci>V</ci>
                                                    <ci>ACh_shift</ci>
                                                </apply>
                                                <ci>Iso_shift</ci>
                                            </apply>
                                            <ci>y_shift</ci>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">12.861</cn>
                                </apply>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>y</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>y_infinity</ci>
                        <ci>y</ci>
                    </apply>
                    <ci>tau_y</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--inhibit the funny current that include Ivabradine and other heart rate reducing agents
drugs that activate the funny current include b-Adrenergic Agonists, Cyclic AMP Analogs-->
    <!--I_CaL ion channel,
activated at higher membrane potentials;
Compared to other types of calcium channels, L-type channels have a relatively slow activation and inactivation kinetics. This slow activation allows for sustained calcium influx, which is essential for various physiological processes.
an AP travels along the muscle cell membrane, reaching the T-tubules, depolarization of the T-tubule membrane activates L-type Ca channels, opening them and allowing Ca ion to enter the cell, then influex of Ca triggers the release of even more Ca from the sarcoplasmic reticulum;
based on above process, increased intracellular Ca ion concentration binds to troponin, causes a conformational change in troponin, exposing the binding sites on the actin filaments for the myosin heads, then bind to actin, initiating the sliding filament mechanism that leads to muscle contraction;
locate in a wide range of cell types, muscle cells,neuronal cells,endocrine cells, endothelial cells and immune cells-->
    <component name="i_CaL">
        <variable cmeta:id="i_CaL.i_CaL" name="i_CaL" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_CaL.i_siCa" name="i_siCa" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_CaL.i_siK" name="i_siK" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_CaL.i_siNa" name="i_siNa" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_CaL.ACh_block" name="ACh_block" units="dimensionless"/>
        <variable cmeta:id="i_CaL.ACh" name="ACh" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_CaL.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaL.P_CaL" initial_value="0.4578" name="P_CaL" units="nanoA_per_millimolar"/>
        <variable cmeta:id="i_CaL.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaL.Nao" name="Nao" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL.Nai" name="Nai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL.Ko" name="Ko" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL.Ki" name="Ki" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL.Cao" name="Cao" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL.Ca_sub" name="Ca_sub" private_interface="out" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL.dL" name="dL" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_CaL.fL" name="fL" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_CaL.fCa" name="fCa" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_CaL.Iso_increase" name="Iso_increase" units="dimensionless"/>
        <variable cmeta:id="i_CaL.Iso_1_nM" name="Iso_1_nM" private_interface="out" public_interface="in" units="dimensionless"/>
        <!--add new influence factor-->
        <variable cmeta:id="i_CaL.PKA" name="PKA" public_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_CaL.Iso_increase2" name="Iso_increase2" units="dimensionless"/>
        <!--looks like set a enhance coefficients-->
        <!--Iso_increase = sel
    case Iso_1_nM > 0{dimensionless}:
        1.23{dimensionless};
    otherwise:
        1{dimensionless};
endsel;-->
        <!--add new equation about Iso_increase that control by PKA, b-AR -> AC -> cAMP -> PKA
so, if want to replace Iso_increase, need plus 1, the range is [0.2275,-5.115]-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_increase2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.2152</cn>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.4707</cn>
                            <apply>
                                <power/>
                                <ci>PKA</ci>
                                <cn cellml:units="dimensionless">10.0808</cn>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <cn cellml:units="dimensionless">0.7303</cn>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>PKA</ci>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Iso_increase</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">1</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--3 formulas are match with the paper-->
            <apply>
                <eq/>
                <ci>i_siCa</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>P_CaL</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">0</cn>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0</cn>
                                            </apply>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Ca_sub</ci>
                        <apply>
                            <times/>
                            <ci>Cao</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">0</cn>
                                        </apply>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dL</ci>
                    <ci>fL</ci>
                    <ci>fCa</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_siK</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.000365</cn>
                            <ci>P_CaL</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">0</cn>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0</cn>
                                            </apply>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Ki</ci>
                        <apply>
                            <times/>
                            <ci>Ko</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">1</cn>
                                        </apply>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">0</cn>
                                        </apply>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dL</ci>
                    <ci>fL</ci>
                    <ci>fCa</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_siNa</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.0000185</cn>
                            <ci>P_CaL</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">0</cn>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0</cn>
                                            </apply>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Nai</ci>
                        <apply>
                            <times/>
                            <ci>Nao</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">1</cn>
                                        </apply>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">0</cn>
                                        </apply>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dL</ci>
                    <ci>fL</ci>
                    <ci>fCa</ci>
                </apply>
            </apply>
            <!--in here, also add a block coefficient
the EC50=9E-8M(same), max=0.56 in rabbit SAN cell, based on<Analysis of the Chronotropic Effect of Acetylcholine on Sinoatrial Node Cells>-->
            <apply>
                <eq/>
                <ci>ACh_block</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <cn cellml:units="dimensionless">0.31</cn>
                        <ci>ACh</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>ACh</ci>
                        <cn cellml:units="millimolar">0.00009</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_CaL</ci>
                <apply>
                    <times/>
                    <apply>
                        <plus/>
                        <ci>i_siCa</ci>
                        <ci>i_siK</ci>
                        <ci>i_siNa</ci>
                    </apply>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>ACh_block</ci>
                    </apply>
                    <cn cellml:units="dimensionless">1</cn>
                    <ci>Iso_increase</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaL_dL_gate">
        <variable cmeta:id="i_CaL_dL_gate.dL" initial_value="0.001921" name="dL" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_CaL_dL_gate.dL_infinity" name="dL_infinity" units="dimensionless"/>
        <variable cmeta:id="i_CaL_dL_gate.tau_dL" name="tau_dL" units="second"/>
        <variable cmeta:id="i_CaL_dL_gate.alpha_dL" name="alpha_dL" units="per_second"/>
        <variable cmeta:id="i_CaL_dL_gate.beta_dL" name="beta_dL" units="per_second"/>
        <variable cmeta:id="i_CaL_dL_gate.adVm" name="adVm" units="millivolt"/>
        <variable cmeta:id="i_CaL_dL_gate.bdVm" name="bdVm" units="millivolt"/>
        <variable cmeta:id="i_CaL_dL_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaL_dL_gate.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_CaL_dL_gate.Iso_1_nM" name="Iso_1_nM" public_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_CaL_dL_gate.k_dL" initial_value="4.3371" name="k_dL" units="millivolt"/>
        <variable cmeta:id="i_CaL_dL_gate.V_dL" initial_value="-16.4508" name="V_dL" units="millivolt"/>
        <variable cmeta:id="i_CaL_dL_gate.Iso_shift_dL" name="Iso_shift_dL" units="millivolt"/>
        <variable cmeta:id="i_CaL_dL_gate.Iso_slope_dL" name="Iso_slope_dL" units="dimensionless"/>
        <!--add new variable parameter PKA-->
        <variable cmeta:id="i_CaL_dL_gate.PKA" name="PKA" public_interface="in" units="dimensionless"/>
        <!--add new equation about Iso_shift/Iso_slope that control by PKA, b-AR -> AC -> cAMP -> PKA-->
        <variable cmeta:id="i_CaL_dL_gate.Iso_shift_dL2" name="Iso_shift_dL2" units="millivolt"/>
        <variable cmeta:id="i_CaL_dL_gate.Iso_slope_dL2" name="Iso_slope_dL2" units="dimensionless"/>
        <!--those are original formula by Fabbri fitting-->
        <!--Iso_shift_dL = sel
    case Iso_1_nM > 0{dimensionless}:
        -8{millivolt};
    otherwise:
        0{millivolt};
endsel;-->
        <!--Iso_slope_dL = sel
   case Iso_1_nM > 0{dimensionless}:
     -27{dimensionless};
   otherwise:
        0{dimensionless};
endsel;-->
        <!--add new equation about Iso_shift/Iso_slope that control by PKA, b-AR -> AC -> cAMP -> PKA, from Linder's paper table2
the Iso_shift_dL2 range is [18.76,-8.14], the Iso_slope_dL2 range is [0.657,0.935]
calibrated by original formula, the Iso_shift_dL should not be positive value-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_shift_dL2</ci>
                <apply>
                    <times/>
                    <apply>
                        <minus/>
                        <cn cellml:units="millivolt">1</cn>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">27.5262</cn>
                                <apply>
                                    <power/>
                                    <ci>PKA</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <apply>
                                    <power/>
                                    <cn cellml:units="dimensionless">0.6615</cn>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                                <apply>
                                    <power/>
                                    <ci>PKA</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">18.76</cn>
                    </apply>
                </apply>
            </apply>
            <!--if directly use Iso_shift_dL2, need Iso>0.095 that activate the Iso_shift_dL2 make it lower than 0
Iso_shift_dL = Iso_shift_dL2;-->
            <apply>
                <eq/>
                <ci>Iso_shift_dL</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="millivolt">0</cn>
                        <apply>
                            <gt/>
                            <ci>Iso_shift_dL2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>Iso_shift_dL2</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <!--I don't know why substract 17 then the results of I_CaL are similar with original results while set Iso=0.1!!!
based on the PKA range is [0.0296,0.9922], so the Iso_slope_dL2 range is [2.0782,0.6572]
maybe the key is make Iso_slope_dL2 lower than 1(the I_CaL activated only Iso>0.95, that while PKA>0.76, then make Iso_slope_dL2<1)-->
            <apply>
                <eq/>
                <ci>Iso_slope_dL2</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1.4762</cn>
                        </apply>
                        <ci>PKA</ci>
                    </apply>
                    <cn cellml:units="dimensionless">2.1219</cn>
                </apply>
            </apply>
            <!--increase the constant value could make the cycle more longer, but sometimes Iso=0 CANNOT active the current
Iso_slope_dL = Iso_slope_dL2 - 0.0{dimensionless};-->
            <apply>
                <eq/>
                <ci>Iso_slope_dL</ci>
                <cn cellml:units="dimensionless">0</cn>
            </apply>
            <!--this formula is different from paper-->
            <apply>
                <eq/>
                <ci>dL_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <ci>V_dL</ci>
                                        </apply>
                                        <ci>Iso_shift_dL</ci>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>k_dL</ci>
                                    <apply>
                                        <plus/>
                                        <cn cellml:units="dimensionless">1</cn>
                                        <apply>
                                            <divide/>
                                            <ci>Iso_slope_dL</ci>
                                            <cn cellml:units="dimensionless">100</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--below 2 formulas are match with paper-->
            <apply>
                <eq/>
                <ci>tau_dL</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_dL</ci>
                        <ci>beta_dL</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>alpha_dL</ci>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <cn cellml:units="per_millivolt_second">0.02839</cn>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>adVm</ci>
                                <cn cellml:units="millivolt">41.8</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>adVm</ci>
                                            <cn cellml:units="millivolt">41.8</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">2.5</cn>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="per_millivolt_second">0.0849</cn>
                            <apply>
                                <plus/>
                                <ci>adVm</ci>
                                <cn cellml:units="millivolt">6.8</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>adVm</ci>
                                            <cn cellml:units="millivolt">6.8</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">4.8</cn>
                                </apply>
                            </apply>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--I don't know why add this switch formula-->
            <apply>
                <eq/>
                <ci>adVm</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="millivolt">41.80001</cn>
                        </apply>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">41.8</cn>
                            </apply>
                        </apply>
                    </piece>
                    <piece>
                        <cn cellml:units="millivolt">0</cn>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <cn cellml:units="millivolt">0</cn>
                        </apply>
                    </piece>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="millivolt">6.80001</cn>
                        </apply>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">6.8</cn>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>beta_dL</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <cn cellml:units="per_millivolt_second">0.01143</cn>
                        <apply>
                            <plus/>
                            <ci>bdVm</ci>
                            <cn cellml:units="millivolt">1.8</cn>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>bdVm</ci>
                                    <cn cellml:units="millivolt">1.8</cn>
                                </apply>
                                <cn cellml:units="millivolt">2.5</cn>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">1</cn>
                    </apply>
                </apply>
            </apply>
            <!--same question, looks like it doesn't need-->
            <apply>
                <eq/>
                <ci>bdVm</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="millivolt">1.80001</cn>
                        </apply>
                        <apply>
                            <eq/>
                            <ci>V</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="millivolt">1.8</cn>
                            </apply>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>V</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>dL</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>dL_infinity</ci>
                        <ci>dL</ci>
                    </apply>
                    <ci>tau_dL</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaL_fL_gate">
        <variable cmeta:id="i_CaL_fL_gate.fL" initial_value="0.846702" name="fL" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_CaL_fL_gate.fL_infinity" name="fL_infinity" units="dimensionless"/>
        <variable cmeta:id="i_CaL_fL_gate.tau_fL" name="tau_fL" units="second"/>
        <variable cmeta:id="i_CaL_fL_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaL_fL_gate.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_CaL_fL_gate.shift_fL" initial_value="0" name="shift_fL" units="millivolt"/>
        <variable cmeta:id="i_CaL_fL_gate.k_fL" initial_value="0" name="k_fL" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>fL_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">37.4</cn>
                                    <ci>shift_fL</ci>
                                </apply>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="millivolt">5.3</cn>
                                    <ci>k_fL</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_fL</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="second">44.3</cn>
                        <apply>
                            <times/>
                            <cn cellml:units="second">230</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <power/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">36</cn>
                                            </apply>
                                            <cn cellml:units="millivolt">10</cn>
                                        </apply>
                                        <cn cellml:units="dimensionless">2</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fL</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>fL_infinity</ci>
                        <ci>fL</ci>
                    </apply>
                    <ci>tau_fL</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaL_fCa_gate">
        <variable cmeta:id="i_CaL_fCa_gate.fCa" initial_value="0.844449" name="fCa" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_CaL_fCa_gate.alpha_fCa" initial_value="0.0075" name="alpha_fCa" units="per_second"/>
        <variable cmeta:id="i_CaL_fCa_gate.fCa_infinity" name="fCa_infinity" units="dimensionless"/>
        <variable cmeta:id="i_CaL_fCa_gate.tau_fCa" name="tau_fCa" units="second"/>
        <variable cmeta:id="i_CaL_fCa_gate.Km_fCa" initial_value="0.000338" name="Km_fCa" units="millimolar"/>
        <variable cmeta:id="i_CaL_fCa_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaL_fCa_gate.Ca_sub" name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaL_fCa_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>fCa_infinity</ci>
                <apply>
                    <divide/>
                    <ci>Km_fCa</ci>
                    <apply>
                        <plus/>
                        <ci>Km_fCa</ci>
                        <ci>Ca_sub</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_fCa</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <cn cellml:units="dimensionless">0.001</cn>
                        <ci>fCa_infinity</ci>
                    </apply>
                    <ci>alpha_fCa</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fCa</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>fCa_infinity</ci>
                        <ci>fCa</ci>
                    </apply>
                    <ci>tau_fCa</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--block this channel drugs: calcium channel blockers that such as nifedipine/Amlodipine/Nicardipine/Verapamil/Diltiazem, calcium channel agonists that such as Bay K 8644;
not have directly activated drugs, but some indirect information that such as b-Adreergic Agonists-->
    <!--I_CaT ion channel
activated at relatively negative membrane potentials compared to other calcium channels, it is a 'low-voltage activated' channel,
1)T-type channels open at membrane potentials close to the resting potential (-60mV to -40mV); 2)rapid inactivation;3)sensitivity to Nickel; 4)smaller conductance;
low-voltage activation allows it contribute to generation of AP/repetitive firing/pacemaker activity, or regular heart rate
primarily in the nervous system, heart, smooth muscle-->
    <component name="i_CaT">
        <variable cmeta:id="i_CaT.i_CaT" name="i_CaT" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_CaT.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_CaT.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaT.P_CaT" initial_value="0.04132" name="P_CaT" units="nanoA_per_millimolar"/>
        <variable cmeta:id="i_CaT.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaT.Cao" name="Cao" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaT.Ca_sub" name="Ca_sub" private_interface="out" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_CaT.dT" name="dT" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_CaT.fT" name="fT" private_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_CaT</ci>
                <apply>
                    <times/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>P_CaT</ci>
                            <ci>V</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>RTONF</ci>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="dimensionless">1</cn>
                                            </apply>
                                            <ci>V</ci>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <ci>RTONF</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>Ca_sub</ci>
                        <apply>
                            <times/>
                            <ci>Cao</ci>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="dimensionless">2</cn>
                                        </apply>
                                        <ci>V</ci>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>dT</ci>
                    <ci>fT</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaT_dT_gate">
        <variable cmeta:id="i_CaT_dT_gate.dT" initial_value="0.268909" name="dT" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_CaT_dT_gate.dT_infinity" name="dT_infinity" units="dimensionless"/>
        <variable cmeta:id="i_CaT_dT_gate.tau_dT" name="tau_dT" units="second"/>
        <variable cmeta:id="i_CaT_dT_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaT_dT_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>dT_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">38.3</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">5.5</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_dT</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">0.001</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">1.068</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">38.3</cn>
                                    </apply>
                                    <cn cellml:units="millivolt">30</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">1.068</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">38.3</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">30</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>dT</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>dT_infinity</ci>
                        <ci>dT</ci>
                    </apply>
                    <ci>tau_dT</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_CaT_fT_gate">
        <variable cmeta:id="i_CaT_fT_gate.fT" initial_value="0.020484" name="fT" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_CaT_fT_gate.fT_infinity" name="fT_infinity" units="dimensionless"/>
        <variable cmeta:id="i_CaT_fT_gate.tau_fT" name="tau_fT" units="second"/>
        <variable cmeta:id="i_CaT_fT_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_CaT_fT_gate.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_CaT_fT_gate.offset_fT" initial_value="0" name="offset_fT" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>fT_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">58.7</cn>
                                </apply>
                                <cn cellml:units="millivolt">3.8</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--this formula add an offset coefficient, not the same as paper-->
            <apply>
                <eq/>
                <ci>tau_fT</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">1</cn>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">16.67</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">75</cn>
                                            </apply>
                                        </apply>
                                        <cn cellml:units="millivolt">83.3</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">16.67</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">75</cn>
                                        </apply>
                                        <cn cellml:units="millivolt">15.38</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>offset_fT</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fT</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>fT_infinity</ci>
                        <ci>fT</ci>
                    </apply>
                    <ci>tau_fT</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--this channel could be blocked by inorganic blockers that such as Nickel/Cadmium/Zinc/Lanthanum, organic blockers that such as Amiloride/Ethosuximide/Mibefradil/Efonidipine, other blockers that such as Anticonvulsants/Barbiturates
not have directly activated drugs, indrect drug that such as Efonidipine/Anticonvulsants-->
    <!--I_Kr ion channel, rapidly activating delayed rectifier K ion current
important to the repolarization phase of the cardiac AP, responsible for the rapid decline in membrane potential after initial depolarization, contributing to the overall shape and duration of the action potential;
activated by membrane depolarization, but very slow activation compared to the Na current for initial depolarization, deactivateds rapidly;
primarily found in cardiac cells, such as ventricular myocytes, artial myocytes,-->
    <component name="i_Kr">
        <variable cmeta:id="i_Kr.i_Kr" name="i_Kr" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_Kr.g_Kr" initial_value="0.00424" name="g_Kr" units="microS"/>
        <variable cmeta:id="i_Kr.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_Kr.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kr.E_K" name="E_K" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kr.Ko" name="Ko" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Kr.paS" name="paS" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Kr.paF" name="paF" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Kr.piy" name="piy" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Kr.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_Kr</ci>
                <apply>
                    <times/>
                    <ci>g_Kr</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.9</cn>
                            <ci>paF</ci>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.1</cn>
                            <ci>paS</ci>
                        </apply>
                    </apply>
                    <ci>piy</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kr_pa_gate">
        <variable cmeta:id="i_Kr_pa_gate.paS" initial_value="0.283185" name="paS" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Kr_pa_gate.paF" initial_value="0.011068" name="paF" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Kr_pa_gate.pa_infinity" name="pa_infinity" units="dimensionless"/>
        <variable cmeta:id="i_Kr_pa_gate.alfapaF" name="alfapaF" units="per_second"/>
        <variable cmeta:id="i_Kr_pa_gate.betapaF" name="betapaF" units="per_second"/>
        <variable cmeta:id="i_Kr_pa_gate.tau_paS" name="tau_paS" units="second"/>
        <variable cmeta:id="i_Kr_pa_gate.tau_paF" name="tau_paF" units="second"/>
        <variable cmeta:id="i_Kr_pa_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kr_pa_gate.time" name="time" public_interface="in" units="second"/>
        <!--why write those 2 formual? and never used-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>alfapaF</ci>
                <apply>
                    <divide/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">23.2</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">6.6</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">0.84655354</cn>
                        <apply>
                            <plus/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">37.2</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">11.9</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">0.96</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                        </apply>
                                        <cn cellml:units="millivolt">18.5</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>betapaF</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">4</cn>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">37.2</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">15.9</cn>
                                        </apply>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.96</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                            </apply>
                                            <cn cellml:units="millivolt">22.5</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                            <cn cellml:units="second">0.84655354</cn>
                        </apply>
                        <apply>
                            <divide/>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <divide/>
                                            <apply>
                                                <minus/>
                                                <apply>
                                                    <plus/>
                                                    <ci>V</ci>
                                                    <cn cellml:units="millivolt">23.2</cn>
                                                </apply>
                                            </apply>
                                            <cn cellml:units="millivolt">10.6</cn>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                            <apply>
                                <divide/>
                                <cn cellml:units="second">0.84655354</cn>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="dimensionless">37.2</cn>
                                        <apply>
                                            <exp/>
                                            <apply>
                                                <divide/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">15.9</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="dimensionless">0.96</cn>
                                        <apply>
                                            <exp/>
                                            <apply>
                                                <divide/>
                                                <apply>
                                                    <minus/>
                                                    <ci>V</ci>
                                                </apply>
                                                <cn cellml:units="millivolt">22.5</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <!--below all the same as the paper-->
            <apply>
                <eq/>
                <ci>pa_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">10.0144</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">7.6607</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_paS</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">0.84655354</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">4.2</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">17</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.15</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                    </apply>
                                    <cn cellml:units="millivolt">21.6</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_paF</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">1</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">30</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">10</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <ci>V</ci>
                                </apply>
                                <cn cellml:units="millivolt">12</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>paS</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>pa_infinity</ci>
                        <ci>paS</ci>
                    </apply>
                    <ci>tau_paS</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>paF</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>pa_infinity</ci>
                        <ci>paF</ci>
                    </apply>
                    <ci>tau_paF</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kr_pi_gate">
        <variable cmeta:id="i_Kr_pi_gate.piy" initial_value="0.709051" name="piy" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Kr_pi_gate.pi_infinity" name="pi_infinity" units="dimensionless"/>
        <variable cmeta:id="i_Kr_pi_gate.tau_pi" name="tau_pi" units="second"/>
        <variable cmeta:id="i_Kr_pi_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kr_pi_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>tau_pi</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="second">1</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">100</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                    </apply>
                                    <cn cellml:units="millivolt">54.645</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">656</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">106.157</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>pi_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">28.6</cn>
                                </apply>
                                <cn cellml:units="millivolt">17.1</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>piy</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>pi_infinity</ci>
                        <ci>piy</ci>
                    </apply>
                    <ci>tau_pi</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--this channel current could be blocked by Antiarrhythmics that such as dofetillide/sotalol, Antibiotics that such as erythromycin/moxifloxacin,E-4031
this channel current can be enhanced by NS3623-->
    <!--I_Ks ion channel, slowly activating delayed rectifier K ion current
contribute significantly to the repolarization reserve, can prolong the action potential duration
activated by depolarization
primarily in the cardiac cells, especially ventricular myocytes-->
    <component name="i_Ks">
        <variable cmeta:id="i_Ks.i_Ks" name="i_Ks" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_Ks.g_Ks" name="g_Ks" public_interface="out" units="microS"/>
        <variable cmeta:id="i_Ks.g_Ks_" initial_value="0.00065" name="g_Ks_" units="microS"/>
        <variable cmeta:id="i_Ks.E_Ks" name="E_Ks" units="millivolt"/>
        <variable cmeta:id="i_Ks.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_Ks.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Ks.Ki" name="Ki" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Ks.Ko" name="Ko" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Ks.Nai" name="Nai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Ks.Nao" name="Nao" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Ks.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Ks.n" name="n" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Ks.Iso_1_nM" name="Iso_1_nM" private_interface="out" public_interface="in" units="dimensionless"/>
        <!--add new variable parameter PKA-->
        <variable cmeta:id="i_Ks.PKA" name="PKA" private_interface="in" units="dimensionless"/>
        <!--add new equation about Iso_increase that control by PKA, b-AR -> AC -> cAMP -> PKA-->
        <variable cmeta:id="i_Ks.Iso_increase2" name="Iso_increase2" units="dimensionless"/>
        <variable cmeta:id="i_Ks.Iso_increase" name="Iso_increase" units="dimensionless"/>
        <!--define Iso_increase value
from this article <Isoprenaline: A Potential Contributor in Sick Sinus Syndrome—Insights from a Mathematical Model of the Rabbit Sinoatrial Node>, the result current should be new_I_ks=old_I_ks*(1+Iso_increase)
the Iso_increase2 range is [-7.38,0.20]
Iso_increase = Iso_increase2+1{dimensionless};-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_increase2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.2152</cn>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.4357</cn>
                            <apply>
                                <power/>
                                <ci>PKA</ci>
                                <cn cellml:units="dimensionless">10.0808</cn>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <cn cellml:units="dimensionless">0.7042</cn>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>PKA</ci>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Iso_increase</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">1</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--add a switch coefficient that shift the voltage value, I think it will make this channel current shift-->
            <apply>
                <eq/>
                <ci>g_Ks</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>Iso_increase</ci>
                            <ci>g_Ks_</ci>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_1_nM</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>g_Ks_</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>E_Ks</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <apply>
                                <plus/>
                                <ci>Ko</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Nao</ci>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>Ki</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Nai</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_Ks</ci>
                <apply>
                    <times/>
                    <ci>g_Ks</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_Ks</ci>
                    </apply>
                    <apply>
                        <power/>
                        <ci>n</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Ks_n_gate">
        <variable cmeta:id="i_Ks_n_gate.n" initial_value="0.1162" name="n" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Ks_n_gate.n_infinity" name="n_infinity" units="dimensionless"/>
        <variable cmeta:id="i_Ks_n_gate.tau_n" name="tau_n" units="second"/>
        <variable cmeta:id="i_Ks_n_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Ks_n_gate.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_Ks_n_gate.Iso_1_nM" name="Iso_1_nM" public_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Ks_n_gate.Iso_shift" name="Iso_shift" units="millivolt"/>
        <variable cmeta:id="i_Ks_n_gate.alpha_n" name="alpha_n" units="per_second"/>
        <variable cmeta:id="i_Ks_n_gate.beta_n" name="beta_n" units="per_second"/>
        <!--add new input variable parameters-->
        <variable cmeta:id="i_Ks_n_gate.PKA" name="PKA" public_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Ks_n_gate.Iso_shift2" name="Iso_shift2" units="millivolt"/>
        <!--add new equation about Iso_shift that control by PKA, b-AR -> AC -> cAMP -> PKA, from Linder's paper table3
the Iso_shift2 range is [18.76,-14.3]
the same as I_CaL and I_f, usually need Iso_shift2 lower than 0-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_shift2</ci>
                <apply>
                    <times/>
                    <apply>
                        <minus/>
                        <cn cellml:units="millivolt">1</cn>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">34.4376</cn>
                                <apply>
                                    <power/>
                                    <ci>PKA</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <apply>
                                    <power/>
                                    <cn cellml:units="dimensionless">0.7042</cn>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                                <apply>
                                    <power/>
                                    <ci>PKA</ci>
                                    <cn cellml:units="dimensionless">9.281</cn>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">18.76</cn>
                    </apply>
                </apply>
            </apply>
            <!--Iso_shift = Iso_shift2;-->
            <apply>
                <eq/>
                <ci>Iso_shift</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="millivolt">0</cn>
                        <apply>
                            <gt/>
                            <ci>Iso_shift2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <ci>Iso_shift2</ci>
                    </otherwise>
                </piecewise>
            </apply>
            <!--original Fabbri fitting-->
            <!--Iso_shift = sel
    case Iso_1_nM > 0{dimensionless}:
        -14{millivolt};
    otherwise:
        0{millivolt};
endsel;-->
            <apply>
                <eq/>
                <ci>n_infinity</ci>
                <apply>
                    <root/>
                    <apply>
                        <divide/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">0.6383</cn>
                                            </apply>
                                            <ci>Iso_shift</ci>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">10.7071</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_n</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_n</ci>
                        <ci>beta_n</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>alpha_n</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="per_second">28</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <minus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">40</cn>
                                        </apply>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">3</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta_n</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">1</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <divide/>
                            <apply>
                                <minus/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                        <ci>Iso_shift</ci>
                                    </apply>
                                    <cn cellml:units="millivolt">5</cn>
                                </apply>
                            </apply>
                            <cn cellml:units="millivolt">25</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>n</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>n_infinity</ci>
                        <ci>n</ci>
                    </apply>
                    <ci>tau_n</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--there are no rugs known to specifically activate this channel, but some drugs can indirectly influence activity that such as calcium concentration or phosphorylation states
some drugs can inhibit this channel that such as Fluoxetine and its metabolite norfluoxetine, HMR 1556, other drugs such as tramadol and codeine-->
    <!--I_KACh ion channel, ACh-activated K ion current
regulating atrial action potentials and heart rate
Acetylcholine binds to M2 muscarinic recepts->activates a series of signaling events involving G proteins->open rectifying K channels->causing hyperpolarization
mainly found in the cardiac cells such as atrial myocytes,-->
    <component name="i_KACh">
        <variable cmeta:id="i_KACh.ACh" name="ACh" private_interface="out" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_KACh.i_KACh" name="i_KACh" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_KACh.g_KACh" initial_value="0.00345" name="g_KACh" units="microS"/>
        <variable cmeta:id="i_KACh.E_K" name="E_K" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_KACh.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_KACh.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_KACh.a" name="a" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_KACh.ACh_on" initial_value="1" name="ACh_on" units="dimensionless"/>
        <!--add a switch
this paper's i_KACh equation different: <Analysis of the Chronotropic Effect of Acetylcholine on Sinoatrial Node Cells>-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_KACh</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <times/>
                            <ci>ACh_on</ci>
                            <ci>g_KACh</ci>
                            <apply>
                                <minus/>
                                <ci>V</ci>
                                <ci>E_K</ci>
                            </apply>
                            <apply>
                                <plus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <divide/>
                                        <apply>
                                            <plus/>
                                            <ci>V</ci>
                                            <cn cellml:units="millivolt">20</cn>
                                        </apply>
                                        <cn cellml:units="millivolt">20</cn>
                                    </apply>
                                </apply>
                            </apply>
                            <ci>a</ci>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ACh</ci>
                            <cn cellml:units="millimolar">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="nanoA">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
        </math>
    </component>
    <component name="i_KACh_a_gate">
        <variable cmeta:id="i_KACh_a_gate.a" initial_value="0.00277" name="a" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_KACh_a_gate.alpha_a" name="alpha_a" units="per_second"/>
        <variable cmeta:id="i_KACh_a_gate.beta_a" name="beta_a" units="per_second"/>
        <variable cmeta:id="i_KACh_a_gate.a_infinity" name="a_infinity" units="dimensionless"/>
        <variable cmeta:id="i_KACh_a_gate.tau_a" name="tau_a" units="second"/>
        <variable cmeta:id="i_KACh_a_gate.ACh" name="ACh" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_KACh_a_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_KACh_a_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>alpha_a</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <apply>
                            <minus/>
                            <cn cellml:units="per_second">3.5988</cn>
                            <cn cellml:units="per_second">0.025641</cn>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <divide/>
                                <cn cellml:units="dimensionless">0.0000012155</cn>
                                <apply>
                                    <power/>
                                    <apply>
                                        <times/>
                                        <cn cellml:units="per_millimolar">1</cn>
                                        <ci>ACh</ci>
                                    </apply>
                                    <cn cellml:units="dimensionless">1.6951</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="per_second">0.025641</cn>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta_a</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">10</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <times/>
                            <cn cellml:units="per_millivolt">0.0133</cn>
                            <apply>
                                <plus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">40</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>a_infinity</ci>
                <apply>
                    <divide/>
                    <ci>alpha_a</ci>
                    <apply>
                        <plus/>
                        <ci>alpha_a</ci>
                        <ci>beta_a</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_a</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_a</ci>
                        <ci>beta_a</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>a</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>a_infinity</ci>
                        <ci>a</ci>
                    </apply>
                    <ci>tau_a</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--some drugs can inhibit this channel that such as fluoxetine/norfluoxetine/HMR 1556 but also increasing the risk of arrhythmias
no drugs are known to specifically activate this channel-->
    <!--I_to ion channel, transient outward K ion current
plays a significant role in the repolarization phase, can prolong the action potential duration, shape the rapid initial repolarization phase,
activated rapidly by membrane depolarization, contributing to the initial rapid repolarization phase, also inactivates rapidly
primarily in cardiac cells, particularly in ventricular myocytes-->
    <component name="i_to">
        <variable cmeta:id="i_to.i_to" name="i_to" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_to.g_to" initial_value="3.5e-3" name="g_to" units="microS"/>
        <variable cmeta:id="i_to.E_K" name="E_K" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_to.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_to.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_to.q" name="q" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_to.r" name="r" private_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_to</ci>
                <apply>
                    <times/>
                    <ci>g_to</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                    <ci>q</ci>
                    <ci>r</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_to_q_gate">
        <variable cmeta:id="i_to_q_gate.q" initial_value="0.430836" name="q" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_to_q_gate.q_infinity" name="q_infinity" units="dimensionless"/>
        <variable cmeta:id="i_to_q_gate.tau_q" name="tau_q" units="second"/>
        <variable cmeta:id="i_to_q_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_to_q_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>q_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">49</cn>
                                </apply>
                                <cn cellml:units="millivolt">13</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_q</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <cn cellml:units="dimensionless">0.6</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <cn cellml:units="dimensionless">65.17</cn>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_second">0.57</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="per_millivolt">0.08</cn>
                                            </apply>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">44</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="per_second">0.065</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millivolt">0.1</cn>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">45.93</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="second">10.1</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>q</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>q_infinity</ci>
                        <ci>q</ci>
                    </apply>
                    <ci>tau_q</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_to_r_gate">
        <variable cmeta:id="i_to_r_gate.r" initial_value="0.014523" name="r" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_to_r_gate.r_infinity" name="r_infinity" units="dimensionless"/>
        <variable cmeta:id="i_to_r_gate.tau_r" name="tau_r" units="second"/>
        <variable cmeta:id="i_to_r_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_to_r_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>r_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <minus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">19.3</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">15</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_r</ci>
                <apply>
                    <times/>
                    <cn cellml:units="dimensionless">0.001</cn>
                    <cn cellml:units="dimensionless">0.66</cn>
                    <cn cellml:units="dimensionless">1.4</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <cn cellml:units="second">15.59</cn>
                            <apply>
                                <plus/>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">1.037</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <cn cellml:units="per_millivolt">0.09</cn>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">30.61</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.369</cn>
                                    <apply>
                                        <exp/>
                                        <apply>
                                            <times/>
                                            <apply>
                                                <minus/>
                                                <cn cellml:units="per_millivolt">0.12</cn>
                                            </apply>
                                            <apply>
                                                <plus/>
                                                <ci>V</ci>
                                                <cn cellml:units="millivolt">23.84</cn>
                                            </apply>
                                        </apply>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="second">2.98</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>r</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>r_infinity</ci>
                        <ci>r</ci>
                    </apply>
                    <ci>tau_r</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--this channel can be inhibit by some drugs that such as 4-aminopyridine(4-AP), other Kv4 channel blockers, but may lead to prolonged APD and increased susceptibility to cardiac arrhythmias
no known drugs can directly activate or enhance this channel-->
    <!--I_Na ion channel, Na ion current
responsbile for the rapid depolarization phase of the action potential, leading to the generation of electrical signals that transmit information throughout the body
activated by depolarization of the cell membrane, when membrane potential become more positive the channel's activation gate opens, allowing Na ion flow into the cell,then rapid inactivation
rapid influex of Na ion also propagating the signal to neighboring regions and triggers muscle contraction
located in excitable cells include neurons and muscles-->
    <component name="i_Na">
        <variable cmeta:id="i_Na.i_Na_" name="i_Na_" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_Na.i_Na_L" name="i_Na_L" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_Na.i_Na" name="i_Na" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_Na.g_Na" initial_value="0.0223" name="g_Na" units="microS"/>
        <variable cmeta:id="i_Na.g_Na_L" initial_value="0" name="g_Na_L" units="microS"/>
        <variable cmeta:id="i_Na.E_mh" name="E_mh" units="millivolt"/>
        <variable cmeta:id="i_Na.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_Na.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Na.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Na.Nao" name="Nao" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Na.Nai" name="Nai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Na.Ko" name="Ko" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Na.Ki" name="Ki" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_Na.m" name="m" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Na.h" name="h" private_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>E_mh</ci>
                <apply>
                    <times/>
                    <ci>RTONF</ci>
                    <apply>
                        <ln/>
                        <apply>
                            <divide/>
                            <apply>
                                <plus/>
                                <ci>Nao</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Ko</ci>
                                </apply>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>Nai</ci>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">0.12</cn>
                                    <ci>Ki</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_Na_</ci>
                <apply>
                    <times/>
                    <ci>g_Na</ci>
                    <apply>
                        <power/>
                        <ci>m</ci>
                        <cn cellml:units="dimensionless">3</cn>
                    </apply>
                    <ci>h</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_mh</ci>
                    </apply>
                </apply>
            </apply>
            <!--not sure why in here add a new algorithm to calculate the i_Na, although preset 0-->
            <apply>
                <eq/>
                <ci>i_Na_L</ci>
                <apply>
                    <times/>
                    <ci>g_Na_L</ci>
                    <apply>
                        <power/>
                        <ci>m</ci>
                        <cn cellml:units="dimensionless">3</cn>
                    </apply>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_mh</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>i_Na</ci>
                <apply>
                    <plus/>
                    <ci>i_Na_</ci>
                    <ci>i_Na_L</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Na_m_gate">
        <variable cmeta:id="i_Na_m_gate.m" initial_value="0.447724" name="m" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Na_m_gate.alpha_m" name="alpha_m" units="per_second"/>
        <variable cmeta:id="i_Na_m_gate.beta_m" name="beta_m" units="per_second"/>
        <variable cmeta:id="i_Na_m_gate.m_infinity" name="m_infinity" units="dimensionless"/>
        <variable cmeta:id="i_Na_m_gate.tau_m" name="tau_m" units="second"/>
        <variable cmeta:id="i_Na_m_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Na_m_gate.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_Na_m_gate.delta_m" initial_value="1e-5" name="delta_m" units="millivolt"/>
        <variable cmeta:id="i_Na_m_gate.E0_m" name="E0_m" units="millivolt"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>m_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <minus/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">42.0504</cn>
                                    </apply>
                                </apply>
                                <cn cellml:units="millivolt">8.3106</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>E0_m</ci>
                <apply>
                    <plus/>
                    <ci>V</ci>
                    <cn cellml:units="millivolt">41</cn>
                </apply>
            </apply>
            <!--if the voltage too small, use preset parameter-->
            <apply>
                <eq/>
                <ci>alpha_m</ci>
                <piecewise>
                    <piece>
                        <cn cellml:units="per_second">2000</cn>
                        <apply>
                            <lt/>
                            <apply>
                                <abs/>
                                <ci>E0_m</ci>
                            </apply>
                            <ci>delta_m</ci>
                        </apply>
                    </piece>
                    <otherwise>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="per_millivolt_second">200</cn>
                                <ci>E0_m</ci>
                            </apply>
                            <apply>
                                <minus/>
                                <cn cellml:units="dimensionless">1</cn>
                                <apply>
                                    <exp/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <cn cellml:units="per_millivolt">0.1</cn>
                                        </apply>
                                        <ci>E0_m</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>beta_m</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">8000</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <cn cellml:units="per_millivolt">0.056</cn>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">66</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_m</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_m</ci>
                        <ci>beta_m</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>m</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>m_infinity</ci>
                        <ci>m</ci>
                    </apply>
                    <ci>tau_m</ci>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Na_h_gate">
        <variable cmeta:id="i_Na_h_gate.h" initial_value="0.003058" name="h" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Na_h_gate.alpha_h" name="alpha_h" units="per_second"/>
        <variable cmeta:id="i_Na_h_gate.beta_h" name="beta_h" units="per_second"/>
        <variable cmeta:id="i_Na_h_gate.h_infinity" name="h_infinity" units="dimensionless"/>
        <variable cmeta:id="i_Na_h_gate.tau_h" name="tau_h" units="second"/>
        <variable cmeta:id="i_Na_h_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Na_h_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>h_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">69.804</cn>
                                </apply>
                                <cn cellml:units="millivolt">4.4565</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>alpha_h</ci>
                <apply>
                    <times/>
                    <cn cellml:units="per_second">20</cn>
                    <apply>
                        <exp/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <cn cellml:units="per_millivolt">0.125</cn>
                            </apply>
                            <apply>
                                <plus/>
                                <ci>V</ci>
                                <cn cellml:units="millivolt">75</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>beta_h</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="per_second">2000</cn>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">320</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <times/>
                                    <apply>
                                        <minus/>
                                        <cn cellml:units="per_millivolt">0.1</cn>
                                    </apply>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">75</cn>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                        <cn cellml:units="dimensionless">1</cn>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_h</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <ci>alpha_h</ci>
                        <ci>beta_h</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>h</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>h_infinity</ci>
                        <ci>h</ci>
                    </apply>
                    <ci>tau_h</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--this channel can be blocked by some drugs that such as Anticonvulsants/Local Anesthetics/Antiarrhythmics, but maybe lead to cardiac arrhythmias and heart failure
no known drugs can directly activate or enhance this channel-->
    <!--I_NaK ion channdels, Na ion and K ion exchanger current, generated by the sodium-potassium pump, also known as Na+/K+-ATPase
actively transport Na ion out of the cell and K ion into the cell, not a real channel, maintaing the resting membrane potential and generate action potentials, maintain ionic homeostasis
the pump's action is electrogenic, meaning it contributes to the membrane potential by moving more positive charges out of the cell than it brings in
activated by depolarization and repolarization, play roles in muscle contraction
it spread all cells that include Na/K ions transmit-->
    <component name="i_NaK">
        <variable cmeta:id="i_NaK.i_NaK" name="i_NaK" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_NaK.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_NaK.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_NaK.Km_Kp" initial_value="1.4" name="Km_Kp" units="millimolar"/>
        <variable cmeta:id="i_NaK.Km_Nap" initial_value="14" name="Km_Nap" units="millimolar"/>
        <variable cmeta:id="i_NaK.i_NaK_max" initial_value="0.08105" name="i_NaK_max" units="nanoA"/>
        <variable cmeta:id="i_NaK.Nai" name="Nai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_NaK.Ko" name="Ko" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_NaK.E_Na" name="E_Na" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_NaK.Iso_increase" name="Iso_increase" units="dimensionless"/>
        <variable cmeta:id="i_NaK.Iso_1_nM" name="Iso_1_nM" private_interface="out" public_interface="in" units="dimensionless"/>
        <!--add new variable parameter PKA-->
        <variable cmeta:id="i_NaK.PKA" name="PKA" private_interface="in" units="dimensionless"/>
        <!--add new equation about Iso_increase that control by PKA, b-AR -> AC -> cAMP -> PKA, from Linder's paper table3-->
        <variable cmeta:id="i_NaK.Iso_increase2" name="Iso_increase2" units="dimensionless"/>
        <!--the Iso_increase2 range is [-7.38,0.20]-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>Iso_increase2</ci>
                <apply>
                    <divide/>
                    <apply>
                        <plus/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.2152</cn>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">0.4357</cn>
                            <apply>
                                <power/>
                                <ci>PKA</ci>
                                <cn cellml:units="dimensionless">10.0808</cn>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <power/>
                            <cn cellml:units="dimensionless">0.7042</cn>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                        <apply>
                            <power/>
                            <ci>PKA</ci>
                            <cn cellml:units="dimensionless">10.0808</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>Iso_increase</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <plus/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">1.0</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_increase2</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">1</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <!--add a enhanced coefficient
original Fabbri fitting
Iso_increase = sel
    case Iso_1_nM > 0{dimensionless}:
        1.2{dimensionless};
    otherwise:
        1{dimensionless};
endsel;-->
            <apply>
                <eq/>
                <ci>i_NaK</ci>
                <apply>
                    <times/>
                    <ci>Iso_increase</ci>
                    <ci>i_NaK_max</ci>
                    <apply>
                        <power/>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <power/>
                                <apply>
                                    <divide/>
                                    <ci>Km_Kp</ci>
                                    <ci>Ko</ci>
                                </apply>
                                <cn cellml:units="dimensionless">1.2</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <power/>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <power/>
                                <apply>
                                    <divide/>
                                    <ci>Km_Nap</ci>
                                    <ci>Nai</ci>
                                </apply>
                                <cn cellml:units="dimensionless">1.3</cn>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                    <apply>
                        <power/>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <minus/>
                                        <apply>
                                            <plus/>
                                            <apply>
                                                <minus/>
                                                <ci>V</ci>
                                                <ci>E_Na</ci>
                                            </apply>
                                            <cn cellml:units="millivolt">110</cn>
                                        </apply>
                                    </apply>
                                    <cn cellml:units="millivolt">20</cn>
                                </apply>
                            </apply>
                        </apply>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--this pump can be blocked by cardiac glycosides that such as digoxin/ouabain, and Spironolactone
Glucocorticoids can activate the Na-K pump-->
    <!--I_NaCa ion channels, Na ion and Ca ion exchanger current
regulating intracellular calcium levels in various cell types, especially in heart muscle cells (cardiomyocytes)
exchange can occur in both directions, forward: 3 Na into the cell while 1 Ca out; reserve: 1 Ca into the cell while 3 Na out, maintain ionic homeostasis
forward mode contribute to the repolarization phase, and reverse mode contribute to arrhythmias
located in the plasma membranes of excitable cells that include neurons/muscle cells/cardiac cells, also in mitochondria and endoplasmic reticulum of excitable cells-->
    <component name="i_NaCa">
        <variable cmeta:id="i_NaCa.i_NaCa" name="i_NaCa" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_NaCa.K_NaCa" initial_value="3.343" name="K_NaCa" units="nanoA"/>
        <variable cmeta:id="i_NaCa.x1" name="x1" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.x2" name="x2" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.x3" name="x3" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.x4" name="x4" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k41" name="k41" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k34" name="k34" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k23" name="k23" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k21" name="k21" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k32" name="k32" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k43" name="k43" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k12" name="k12" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.k14" name="k14" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.Qci" initial_value="0.1369" name="Qci" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.Qn" initial_value="0.4315" name="Qn" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.Qco" initial_value="0" name="Qco" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.K3ni" initial_value="26.44" name="K3ni" units="millimolar"/>
        <variable cmeta:id="i_NaCa.Kci" initial_value="0.0207" name="Kci" units="millimolar"/>
        <variable cmeta:id="i_NaCa.K1ni" initial_value="395.3" name="K1ni" units="millimolar"/>
        <variable cmeta:id="i_NaCa.K2ni" initial_value="2.289" name="K2ni" units="millimolar"/>
        <variable cmeta:id="i_NaCa.Kcni" initial_value="26.44" name="Kcni" units="millimolar"/>
        <variable cmeta:id="i_NaCa.K3no" initial_value="4.663" name="K3no" units="millimolar"/>
        <variable cmeta:id="i_NaCa.K1no" initial_value="1628" name="K1no" units="millimolar"/>
        <variable cmeta:id="i_NaCa.K2no" initial_value="561.4" name="K2no" units="millimolar"/>
        <variable cmeta:id="i_NaCa.Kco" initial_value="3.663" name="Kco" units="millimolar"/>
        <variable cmeta:id="i_NaCa.do" name="do" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.di" name="di" units="dimensionless"/>
        <variable cmeta:id="i_NaCa.Cao" name="Cao" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_NaCa.Nao" name="Nao" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_NaCa.Ca_sub" name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_NaCa.Nai" name="Nai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="i_NaCa.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="i_NaCa.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_NaCa.RTONF" name="RTONF" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_NaCa.blockade_NaCa" initial_value="0" name="blockade_NaCa" units="dimensionless"/>
        <!--add a blockade coefficient about Na-Ca pump-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_NaCa</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>blockade_NaCa</ci>
                        </apply>
                        <ci>K_NaCa</ci>
                        <apply>
                            <minus/>
                            <apply>
                                <times/>
                                <ci>x2</ci>
                                <ci>k21</ci>
                            </apply>
                            <apply>
                                <times/>
                                <ci>x1</ci>
                                <ci>k12</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <plus/>
                        <ci>x1</ci>
                        <ci>x2</ci>
                        <ci>x3</ci>
                        <ci>x4</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x1</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k41</ci>
                        <ci>k34</ci>
                        <apply>
                            <plus/>
                            <ci>k23</ci>
                            <ci>k21</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k21</ci>
                        <ci>k32</ci>
                        <apply>
                            <plus/>
                            <ci>k43</ci>
                            <ci>k41</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x2</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k32</ci>
                        <ci>k43</ci>
                        <apply>
                            <plus/>
                            <ci>k14</ci>
                            <ci>k12</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k41</ci>
                        <ci>k12</ci>
                        <apply>
                            <plus/>
                            <ci>k34</ci>
                            <ci>k32</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x3</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k14</ci>
                        <ci>k43</ci>
                        <apply>
                            <plus/>
                            <ci>k23</ci>
                            <ci>k21</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k12</ci>
                        <ci>k23</ci>
                        <apply>
                            <plus/>
                            <ci>k43</ci>
                            <ci>k41</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>x4</ci>
                <apply>
                    <plus/>
                    <apply>
                        <times/>
                        <ci>k23</ci>
                        <ci>k34</ci>
                        <apply>
                            <plus/>
                            <ci>k14</ci>
                            <ci>k12</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>k14</ci>
                        <ci>k21</ci>
                        <apply>
                            <plus/>
                            <ci>k34</ci>
                            <ci>k32</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k43</ci>
                <apply>
                    <divide/>
                    <ci>Nai</ci>
                    <apply>
                        <plus/>
                        <ci>K3ni</ci>
                        <ci>Nai</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k12</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Ca_sub</ci>
                            <ci>Kci</ci>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <apply>
                                        <minus/>
                                        <ci>Qci</ci>
                                    </apply>
                                    <ci>V</ci>
                                </apply>
                                <ci>RTONF</ci>
                            </apply>
                        </apply>
                    </apply>
                    <ci>di</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k14</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nai</ci>
                                    <ci>K1ni</ci>
                                </apply>
                                <ci>Nai</ci>
                            </apply>
                            <ci>K2ni</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <divide/>
                                <ci>Nai</ci>
                                <ci>K3ni</ci>
                            </apply>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <ci>Qn</ci>
                                    <ci>V</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">2</cn>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>di</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k41</ci>
                <apply>
                    <exp/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <apply>
                                <minus/>
                                <ci>Qn</ci>
                            </apply>
                            <ci>V</ci>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>RTONF</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>di</ci>
                <apply>
                    <plus/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Ca_sub</ci>
                            <ci>Kci</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <apply>
                                            <minus/>
                                            <ci>Qci</ci>
                                        </apply>
                                        <ci>V</ci>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                            <apply>
                                <divide/>
                                <ci>Nai</ci>
                                <ci>Kcni</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Nai</ci>
                            <ci>K1ni</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nai</ci>
                                    <ci>K2ni</ci>
                                </apply>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <divide/>
                                        <ci>Nai</ci>
                                        <ci>K3ni</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k34</ci>
                <apply>
                    <divide/>
                    <ci>Nao</ci>
                    <apply>
                        <plus/>
                        <ci>K3no</ci>
                        <ci>Nao</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k21</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Cao</ci>
                            <ci>Kco</ci>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <ci>Qco</ci>
                                    <ci>V</ci>
                                </apply>
                                <ci>RTONF</ci>
                            </apply>
                        </apply>
                    </apply>
                    <ci>do</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k23</ci>
                <apply>
                    <divide/>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nao</ci>
                                    <ci>K1no</ci>
                                </apply>
                                <ci>Nao</ci>
                            </apply>
                            <ci>K2no</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <divide/>
                                <ci>Nao</ci>
                                <ci>K3no</ci>
                            </apply>
                        </apply>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <times/>
                                    <apply>
                                        <minus/>
                                        <ci>Qn</ci>
                                    </apply>
                                    <ci>V</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">2</cn>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <ci>do</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>k32</ci>
                <apply>
                    <exp/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>Qn</ci>
                            <ci>V</ci>
                        </apply>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">2</cn>
                            <ci>RTONF</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>do</ci>
                <apply>
                    <plus/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Cao</ci>
                            <ci>Kco</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <times/>
                                        <ci>Qco</ci>
                                        <ci>V</ci>
                                    </apply>
                                    <ci>RTONF</ci>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <apply>
                            <divide/>
                            <ci>Nao</ci>
                            <ci>K1no</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <times/>
                                <apply>
                                    <divide/>
                                    <ci>Nao</ci>
                                    <ci>K2no</ci>
                                </apply>
                                <apply>
                                    <plus/>
                                    <cn cellml:units="dimensionless">1</cn>
                                    <apply>
                                        <divide/>
                                        <ci>Nao</ci>
                                        <ci>K3no</ci>
                                    </apply>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--block: ORM-10962/ORM-10103/KB-R7943
no known drugs that specifically target the Na-Ca pump to directly activate it, but Cardia glycosides that such as digoxin/ouabain could indirectly it-->
    <!--I_Kur ion channel, ultra-rapid activating delayed rectifier K ion current
contribute to the repolarization phase, by only allowing K ions to flow out of the cell
important for the atria, ensure that the atria contract and pump blood efficiently, and preventing atrial fibrillation, inhibit it will increase the heart risk
activated very quickly after depolarization, 
located in atrial myocytes-->
    <component name="i_Kur">
        <variable cmeta:id="i_Kur.i_Kur" name="i_Kur" public_interface="out" units="nanoA"/>
        <variable cmeta:id="i_Kur.g_Kur" initial_value="0.1539e-3" name="g_Kur" units="microS"/>
        <variable cmeta:id="i_Kur.time" name="time" private_interface="out" public_interface="in" units="second"/>
        <variable cmeta:id="i_Kur.V" name="V" private_interface="out" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kur.E_K" name="E_K" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kur.r_Kur" name="r_Kur" private_interface="in" units="dimensionless"/>
        <variable cmeta:id="i_Kur.s_Kur" name="s_Kur" private_interface="in" units="dimensionless"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>i_Kur</ci>
                <apply>
                    <times/>
                    <ci>g_Kur</ci>
                    <ci>r_Kur</ci>
                    <ci>s_Kur</ci>
                    <apply>
                        <minus/>
                        <ci>V</ci>
                        <ci>E_K</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kur_rKur_gate">
        <variable cmeta:id="i_Kur_rKur_gate.r_Kur" initial_value="0.011845" name="r_Kur" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Kur_rKur_gate.tau_r_Kur" name="tau_r_Kur" units="second"/>
        <variable cmeta:id="i_Kur_rKur_gate.r_Kur_infinity" name="r_Kur_infinity" units="dimensionless"/>
        <variable cmeta:id="i_Kur_rKur_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kur_rKur_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>r_Kur</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>r_Kur_infinity</ci>
                        <ci>r_Kur</ci>
                    </apply>
                    <ci>tau_r_Kur</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>r_Kur_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">6</cn>
                                </apply>
                                <apply>
                                    <minus/>
                                    <cn cellml:units="millivolt">8.6</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_r_Kur</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">0.009</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">5</cn>
                                    </apply>
                                    <cn cellml:units="millivolt">12</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="second">0.0005</cn>
                </apply>
            </apply>
        </math>
    </component>
    <component name="i_Kur_sKur_gate">
        <variable cmeta:id="i_Kur_sKur_gate.s_Kur" initial_value="0.845304" name="s_Kur" public_interface="out" units="dimensionless"/>
        <variable cmeta:id="i_Kur_sKur_gate.tau_s_Kur" name="tau_s_Kur" units="second"/>
        <variable cmeta:id="i_Kur_sKur_gate.s_Kur_infinity" name="s_Kur_infinity" units="dimensionless"/>
        <variable cmeta:id="i_Kur_sKur_gate.V" name="V" public_interface="in" units="millivolt"/>
        <variable cmeta:id="i_Kur_sKur_gate.time" name="time" public_interface="in" units="second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>s_Kur</ci>
                </apply>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>s_Kur_infinity</ci>
                        <ci>s_Kur</ci>
                    </apply>
                    <ci>tau_s_Kur</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>s_Kur_infinity</ci>
                <apply>
                    <divide/>
                    <cn cellml:units="dimensionless">1</cn>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <ci>V</ci>
                                    <cn cellml:units="millivolt">7.5</cn>
                                </apply>
                                <cn cellml:units="millivolt">10</cn>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>tau_s_Kur</ci>
                <apply>
                    <plus/>
                    <apply>
                        <divide/>
                        <cn cellml:units="second">0.59</cn>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <exp/>
                                <apply>
                                    <divide/>
                                    <apply>
                                        <plus/>
                                        <ci>V</ci>
                                        <cn cellml:units="millivolt">60</cn>
                                    </apply>
                                    <cn cellml:units="millivolt">10</cn>
                                </apply>
                            </apply>
                        </apply>
                    </apply>
                    <cn cellml:units="second">3.05</cn>
                </apply>
            </apply>
        </math>
    </component>
    <!--4-AP can block this current lead to a prolongation of the action potential duration,
some protein kinases also can regulate this current either increase or decrease depending on the specific kinase involved;-->
    <!--Ca ion release flux (J_rel) from SR via RyRs-->
    <component name="Ca_SR_release">
        <variable cmeta:id="Ca_SR_release.j_SRCarel" name="j_SRCarel" public_interface="out" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_SR_release.R" initial_value="0.9308" name="R" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.O" initial_value="6.181512e-9" name="O" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.I" initial_value="4.595622e-10" name="I" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.RI" initial_value="0.069199" name="RI" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.ks" initial_value="148041085.1" name="ks" units="per_second"/>
        <variable cmeta:id="Ca_SR_release.MaxSR" initial_value="15" name="MaxSR" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.MinSR" initial_value="1" name="MinSR" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.EC50_SR" initial_value="0.6829" name="EC50_SR" units="millimolar"/>
        <!--original value is 0.45-->
        <variable cmeta:id="Ca_SR_release.HSR" initial_value="2.5" name="HSR" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.koSRCa" name="koSRCa" units="per_millimolar2_second"/>
        <variable cmeta:id="Ca_SR_release.kiSRCa" name="kiSRCa" units="per_millimolar_second"/>
        <variable cmeta:id="Ca_SR_release.koCa" initial_value="10000" name="koCa" units="per_millimolar2_second"/>
        <variable cmeta:id="Ca_SR_release.kiCa" initial_value="500" name="kiCa" units="per_millimolar_second"/>
        <variable cmeta:id="Ca_SR_release.kCaSR" name="kCaSR" units="dimensionless"/>
        <variable cmeta:id="Ca_SR_release.kim" initial_value="5" name="kim" units="per_second"/>
        <variable cmeta:id="Ca_SR_release.kom" initial_value="660" name="kom" units="per_second"/>
        <variable cmeta:id="Ca_SR_release.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="Ca_SR_release.Ca_sub" name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_SR_release.Ca_jsr" name="Ca_jsr" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_SR_release.diff" name="diff" units="millimolar"/>
        <variable cmeta:id="Ca_SR_release.P_tot" name="P_tot" units="dimensionless"/>
        <!--the KoCa should calibrated by formula, but I don't know how to get RyR_min and other parameters, based on Linder's paper table4-->
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>j_SRCarel</ci>
                <apply>
                    <times/>
                    <ci>ks</ci>
                    <ci>O</ci>
                    <apply>
                        <minus/>
                        <ci>Ca_jsr</ci>
                        <ci>Ca_sub</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>diff</ci>
                <apply>
                    <minus/>
                    <ci>Ca_jsr</ci>
                    <ci>Ca_sub</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>kCaSR</ci>
                <apply>
                    <minus/>
                    <ci>MaxSR</ci>
                    <apply>
                        <divide/>
                        <apply>
                            <minus/>
                            <ci>MaxSR</ci>
                            <ci>MinSR</ci>
                        </apply>
                        <apply>
                            <plus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <power/>
                                <apply>
                                    <divide/>
                                    <ci>EC50_SR</ci>
                                    <ci>Ca_jsr</ci>
                                </apply>
                                <ci>HSR</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>koSRCa</ci>
                <apply>
                    <divide/>
                    <ci>koCa</ci>
                    <ci>kCaSR</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>kiSRCa</ci>
                <apply>
                    <times/>
                    <ci>kiCa</ci>
                    <ci>kCaSR</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>R</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>RI</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>R</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>R</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>O</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>O</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>R</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>O</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>O</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>I</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>I</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>O</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>I</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>I</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>RI</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>RI</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kom</ci>
                            <ci>I</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>koSRCa</ci>
                            <apply>
                                <power/>
                                <ci>Ca_sub</ci>
                                <cn cellml:units="dimensionless">2</cn>
                            </apply>
                            <ci>RI</ci>
                        </apply>
                    </apply>
                    <apply>
                        <minus/>
                        <apply>
                            <times/>
                            <ci>kim</ci>
                            <ci>RI</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>kiSRCa</ci>
                            <ci>Ca_sub</ci>
                            <ci>R</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>P_tot</ci>
                <apply>
                    <plus/>
                    <ci>R</ci>
                    <ci>O</ci>
                    <ci>I</ci>
                    <ci>RI</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--intracellular Ca ion fluxes-->
    <component name="Ca_intracellular_fluxes">
        <variable cmeta:id="Ca_intracellular_fluxes.j_Ca_dif" name="j_Ca_dif" public_interface="out" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_intracellular_fluxes.j_up" name="j_up" public_interface="out" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_intracellular_fluxes.j_tr" name="j_tr" public_interface="out" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_intracellular_fluxes.tau_dif_Ca" initial_value="5.469e-5" name="tau_dif_Ca" units="second"/>
        <variable cmeta:id="Ca_intracellular_fluxes.tau_tr" initial_value="0.04" name="tau_tr" units="second"/>
        <variable cmeta:id="Ca_intracellular_fluxes.P_up" name="P_up" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_intracellular_fluxes.P_up_basal" initial_value="5" name="P_up_basal" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_intracellular_fluxes.b_up" name="b_up" units="dimensionless"/>
        <variable cmeta:id="Ca_intracellular_fluxes.ACh" name="ACh" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_intracellular_fluxes.Iso_1_nM" name="Iso_1_nM" public_interface="in" units="dimensionless"/>
        <variable cmeta:id="Ca_intracellular_fluxes.K_up" initial_value="0.000286113" name="K_up" units="millimolar"/>
        <variable cmeta:id="Ca_intracellular_fluxes.Ca_nsr" name="Ca_nsr" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_intracellular_fluxes.Cai" name="Cai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_intracellular_fluxes.Ca_sub" name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_intracellular_fluxes.Ca_jsr" name="Ca_jsr" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_intracellular_fluxes.slope_up" initial_value="5e-5" name="slope_up" units="millimolar"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>b_up</ci>
                <piecewise>
                    <piece>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">0.25</cn>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>Iso_1_nM</ci>
                            <cn cellml:units="dimensionless">0</cn>
                        </apply>
                    </piece>
                    <piece>
                        <apply>
                            <divide/>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">0.7</cn>
                                <ci>ACh</ci>
                            </apply>
                            <apply>
                                <plus/>
                                <cn cellml:units="millimolar">0.00009</cn>
                                <ci>ACh</ci>
                            </apply>
                        </apply>
                        <apply>
                            <gt/>
                            <ci>ACh</ci>
                            <cn cellml:units="millimolar">0</cn>
                        </apply>
                    </piece>
                    <otherwise>
                        <cn cellml:units="dimensionless">0</cn>
                    </otherwise>
                </piecewise>
            </apply>
            <apply>
                <eq/>
                <ci>P_up</ci>
                <apply>
                    <times/>
                    <ci>P_up_basal</ci>
                    <apply>
                        <minus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <ci>b_up</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>j_Ca_dif</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>Ca_sub</ci>
                        <ci>Cai</ci>
                    </apply>
                    <ci>tau_dif_Ca</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>j_up</ci>
                <apply>
                    <divide/>
                    <ci>P_up</ci>
                    <apply>
                        <plus/>
                        <cn cellml:units="dimensionless">1</cn>
                        <apply>
                            <exp/>
                            <apply>
                                <divide/>
                                <apply>
                                    <plus/>
                                    <apply>
                                        <minus/>
                                        <ci>Cai</ci>
                                    </apply>
                                    <ci>K_up</ci>
                                </apply>
                                <ci>slope_up</ci>
                            </apply>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>j_tr</ci>
                <apply>
                    <divide/>
                    <apply>
                        <minus/>
                        <ci>Ca_nsr</ci>
                        <ci>Ca_jsr</ci>
                    </apply>
                    <ci>tau_tr</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--Ca ion buffering-->
    <component name="Ca_buffering">
        <variable cmeta:id="Ca_buffering.TC_tot" initial_value="0.031" name="TC_tot" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_buffering.TMC_tot" initial_value="0.062" name="TMC_tot" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_buffering.CM_tot" initial_value="0.045" name="CM_tot" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_buffering.CQ_tot" initial_value="10" name="CQ_tot" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_buffering.delta_fTC" name="delta_fTC" public_interface="out" units="per_second"/>
        <variable cmeta:id="Ca_buffering.delta_fTMC" name="delta_fTMC" public_interface="out" units="per_second"/>
        <variable cmeta:id="Ca_buffering.delta_fCMs" name="delta_fCMs" public_interface="out" units="per_second"/>
        <variable cmeta:id="Ca_buffering.delta_fCMi" name="delta_fCMi" public_interface="out" units="per_second"/>
        <variable cmeta:id="Ca_buffering.delta_fCQ" name="delta_fCQ" public_interface="out" units="per_second"/>
        <variable cmeta:id="Ca_buffering.delta_fTMM" name="delta_fTMM" units="per_second"/>
        <variable cmeta:id="Ca_buffering.fTMM" initial_value="0.653777" name="fTMM" units="dimensionless"/>
        <variable cmeta:id="Ca_buffering.fCMi" initial_value="0.217311" name="fCMi" units="dimensionless"/>
        <variable cmeta:id="Ca_buffering.fCMs" initial_value="0.158521" name="fCMs" units="dimensionless"/>
        <variable cmeta:id="Ca_buffering.fTC" initial_value="0.017929" name="fTC" units="dimensionless"/>
        <variable cmeta:id="Ca_buffering.fTMC" initial_value="0.259947" name="fTMC" units="dimensionless"/>
        <variable cmeta:id="Ca_buffering.fCQ" initial_value="0.138975" name="fCQ" units="dimensionless"/>
        <variable cmeta:id="Ca_buffering.kf_TC" initial_value="88800" name="kf_TC" units="per_millimolar_second"/>
        <variable cmeta:id="Ca_buffering.kf_TMM" initial_value="2277" name="kf_TMM" units="per_millimolar_second"/>
        <variable cmeta:id="Ca_buffering.kf_TMC" initial_value="227700" name="kf_TMC" units="per_millimolar_second"/>
        <variable cmeta:id="Ca_buffering.kf_CM" initial_value="1.642e6" name="kf_CM" units="per_millimolar_second"/>
        <variable cmeta:id="Ca_buffering.kf_CQ" initial_value="175.4" name="kf_CQ" units="per_millimolar_second"/>
        <variable cmeta:id="Ca_buffering.kb_TC" initial_value="446" name="kb_TC" units="per_second"/>
        <variable cmeta:id="Ca_buffering.kb_TMC" initial_value="7.51" name="kb_TMC" units="per_second"/>
        <variable cmeta:id="Ca_buffering.kb_TMM" initial_value="751" name="kb_TMM" units="per_second"/>
        <variable cmeta:id="Ca_buffering.kb_CM" initial_value="542" name="kb_CM" units="per_second"/>
        <variable cmeta:id="Ca_buffering.kb_CQ" initial_value="445" name="kb_CQ" units="per_second"/>
        <variable cmeta:id="Ca_buffering.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="Ca_buffering.Mgi" initial_value="2.5" name="Mgi" units="millimolar"/>
        <variable cmeta:id="Ca_buffering.Cai" name="Cai" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_buffering.Ca_sub" name="Ca_sub" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_buffering.Ca_jsr" name="Ca_jsr" public_interface="in" units="millimolar"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fTC</ci>
                </apply>
                <ci>delta_fTC</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fTC</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_TC</ci>
                        <ci>Cai</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fTC</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_TC</ci>
                        <ci>fTC</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fTMC</ci>
                </apply>
                <ci>delta_fTMC</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fTMC</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_TMC</ci>
                        <ci>Cai</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <plus/>
                                <ci>fTMC</ci>
                                <ci>fTMM</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_TMC</ci>
                        <ci>fTMC</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fTMM</ci>
                </apply>
                <ci>delta_fTMM</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fTMM</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_TMM</ci>
                        <ci>Mgi</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <plus/>
                                <ci>fTMC</ci>
                                <ci>fTMM</ci>
                            </apply>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_TMM</ci>
                        <ci>fTMM</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fCMi</ci>
                </apply>
                <ci>delta_fCMi</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fCMi</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_CM</ci>
                        <ci>Cai</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fCMi</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_CM</ci>
                        <ci>fCMi</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fCMs</ci>
                </apply>
                <ci>delta_fCMs</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fCMs</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_CM</ci>
                        <ci>Ca_sub</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fCMs</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_CM</ci>
                        <ci>fCMs</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>fCQ</ci>
                </apply>
                <ci>delta_fCQ</ci>
            </apply>
            <apply>
                <eq/>
                <ci>delta_fCQ</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>kf_CQ</ci>
                        <ci>Ca_jsr</ci>
                        <apply>
                            <minus/>
                            <cn cellml:units="dimensionless">1</cn>
                            <ci>fCQ</ci>
                        </apply>
                    </apply>
                    <apply>
                        <times/>
                        <ci>kb_CQ</ci>
                        <ci>fCQ</ci>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <!--Dynamics of Ca ion concentrations in cell compartments-->
    <component name="Ca_dynamics">
        <variable cmeta:id="Ca_dynamics.Cai" initial_value="9.15641e-6" name="Cai" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.Ca_nsr" initial_value="0.435148" name="Ca_nsr" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.Ca_jsr" initial_value="0.409551" name="Ca_jsr" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.Ca_sub" initial_value="6.226104e-5" name="Ca_sub" public_interface="out" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.V_i" name="V_i" public_interface="in" units="millimetre3"/>
        <variable cmeta:id="Ca_dynamics.V_jsr" name="V_jsr" public_interface="in" units="millimetre3"/>
        <variable cmeta:id="Ca_dynamics.V_nsr" name="V_nsr" public_interface="in" units="millimetre3"/>
        <variable cmeta:id="Ca_dynamics.V_sub" name="V_sub" public_interface="in" units="millimetre3"/>
        <variable cmeta:id="Ca_dynamics.time" name="time" public_interface="in" units="second"/>
        <variable cmeta:id="Ca_dynamics.F" name="F" public_interface="in" units="coulomb_per_mole"/>
        <variable cmeta:id="Ca_dynamics.i_siCa" name="i_siCa" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Ca_dynamics.i_CaT" name="i_CaT" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Ca_dynamics.i_NaCa" name="i_NaCa" public_interface="in" units="nanoA"/>
        <variable cmeta:id="Ca_dynamics.j_SRCarel" name="j_SRCarel" public_interface="in" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_dynamics.j_Ca_dif" name="j_Ca_dif" public_interface="in" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_dynamics.j_tr" name="j_tr" public_interface="in" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_dynamics.j_up" name="j_up" public_interface="in" units="millimolar_per_second"/>
        <variable cmeta:id="Ca_dynamics.TMC_tot" name="TMC_tot" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.CM_tot" name="CM_tot" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.TC_tot" name="TC_tot" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.CQ_tot" name="CQ_tot" public_interface="in" units="millimolar"/>
        <variable cmeta:id="Ca_dynamics.delta_fTMC" name="delta_fTMC" public_interface="in" units="per_second"/>
        <variable cmeta:id="Ca_dynamics.delta_fCMi" name="delta_fCMi" public_interface="in" units="per_second"/>
        <variable cmeta:id="Ca_dynamics.delta_fCMs" name="delta_fCMs" public_interface="in" units="per_second"/>
        <variable cmeta:id="Ca_dynamics.delta_fTC" name="delta_fTC" public_interface="in" units="per_second"/>
        <variable cmeta:id="Ca_dynamics.delta_fCQ" name="delta_fCQ" public_interface="in" units="per_second"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>Cai</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <cn cellml:units="dimensionless">1</cn>
                            <apply>
                                <minus/>
                                <apply>
                                    <times/>
                                    <ci>j_Ca_dif</ci>
                                    <ci>V_sub</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <ci>j_up</ci>
                                    <ci>V_nsr</ci>
                                </apply>
                            </apply>
                        </apply>
                        <ci>V_i</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <times/>
                            <ci>CM_tot</ci>
                            <ci>delta_fCMi</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>TC_tot</ci>
                            <ci>delta_fTC</ci>
                        </apply>
                        <apply>
                            <times/>
                            <ci>TMC_tot</ci>
                            <ci>delta_fTMC</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>Ca_sub</ci>
                </apply>
                <apply>
                    <minus/>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>j_SRCarel</ci>
                            <ci>V_jsr</ci>
                        </apply>
                        <ci>V_sub</ci>
                    </apply>
                    <apply>
                        <plus/>
                        <apply>
                            <divide/>
                            <apply>
                                <minus/>
                                <apply>
                                    <plus/>
                                    <ci>i_siCa</ci>
                                    <ci>i_CaT</ci>
                                </apply>
                                <apply>
                                    <times/>
                                    <cn cellml:units="dimensionless">2</cn>
                                    <ci>i_NaCa</ci>
                                </apply>
                            </apply>
                            <apply>
                                <times/>
                                <cn cellml:units="dimensionless">2</cn>
                                <ci>F</ci>
                                <ci>V_sub</ci>
                            </apply>
                        </apply>
                        <ci>j_Ca_dif</ci>
                        <apply>
                            <times/>
                            <ci>CM_tot</ci>
                            <ci>delta_fCMs</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>Ca_nsr</ci>
                </apply>
                <apply>
                    <minus/>
                    <ci>j_up</ci>
                    <apply>
                        <divide/>
                        <apply>
                            <times/>
                            <ci>j_tr</ci>
                            <ci>V_jsr</ci>
                        </apply>
                        <ci>V_nsr</ci>
                    </apply>
                </apply>
            </apply>
            <apply>
                <eq/>
                <apply>
                    <diff/>
                    <bvar>
                        <ci>time</ci>
                    </bvar>
                    <ci>Ca_jsr</ci>
                </apply>
                <apply>
                    <minus/>
                    <ci>j_tr</ci>
                    <apply>
                        <plus/>
                        <ci>j_SRCarel</ci>
                        <apply>
                            <times/>
                            <ci>CQ_tot</ci>
                            <ci>delta_fCQ</ci>
                        </apply>
                    </apply>
                </apply>
            </apply>
        </math>
    </component>
    <component name="Cell_parameters">
        <variable cmeta:id="Cell_parameters.V_sub" name="V_sub" public_interface="out" units="millimetre3"/>
        <variable cmeta:id="Cell_parameters.V_jsr" name="V_jsr" public_interface="out" units="millimetre3"/>
        <variable cmeta:id="Cell_parameters.V_nsr" name="V_nsr" public_interface="out" units="millimetre3"/>
        <variable cmeta:id="Cell_parameters.V_i" name="V_i" public_interface="out" units="millimetre3"/>
        <variable cmeta:id="Cell_parameters.V_cell" name="V_cell" units="millimetre3"/>
        <variable cmeta:id="Cell_parameters.V_jsr_part" initial_value="0.0012" name="V_jsr_part" units="dimensionless"/>
        <variable cmeta:id="Cell_parameters.V_i_part" initial_value="0.46" name="V_i_part" units="dimensionless"/>
        <variable cmeta:id="Cell_parameters.V_nsr_part" initial_value="0.0116" name="V_nsr_part" units="dimensionless"/>
        <variable cmeta:id="Cell_parameters.R_cell" initial_value="3.9" name="R_cell" units="micrometre"/>
        <variable cmeta:id="Cell_parameters.L_cell" initial_value="67" name="L_cell" units="micrometre"/>
        <variable cmeta:id="Cell_parameters.L_sub" initial_value="0.02" name="L_sub" units="micrometre"/>
        <math xmlns="http://www.w3.org/1998/Math/MathML">
            <apply>
                <eq/>
                <ci>V_cell</ci>
                <apply>
                    <times/>
                    <cn cellml:units="micrometre_per_femtometre">0.000000001</cn>
                    <pi/>
                    <apply>
                        <power/>
                        <ci>R_cell</ci>
                        <cn cellml:units="dimensionless">2</cn>
                    </apply>
                    <ci>L_cell</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_sub</ci>
                <apply>
                    <times/>
                    <cn cellml:units="micrometre_per_femtometre">0.000000001</cn>
                    <cn cellml:units="dimensionless">2</cn>
                    <pi/>
                    <ci>L_sub</ci>
                    <apply>
                        <minus/>
                        <ci>R_cell</ci>
                        <apply>
                            <divide/>
                            <ci>L_sub</ci>
                            <cn cellml:units="dimensionless">2</cn>
                        </apply>
                    </apply>
                    <ci>L_cell</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_jsr</ci>
                <apply>
                    <times/>
                    <ci>V_jsr_part</ci>
                    <ci>V_cell</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_i</ci>
                <apply>
                    <minus/>
                    <apply>
                        <times/>
                        <ci>V_i_part</ci>
                        <ci>V_cell</ci>
                    </apply>
                    <ci>V_sub</ci>
                </apply>
            </apply>
            <apply>
                <eq/>
                <ci>V_nsr</ci>
                <apply>
                    <times/>
                    <ci>V_nsr_part</ci>
                    <ci>V_cell</ci>
                </apply>
            </apply>
        </math>
    </component>
    <!--define the relationship for each ion channels
and almost every channel/exchanger/pump were package to a individual module-->
    <group>
        <relationship_ref relationship="containment"/>
        <component_ref component="Membrane">
            <component_ref component="Nai_concentration"/>
            <component_ref component="Cell_parameters"/>
            <component_ref component="Voltage_clamp"/>
            <component_ref component="i_Kur">
                <component_ref component="i_Kur_sKur_gate"/>
                <component_ref component="i_Kur_rKur_gate"/>
            </component_ref>
            <component_ref component="Ca_buffering"/>
            <component_ref component="Ca_dynamics"/>
            <component_ref component="Rate_modulation_experiments"/>
            <component_ref component="i_KACh">
                <component_ref component="i_KACh_a_gate"/>
            </component_ref>
            <component_ref component="i_NaK"/>
            <component_ref component="i_CaL">
                <component_ref component="i_CaL_fCa_gate"/>
                <component_ref component="i_CaL_dL_gate"/>
                <component_ref component="i_CaL_fL_gate"/>
            </component_ref>
            <component_ref component="i_NaCa"/>
            <component_ref component="i_Kr">
                <component_ref component="i_Kr_pi_gate"/>
                <component_ref component="i_Kr_pa_gate"/>
            </component_ref>
            <component_ref component="i_CaT">
                <component_ref component="i_CaT_fT_gate"/>
                <component_ref component="i_CaT_dT_gate"/>
            </component_ref>
            <component_ref component="i_Ks">
                <component_ref component="i_Ks_n_gate"/>
            </component_ref>
            <component_ref component="i_to">
                <component_ref component="i_to_q_gate"/>
                <component_ref component="i_to_r_gate"/>
            </component_ref>
            <component_ref component="i_Na">
                <component_ref component="i_Na_m_gate"/>
                <component_ref component="i_Na_h_gate"/>
            </component_ref>
            <component_ref component="Ionic_values"/>
            <component_ref component="Ca_intracellular_fluxes"/>
            <component_ref component="i_f">
                <component_ref component="i_f_y_gate"/>
            </component_ref>
            <component_ref component="Ca_SR_release"/>
        </component_ref>
    </group>
    <group>
        <relationship_ref relationship="encapsulation"/>
        <component_ref component="i_CaL">
            <component_ref component="i_CaL_fCa_gate"/>
            <component_ref component="i_CaL_dL_gate"/>
            <component_ref component="i_CaL_fL_gate"/>
        </component_ref>
        <component_ref component="i_Kr">
            <component_ref component="i_Kr_pi_gate"/>
            <component_ref component="i_Kr_pa_gate"/>
        </component_ref>
        <component_ref component="i_CaT">
            <component_ref component="i_CaT_fT_gate"/>
            <component_ref component="i_CaT_dT_gate"/>
        </component_ref>
        <component_ref component="i_Kur">
            <component_ref component="i_Kur_sKur_gate"/>
            <component_ref component="i_Kur_rKur_gate"/>
        </component_ref>
        <component_ref component="i_KACh">
            <component_ref component="i_KACh_a_gate"/>
        </component_ref>
        <component_ref component="Membrane">
            <component_ref component="Voltage_clamp"/>
        </component_ref>
        <component_ref component="i_Ks">
            <component_ref component="i_Ks_n_gate"/>
        </component_ref>
        <component_ref component="i_Na">
            <component_ref component="i_Na_m_gate"/>
            <component_ref component="i_Na_h_gate"/>
        </component_ref>
        <component_ref component="i_to">
            <component_ref component="i_to_q_gate"/>
            <component_ref component="i_to_r_gate"/>
        </component_ref>
        <component_ref component="i_f">
            <component_ref component="i_f_y_gate"/>
        </component_ref>
    </group>
    <!--define the dependence relationship that share common variables-->
    <connection>
        <map_components component_1="environment" component_2="i_Ks"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="Voltage_clamp"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="V_clamp" variable_2="V_clamp"/>
    </connection>
    <connection>
        <map_components component_1="i_f" component_2="i_f_y_gate"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="ACh" variable_2="ACh"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
        <map_variables variable_1="y" variable_2="y"/>
        <map_variables variable_1="cAMP_nif" variable_2="cAMP_nif"/>
    </connection>
    <connection>
        <map_components component_1="i_to_r_gate" component_2="i_to"/>
        <map_variables variable_1="r" variable_2="r"/>
    </connection>
    <connection>
        <map_components component_1="Nai_concentration" component_2="i_NaCa"/>
        <map_variables variable_1="Nai" variable_2="Nai"/>
        <map_variables variable_1="i_NaCa" variable_2="i_NaCa"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_f"/>
        <map_variables variable_1="E_Na" variable_2="E_Na"/>
        <map_variables variable_1="E_K" variable_2="E_K"/>
        <map_variables variable_1="Ko" variable_2="Ko"/>
    </connection>
    <connection>
        <map_components component_1="Ca_intracellular_fluxes" component_2="Ca_dynamics"/>
        <map_variables variable_1="j_tr" variable_2="j_tr"/>
        <map_variables variable_1="j_up" variable_2="j_up"/>
        <map_variables variable_1="j_Ca_dif" variable_2="j_Ca_dif"/>
    </connection>
    <connection>
        <map_components component_1="i_NaK" component_2="Membrane"/>
        <map_variables variable_1="i_NaK" variable_2="i_NaK"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_to"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_Kur"/>
        <map_variables variable_1="E_K" variable_2="E_K"/>
    </connection>
    <connection>
        <map_components component_1="Nai_concentration" component_2="i_NaK"/>
        <map_variables variable_1="Nai" variable_2="Nai"/>
        <map_variables variable_1="i_NaK" variable_2="i_NaK"/>
    </connection>
    <connection>
        <map_components component_1="i_Na_h_gate" component_2="i_Na"/>
        <map_variables variable_1="h" variable_2="h"/>
    </connection>
    <connection>
        <map_components component_1="Cell_parameters" component_2="Nai_concentration"/>
        <map_variables variable_1="V_sub" variable_2="V_sub"/>
        <map_variables variable_1="V_i" variable_2="V_i"/>
    </connection>
    <connection>
        <map_components component_1="i_Ks" component_2="Membrane"/>
        <map_variables variable_1="i_Ks" variable_2="i_Ks"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_to"/>
        <map_variables variable_1="E_K" variable_2="E_K"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_CaT"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="i_CaT" component_2="Membrane"/>
        <map_variables variable_1="i_CaT" variable_2="i_CaT"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_Ks"/>
        <map_variables variable_1="Nao" variable_2="Nao"/>
        <map_variables variable_1="Ko" variable_2="Ko"/>
        <map_variables variable_1="Ki" variable_2="Ki"/>
    </connection>
    <connection>
        <map_components component_1="Nai_concentration" component_2="i_Ks"/>
        <map_variables variable_1="Nai" variable_2="Nai"/>
    </connection>
    <connection>
        <map_components component_1="i_Kur" component_2="i_Kur_rKur_gate"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="r_Kur" variable_2="r_Kur"/>
    </connection>
    <connection>
        <map_components component_1="i_CaL" component_2="Membrane"/>
        <map_variables variable_1="i_CaL" variable_2="i_CaL"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_CaT"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="Rate_modulation_experiments" component_2="i_Ks"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
        <map_variables variable_1="PKA" variable_2="PKA"/>
    </connection>
    <connection>
        <map_components component_1="i_Ks" component_2="i_Ks_n_gate"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
        <map_variables variable_1="n" variable_2="n"/>
        <map_variables variable_1="PKA" variable_2="PKA"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_Na"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="i_Na" variable_2="i_Na"/>
    </connection>
    <connection>
        <map_components component_1="i_f" component_2="Membrane"/>
        <map_variables variable_1="i_f" variable_2="i_f"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_Kr"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="i_Kr" variable_2="i_Kr"/>
    </connection>
    <connection>
        <map_components component_1="Ca_dynamics" component_2="Ca_intracellular_fluxes"/>
        <map_variables variable_1="Cai" variable_2="Cai"/>
        <map_variables variable_1="Ca_jsr" variable_2="Ca_jsr"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
        <map_variables variable_1="Ca_nsr" variable_2="Ca_nsr"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="Nai_concentration"/>
        <map_variables variable_1="F" variable_2="F"/>
    </connection>
    <connection>
        <map_components component_1="i_Na" component_2="i_Na_m_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="m" variable_2="m"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="Membrane"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ca_dynamics" component_2="i_CaL"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
        <map_variables variable_1="i_siCa" variable_2="i_siCa"/>
    </connection>
    <connection>
        <map_components component_1="i_KACh" component_2="Membrane"/>
        <map_variables variable_1="i_KACh" variable_2="i_KACh"/>
    </connection>
    <connection>
        <map_components component_1="i_CaT_fT_gate" component_2="i_CaT"/>
        <map_variables variable_1="fT" variable_2="fT"/>
    </connection>
    <connection>
        <map_components component_1="i_CaT" component_2="i_CaT_fT_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_NaCa"/>
        <map_variables variable_1="Cao" variable_2="Cao"/>
        <map_variables variable_1="Nao" variable_2="Nao"/>
    </connection>
    <connection>
        <map_components component_1="i_Kur_sKur_gate" component_2="i_Kur"/>
        <map_variables variable_1="s_Kur" variable_2="s_Kur"/>
    </connection>
    <connection>
        <map_components component_1="i_CaL" component_2="Nai_concentration"/>
        <map_variables variable_1="i_siNa" variable_2="i_siNa"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="Nai_concentration"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Rate_modulation_experiments" component_2="i_KACh"/>
        <map_variables variable_1="ACh" variable_2="ACh"/>
    </connection>
    <connection>
        <map_components component_1="i_Na" component_2="i_Na_h_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_Na"/>
        <map_variables variable_1="Nao" variable_2="Nao"/>
        <map_variables variable_1="Ko" variable_2="Ko"/>
        <map_variables variable_1="Ki" variable_2="Ki"/>
    </connection>
    <connection>
        <map_components component_1="Ca_dynamics" component_2="Ca_buffering"/>
        <map_variables variable_1="Cai" variable_2="Cai"/>
        <map_variables variable_1="Ca_jsr" variable_2="Ca_jsr"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
    </connection>
    <connection>
        <map_components component_1="Ca_dynamics" component_2="i_NaCa"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
        <map_variables variable_1="i_NaCa" variable_2="i_NaCa"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="Ca_dynamics"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_NaK"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="Nai_concentration" component_2="i_CaL"/>
        <map_variables variable_1="Nai" variable_2="Nai"/>
    </connection>
    <connection>
        <map_components component_1="i_Kr_pa_gate" component_2="i_Kr"/>
        <map_variables variable_1="paF" variable_2="paF"/>
        <map_variables variable_1="paS" variable_2="paS"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_KACh"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Rate_modulation_experiments" component_2="Ca_intracellular_fluxes"/>
        <map_variables variable_1="ACh" variable_2="ACh"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
    </connection>
    <connection>
        <map_components component_1="i_Na" component_2="Nai_concentration"/>
        <map_variables variable_1="i_Na" variable_2="i_Na"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_CaL"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="i_CaL" component_2="i_CaL_fCa_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="fCa" variable_2="fCa"/>
    </connection>
    <connection>
        <map_components component_1="Cell_parameters" component_2="Ca_dynamics"/>
        <map_variables variable_1="V_sub" variable_2="V_sub"/>
        <map_variables variable_1="V_jsr" variable_2="V_jsr"/>
        <map_variables variable_1="V_nsr" variable_2="V_nsr"/>
        <map_variables variable_1="V_i" variable_2="V_i"/>
    </connection>
    <connection>
        <map_components component_1="i_Kur" component_2="i_Kur_sKur_gate"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="Ca_dynamics" component_2="i_CaT"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
        <map_variables variable_1="i_CaT" variable_2="i_CaT"/>
    </connection>
    <connection>
        <map_components component_1="i_Kr" component_2="i_Kr_pi_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="piy" variable_2="piy"/>
    </connection>
    <connection>
        <map_components component_1="i_to_q_gate" component_2="i_to"/>
        <map_variables variable_1="q" variable_2="q"/>
    </connection>
    <connection>
        <map_components component_1="i_CaL" component_2="i_CaL_fL_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="fL" variable_2="fL"/>
    </connection>
    <connection>
        <map_components component_1="Rate_modulation_experiments" component_2="i_f"/>
        <map_variables variable_1="ACh" variable_2="ACh"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
        <map_variables variable_1="cAMP_nif" variable_2="cAMP_nif"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_f"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ca_dynamics" component_2="Ionic_values"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
    </connection>
    <connection>
        <map_components component_1="Ca_SR_release" component_2="Ca_dynamics"/>
        <map_variables variable_1="j_SRCarel" variable_2="j_SRCarel"/>
        <map_variables variable_1="Ca_jsr" variable_2="Ca_jsr"/>
        <map_variables variable_1="Ca_sub" variable_2="Ca_sub"/>
    </connection>
    <connection>
        <map_components component_1="i_Kr" component_2="i_Kr_pa_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="i_KACh_a_gate" component_2="i_KACh"/>
        <map_variables variable_1="a" variable_2="a"/>
    </connection>
    <connection>
        <map_components component_1="i_f" component_2="Nai_concentration"/>
        <map_variables variable_1="i_fNa" variable_2="i_fNa"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_Na"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Rate_modulation_experiments" component_2="i_NaK"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
        <map_variables variable_1="PKA" variable_2="PKA"/>
    </connection>
    <connection>
        <map_components component_1="Rate_modulation_experiments" component_2="i_CaL"/>
        <map_variables variable_1="ACh" variable_2="ACh"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
        <map_variables variable_1="PKA" variable_2="PKA"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_Ks"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_Kr"/>
        <map_variables variable_1="E_K" variable_2="E_K"/>
        <map_variables variable_1="Ko" variable_2="Ko"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="Ionic_values"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_Kur"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="i_Kur" variable_2="i_Kur"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="Ca_SR_release"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_CaT"/>
        <map_variables variable_1="Cao" variable_2="Cao"/>
    </connection>
    <connection>
        <map_components component_1="i_to" component_2="i_to_q_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_CaL"/>
        <map_variables variable_1="Cao" variable_2="Cao"/>
        <map_variables variable_1="Nao" variable_2="Nao"/>
        <map_variables variable_1="Ko" variable_2="Ko"/>
        <map_variables variable_1="Ki" variable_2="Ki"/>
    </connection>
    <connection>
        <map_components component_1="i_CaL_dL_gate" component_2="i_CaL"/>
        <map_variables variable_1="dL" variable_2="dL"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_CaL"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="i_to" component_2="i_to_r_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_NaK"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_KACh"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_NaK"/>
        <map_variables variable_1="E_Na" variable_2="E_Na"/>
        <map_variables variable_1="Ko" variable_2="Ko"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_f"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="Nai_concentration" component_2="Ionic_values"/>
        <map_variables variable_1="Nai" variable_2="Nai"/>
    </connection>
    <connection>
        <map_components component_1="i_NaCa" component_2="Membrane"/>
        <map_variables variable_1="i_NaCa" variable_2="i_NaCa"/>
    </connection>
    <connection>
        <map_components component_1="i_KACh" component_2="i_KACh_a_gate"/>
        <map_variables variable_1="ACh" variable_2="ACh"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_NaCa"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_Kr"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Ca_buffering" component_2="Ca_dynamics"/>
        <map_variables variable_1="delta_fTMC" variable_2="delta_fTMC"/>
        <map_variables variable_1="delta_fCMi" variable_2="delta_fCMi"/>
        <map_variables variable_1="delta_fCMs" variable_2="delta_fCMs"/>
        <map_variables variable_1="CQ_tot" variable_2="CQ_tot"/>
        <map_variables variable_1="TC_tot" variable_2="TC_tot"/>
        <map_variables variable_1="CM_tot" variable_2="CM_tot"/>
        <map_variables variable_1="TMC_tot" variable_2="TMC_tot"/>
        <map_variables variable_1="delta_fCQ" variable_2="delta_fCQ"/>
        <map_variables variable_1="delta_fTC" variable_2="delta_fTC"/>
    </connection>
    <connection>
        <map_components component_1="i_CaT" component_2="i_CaT_dT_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="dT" variable_2="dT"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_NaCa"/>
        <map_variables variable_1="RTONF" variable_2="RTONF"/>
        <map_variables variable_1="V" variable_2="V"/>
    </connection>
    <connection>
        <map_components component_1="i_CaL" component_2="i_CaL_dL_gate"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="Iso_1_nM" variable_2="Iso_1_nM"/>
        <map_variables variable_1="time" variable_2="time"/>
        <map_variables variable_1="PKA" variable_2="PKA"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="i_to"/>
        <map_variables variable_1="V" variable_2="V"/>
        <map_variables variable_1="i_to" variable_2="i_to"/>
    </connection>
    <connection>
        <map_components component_1="Ionic_values" component_2="i_KACh"/>
        <map_variables variable_1="E_K" variable_2="E_K"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="i_Kur"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="environment" component_2="Ca_buffering"/>
        <map_variables variable_1="time" variable_2="time"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="Ca_dynamics"/>
        <map_variables variable_1="F" variable_2="F"/>
    </connection>
    <connection>
        <map_components component_1="Nai_concentration" component_2="i_Na"/>
        <map_variables variable_1="Nai" variable_2="Nai"/>
    </connection>
    <connection>
        <map_components component_1="Membrane" component_2="Brain_stem"/>
        <map_variables variable_1="time" variable_2="t"/>
        <map_variables variable_1="g" variable_2="g"/>
    </connection>
    <!--end-->
</model>
